4178aa425591a38f15c4879c3e9b7a44
"use strict";
// 文件路径: packages/common-backend/src/config/env.schema.ts
// 核心理念: 类型安全的环境变量验证，启动时验证所有配置
Object.defineProperty(exports, "__esModule", { value: true });
exports.envSchema = void 0;
exports.validateEnv = validateEnv;
const zod_1 = require("zod");
/**
 * @description 环境变量 Schema
 * 使用 Zod 验证所有环境变量，确保类型安全和配置完整
 */
exports.envSchema = zod_1.z.object({
    // 数据库配置
    DATABASE_URL: zod_1.z.string().url('DATABASE_URL 必须是有效的 URL'),
    // 数据库连接池配置
    DB_CONNECTION_LIMIT: zod_1.z.coerce.number().int().min(1).max(100).default(20),
    DB_POOL_TIMEOUT: zod_1.z.coerce.number().int().min(1).max(300).default(20), // 秒
    DB_IDLE_TIMEOUT: zod_1.z.coerce.number().int().min(1).max(3600).default(300), // 秒
    // Redis 配置
    REDIS_URL: zod_1.z.string().url('REDIS_URL 必须是有效的 URL').optional(),
    REDIS_HOST: zod_1.z.string().default('localhost'),
    REDIS_PORT: zod_1.z.coerce.number().int().positive().default(6379),
    // 加密配置
    ENCRYPTION_KEY: zod_1.z.string().min(32, 'ENCRYPTION_KEY 至少需要 32 个字符'),
    ENCRYPTION_SALT: zod_1.z.string().min(16, 'ENCRYPTION_SALT 至少需要 16 个字符'),
    ENCRYPTION_USE_SALT: zod_1.z
        .string()
        .transform((val) => ['true', '1', 'yes'].includes(val.toLowerCase()))
        .pipe(zod_1.z.boolean())
        .default('false'),
    ENCRYPTION_ALGORITHM: zod_1.z.string().default('aes-256-gcm'),
    // Sentry 配置
    SENTRY_DSN: zod_1.z.string().url('SENTRY_DSN 必须是有效的 URL').optional(),
    SENTRY_ENVIRONMENT: zod_1.z.string().default('development'),
    SENTRY_TRACES_SAMPLE_RATE: zod_1.z
        .string()
        .transform((val) => Number.parseFloat(val))
        .pipe(zod_1.z.number().min(0).max(1))
        .default('1.0'),
    // AI Provider 后备配置
    FALLBACK_API_KEY: zod_1.z.string().optional(),
    FALLBACK_MODEL_ID: zod_1.z.string().default('deepseek-chat'),
    FALLBACK_BASE_URL: zod_1.z.string().url().optional(),
    // 应用配置
    NODE_ENV: zod_1.z.enum(['development', 'production', 'test']).default('development'),
    PORT: zod_1.z.coerce.number().int().positive().default(3000),
    CORS_ORIGIN: zod_1.z.string().url().default('http://localhost:5173'),
    // Qdrant 配置（向量数据库）
    QDRANT_URL: zod_1.z.string().url().default('http://localhost:6333'),
    QDRANT_API_KEY: zod_1.z.string().optional(),
    // Clerk 配置
    CLERK_SECRET_KEY: zod_1.z.string().optional(),
    CLERK_PUBLISHABLE_KEY: zod_1.z.string().optional(),
    CLERK_WEBHOOK_SECRET_KEY: zod_1.z.string().optional(),
    // RabbitMQ 配置
    RABBITMQ_URL: zod_1.z.string().url().default('amqp://localhost:5672'),
    // JWT 配置 (用于传统认证)
    JWT_SECRET: zod_1.z.string().min(32, 'JWT_SECRET 至少需要 32 个字符'),
    JWT_EXPIRATION_SECONDS: zod_1.z.coerce.number().int().positive().default(3600),
    // 服务端口配置
    BACKEND_GATEWAY_PORT: zod_1.z.coerce.number().int().positive().default(3000),
    CREATION_AGENT_HTTP_PORT: zod_1.z.coerce.number().int().positive().default(8080),
    LOGIC_AGENT_HTTP_PORT: zod_1.z.coerce.number().int().positive().default(8081),
    NARRATIVE_AGENT_HTTP_PORT: zod_1.z.coerce.number().int().positive().default(8082),
});
/**
 * @function validateEnv
 * @description 验证环境变量
 * @returns 验证后的环境变量
 * @throws {Error} 如果验证失败
 */
function validateEnv() {
    try {
        return exports.envSchema.parse(process.env);
    }
    catch (error) {
        if (error instanceof zod_1.z.ZodError) {
            const errorMessages = error.errors.map((err) => {
                const path = err.path.join('.');
                return `${path}: ${err.message}`;
            });
            throw new Error(`环境变量验证失败:\n${errorMessages.join('\n')}\n\n请检查 .env 文件或环境变量配置。`);
        }
        throw error;
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFwxNjY2M1xcRGVza3RvcFxcdHVoZWdcXHBhY2thZ2VzXFxjb21tb24tYmFja2VuZFxcc3JjXFxjb25maWdcXGVudi5zY2hlbWEudHMiLCJtYXBwaW5ncyI6IjtBQUFBLHlEQUF5RDtBQUN6RCw4QkFBOEI7OztBQXFGOUIsa0NBZ0JDO0FBbkdELDZCQUF1QjtBQUV2Qjs7O0dBR0c7QUFDVSxRQUFBLFNBQVMsR0FBRyxPQUFDLENBQUMsTUFBTSxDQUFDO0lBQ2hDLFFBQVE7SUFDUixZQUFZLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyx5QkFBeUIsQ0FBQztJQUN2RCxXQUFXO0lBQ1gsbUJBQW1CLEVBQUUsT0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUM7SUFDeEUsZUFBZSxFQUFFLE9BQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLEVBQUUsSUFBSTtJQUMxRSxlQUFlLEVBQUUsT0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRSxJQUFJO0lBRTVFLFdBQVc7SUFDWCxTQUFTLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLFFBQVEsRUFBRTtJQUM1RCxVQUFVLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUM7SUFDM0MsVUFBVSxFQUFFLE9BQUMs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LENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQTtnQkFDL0IsT0FBTyxHQUFHLElBQUksS0FBSyxHQUFHLENBQUMsT0FBTyxFQUFFLENBQUE7WUFDbEMsQ0FBQyxDQUFDLENBQUE7WUFFRixNQUFNLElBQUksS0FBSyxDQUNiLGNBQWMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMseUJBQXlCLENBQ2hFLENBQUE7UUFDSCxDQUFDO1FBQ0QsTUFBTSxLQUFLLENBQUE7SUFDYixDQUFDO0FBQ0gsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXDE2NjYzXFxEZXNrdG9wXFx0dWhlZ1xccGFja2FnZXNcXGNvbW1vbi1iYWNrZW5kXFxzcmNcXGNvbmZpZ1xcZW52LnNjaGVtYS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyDmlofku7bot6/lvoQ6IHBhY2thZ2VzL2NvbW1vbi1iYWNrZW5kL3NyYy9jb25maWcvZW52LnNjaGVtYS50c1xuLy8g5qC45b+D55CG5b+1OiDnsbvlnovlronlhajnmoTnjq/looPlj5jph4/pqozor4HvvIzlkK/liqjml7bpqozor4HmiYDmnInphY3nva5cblxuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCdcblxuLyoqXG4gKiBAZGVzY3JpcHRpb24g546v5aKD5Y+Y6YePIFNjaGVtYVxuICog5L2/55SoIFpvZCDpqozor4HmiYDmnInnjq/looPlj5jph4/vvIznoa7kv53nsbvlnovlronlhajlkozphY3nva7lrozmlbRcbiAqL1xuZXhwb3J0IGNvbnN0IGVudlNjaGVtYSA9IHoub2JqZWN0KHtcbiAgLy8g5pWw5o2u5bqT6YWN572uXG4gIERBVEFCQVNFX1VSTDogei5zdHJpbmcoKS51cmwoJ0RBVEFCQVNFX1VSTCDlv4XpobvmmK/mnInmlYjnmoQgVVJMJyksXG4gIC8vIOaVsOaNruW6k+i/nuaOpeaxoOmFjee9rlxuICBEQl9DT05ORUNUSU9OX0xJTUlUOiB6LmNvZXJjZS5udW1iZXIoKS5pbnQoKS5taW4oMSkubWF4KDEwMCkuZGVmYXVsdCgyMCksXG4gIERCX1BPT0xfVElNRU9VVDogei5jb2VyY2UubnVtYmVyKCkuaW50KCkubWluKDEpLm1heCgzMDApLmRlZmF1bHQoMjApLCAvLyDnp5JcbiAgREJfSURMRV9USU1FT1VUOiB6LmNvZXJjZS5udW1iZXIoKS5pbnQoKS5taW4oMSkubWF4KDM2MDApLmRlZmF1bHQoMzAwKSwgLy8g56eSXG5cbiAgLy8gUmVkaXMg6YWN572uXG4gIFJFRElTX1VSTDogei5zdHJpbmcoKS51cmwoJ1JFRElTX1VSTCDlv4XpobvmmK/mnInmlYjnmoQgVVJMJykub3B0aW9uYWwoKSxcbiAgUkVESVNfSE9TVDogei5zdHJpbmcoKS5kZWZhdWx0KCdsb2NhbGhvc3QnKSxcbiAgUkVESVNfUE9SVDogei5jb2VyY2UubnVtYmVyKCkuaW50KCkucG9zaXRpdmUoKS5kZWZhdWx0KDYzNzkpLFxuXG4gIC8vIOWKoOWvhumFjee9rlxuICBFTkNSWVBUSU9OX0tFWTogei5zdHJpbmcoKS5taW4oMzIsICdFTkNSWVBUSU9OX0tFWSDoh7PlsJHpnIDopoEgMzIg5Liq5a2X56ymJyksXG4gIEVOQ1JZUFRJT05fU0FMVDogei5zdHJpbmcoKS5taW4oMTYsICdFTkNSWVBUSU9OX1NBTFQg6Iez5bCR6ZyA6KaBIDE2IOS4quWtl+espicpLFxuICBFTkNSWVBUSU9OX1VTRV9TQUxUOiB6XG4gICAgLnN0cmluZygpXG4gICAgLnRyYW5zZm9ybSgodmFsKSA9PiBbJ3RydWUnLCAnMScsICd5ZXMnXS5pbmNsdWRlcyh2YWwudG9Mb3dlckNhc2UoKSkpXG4gICAgLnBpcGUoei5ib29sZWFuKCkpXG4gICAgLmRlZmF1bHQoJ2ZhbHNlJyksXG4gIEVOQ1JZUFRJT05fQUxHT1JJVEhNOiB6LnN0cmluZygpLmRlZmF1bHQoJ2Flcy0yNTYtZ2NtJyksXG5cbiAgLy8gU2VudHJ5IOmFjee9rlxuICBTRU5UUllfRFNOOiB6LnN0cmluZygpLnVybCgnU0VOVFJZX0RTTiDlv4XpobvmmK/mnInmlYjnmoQgVVJMJykub3B0aW9uYWwoKSxcbiAgU0VOVFJZX0VOVklST05NRU5UOiB6LnN0cmluZygpLmRlZmF1bHQoJ2RldmVsb3BtZW50JyksXG4gIFNFTlRSWV9UUkFDRVNfU0FNUExFX1JBVEU6IHpcbiAgICAuc3RyaW5nKClcbiAgICAudHJhbnNmb3JtKCh2YWwpID0+IE51bWJlci5wYXJzZUZsb2F0KHZhbCkpXG4gICAgLnBpcGUoei5udW1iZXIoKS5taW4oMCkubWF4KDEpKVxuICAgIC5kZWZhdWx0KCcxLjAnKSxcblxuICAvLyBBSSBQcm92aWRlciDlkI7lpIfphY3nva5cbiAgRkFMTEJBQ0tfQVBJX0tFWTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBGQUxMQkFDS19NT0RFTF9JRDogei5zdHJpbmcoKS5kZWZhdWx0KCdkZWVwc2Vlay1jaGF0JyksXG4gIEZBTExCQUNLX0JBU0VfVVJMOiB6LnN0cmluZygpLnVybCgpLm9wdGlvbmFsKCksXG5cbiAgLy8g5bqU55So6YWN572uXG4gIE5PREVfRU5WOiB6LmVudW0oWydkZXZlbG9wbWVudCcsICdwcm9kdWN0aW9uJywgJ3Rlc3QnXSkuZGVmYXVsdCgnZGV2ZWxvcG1lbnQnKSxcbiAgUE9SVDogei5jb2VyY2UubnVtYmVyKCkuaW50KCkucG9zaXRpdmUoKS5kZWZhdWx0KDMwMDApLFxuICBDT1JTX09SSUdJTjogei5zdHJpbmcoKS51cmwoKS5kZWZhdWx0KCdodHRwOi8vbG9jYWxob3N0OjUxNzMnKSxcblxuICAvLyBRZHJhbnQg6YWN572u77yI5ZCR6YeP5pWw5o2u5bqT77yJXG4gIFFEUkFOVF9VUkw6IHouc3RyaW5nKCkudXJsKCkuZGVmYXVsdCgnaHR0cDovL2xvY2FsaG9zdDo2MzMzJyksXG4gIFFEUkFOVF9BUElfS0VZOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG5cbiAgLy8gQ2xlcmsg6YWN572uXG4gIENMRVJLX1NFQ1JFVF9LRVk6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgQ0xFUktfUFVCTElTSEFCTEVfS0VZOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIENMRVJLX1dFQkhPT0tfU0VDUkVUX0tFWTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuXG4gIC8vIFJhYmJpdE1RIOmFjee9rlxuICBSQUJCSVRNUV9VUkw6IHouc3RyaW5nKCkudXJsKCkuZGVmYXVsdCgnYW1xcDovL2xvY2FsaG9zdDo1NjcyJyksXG5cbiAgLy8gSldUIOmFjee9riAo55So5LqO5Lyg57uf6K6k6K+BKVxuICBKV1RfU0VDUkVUOiB6LnN0cmluZygpLm1pbigzMiwgJ0pXVF9TRUNSRVQg6Iez5bCR6ZyA6KaBIDMyIOS4quWtl+espicpLFxuICBKV1RfRVhQSVJBVElPTl9TRUNPTkRTOiB6LmNvZXJjZS5udW1iZXIoKS5pbnQoKS5wb3NpdGl2ZSgpLmRlZmF1bHQoMzYwMCksXG5cbiAgLy8g5pyN5Yqh56uv5Y+j6YWN572uXG4gIEJBQ0tFTkRfR0FURVdBWV9QT1JUOiB6LmNvZXJjZS5udW1iZXIoKS5pbnQoKS5wb3NpdGl2ZSgpLmRlZmF1bHQoMzAwMCksXG4gIENSRUFUSU9OX0FHRU5UX0hUVFBfUE9SVDogei5jb2VyY2UubnVtYmVyKCkuaW50KCkucG9zaXRpdmUoKS5kZWZhdWx0KDgwODApLFxuICBMT0dJQ19BR0VOVF9IVFRQX1BPUlQ6IHouY29lcmNlLm51bWJlcigpLmludCgpLnBvc2l0aXZlKCkuZGVmYXVsdCg4MDgxKSxcbiAgTkFSUkFUSVZFX0FHRU5UX0hUVFBfUE9SVDogei5jb2VyY2UubnVtYmVyKCkuaW50KCkucG9zaXRpdmUoKS5kZWZhdWx0KDgwODIpLFxufSlcblxuLyoqXG4gKiBAdHlwZSBFbnZcbiAqIEBkZXNjcmlwdGlvbiDpqozor4HlkI7nmoTnjq/looPlj5jph4/nsbvlnotcbiAqL1xuZXhwb3J0IHR5cGUgRW52ID0gei5pbmZlcjx0eXBlb2YgZW52U2NoZW1hPlxuXG4vKipcbiAqIEBmdW5jdGlvbiB2YWxpZGF0ZUVudlxuICogQGRlc2NyaXB0aW9uIOmqjOivgeeOr+Wig+WPmOmHj1xuICogQHJldHVybnMg6aqM6K+B5ZCO55qE546v5aKD5Y+Y6YePXG4gKiBAdGhyb3dzIHtFcnJvcn0g5aaC5p6c6aqM6K+B5aSx6LSlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUVudigpOiBFbnYge1xuICB0cnkge1xuICAgIHJldHVybiBlbnZTY2hlbWEucGFyc2UocHJvY2Vzcy5lbnYpXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2Ygei5ab2RFcnJvcikge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlcyA9IGVycm9yLmVycm9ycy5tYXAoKGVycikgPT4ge1xuICAgICAgICBjb25zdCBwYXRoID0gZXJyLnBhdGguam9pbignLicpXG4gICAgICAgIHJldHVybiBgJHtwYXRofTogJHtlcnIubWVzc2FnZX1gXG4gICAgICB9KVxuXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGDnjq/looPlj5jph4/pqozor4HlpLHotKU6XFxuJHtlcnJvck1lc3NhZ2VzLmpvaW4oJ1xcbicpfVxcblxcbuivt+ajgOafpSAuZW52IOaWh+S7tuaIlueOr+Wig+WPmOmHj+mFjee9ruOAgmBcbiAgICAgIClcbiAgICB9XG4gICAgdGhyb3cgZXJyb3JcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9