b749fbcb0a875eff643040a679a9e10e
"use strict";
// 文件路径: packages/common-backend/src/config/env.schema.ts
// 核心理念: 类型安全的环境变量验证，启动时验证所有配置
Object.defineProperty(exports, "__esModule", { value: true });
exports.envSchema = void 0;
exports.validateEnv = validateEnv;
const zod_1 = require("zod");
/**
 * @description 环境变量 Schema
 * 使用 Zod 验证所有环境变量，确保类型安全和配置完整
 */
exports.envSchema = zod_1.z.object({
    // 数据库配置
    DATABASE_URL: zod_1.z.string().url('DATABASE_URL 必须是有效的 URL'),
    // 数据库连接池配置
    DB_CONNECTION_LIMIT: zod_1.z.coerce.number().int().min(1).max(100).default(20),
    DB_POOL_TIMEOUT: zod_1.z.coerce.number().int().min(1).max(300).default(20), // 秒
    DB_IDLE_TIMEOUT: zod_1.z.coerce.number().int().min(1).max(3600).default(300), // 秒
    // Redis 配置
    REDIS_URL: zod_1.z.string().url('REDIS_URL 必须是有效的 URL').optional(),
    REDIS_HOST: zod_1.z.string().default('localhost'),
    REDIS_PORT: zod_1.z.coerce.number().int().positive().default(6379),
    // 加密配置
    ENCRYPTION_KEY: zod_1.z.string().min(32, 'ENCRYPTION_KEY 至少需要 32 个字符'),
    ENCRYPTION_SALT: zod_1.z.string().min(16, 'ENCRYPTION_SALT 至少需要 16 个字符'),
    ENCRYPTION_USE_SALT: zod_1.z
        .string()
        .transform((val) => ['true', '1', 'yes'].includes(val.toLowerCase()))
        .pipe(zod_1.z.boolean())
        .default('false'),
    ENCRYPTION_ALGORITHM: zod_1.z.string().default('aes-256-gcm'),
    // Sentry 配置
    SENTRY_DSN: zod_1.z.string().url('SENTRY_DSN 必须是有效的 URL').optional(),
    SENTRY_ENVIRONMENT: zod_1.z.string().default('development'),
    SENTRY_TRACES_SAMPLE_RATE: zod_1.z
        .string()
        .transform((val) => Number.parseFloat(val))
        .pipe(zod_1.z.number().min(0).max(1))
        .default('1.0'),
    // AI Provider 配置
    DEEPSEEK_API_KEY: zod_1.z.string().optional(),
    DEEPSEEK_BASE_URL: zod_1.z.string().url().default('https://api.deepseek.com/v1'),
    // AI Provider 后备配置
    FALLBACK_API_KEY: zod_1.z.string().optional(),
    FALLBACK_MODEL_ID: zod_1.z.string().default('deepseek-chat'),
    FALLBACK_BASE_URL: zod_1.z.string().url().optional(),
    // 应用配置
    NODE_ENV: zod_1.z.enum(['development', 'production', 'test']).default('development'),
    PORT: zod_1.z.coerce.number().int().positive().default(3000),
    CORS_ORIGIN: zod_1.z.string().url().default('http://localhost:5173'),
    // Qdrant 配置（向量数据库）
    QDRANT_URL: zod_1.z.string().url().default('http://localhost:6333'),
    QDRANT_API_KEY: zod_1.z.string().optional(),
    // Clerk 配置
    CLERK_SECRET_KEY: zod_1.z.string().optional(),
    CLERK_PUBLISHABLE_KEY: zod_1.z.string().optional(),
    CLERK_WEBHOOK_SECRET_KEY: zod_1.z.string().optional(),
    // RabbitMQ 配置
    RABBITMQ_URL: zod_1.z.string().url().default('amqp://localhost:5672'),
    // JWT 配置 (用于传统认证)
    JWT_SECRET: zod_1.z.string().min(32, 'JWT_SECRET 至少需要 32 个字符'),
    JWT_EXPIRATION_SECONDS: zod_1.z.coerce.number().int().positive().default(3600),
    // 服务端口配置
    BACKEND_GATEWAY_PORT: zod_1.z.coerce.number().int().positive().default(3000),
    CREATION_AGENT_HTTP_PORT: zod_1.z.coerce.number().int().positive().default(8080),
    LOGIC_AGENT_HTTP_PORT: zod_1.z.coerce.number().int().positive().default(8081),
    NARRATIVE_AGENT_HTTP_PORT: zod_1.z.coerce.number().int().positive().default(8082),
});
/**
 * @function validateEnv
 * @description 验证环境变量
 * @returns 验证后的环境变量
 * @throws {Error} 如果验证失败
 */
function validateEnv() {
    try {
        return exports.envSchema.parse(process.env);
    }
    catch (error) {
        if (error instanceof zod_1.z.ZodError) {
            const errorMessages = error.errors.map((err) => {
                const path = err.path.join('.');
                return `${path}: ${err.message}`;
            });
            throw new Error(`环境变量验证失败:\n${errorMessages.join('\n')}\n\n请检查 .env 文件或环境变量配置。`);
        }
        throw error;
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFwxNjY2M1xcRGVza3RvcFxcdHVoZWdcXHBhY2thZ2VzXFxjb21tb24tYmFja2VuZFxcc3JjXFxjb25maWdcXGVudi5zY2hlbWEudHMiLCJtYXBwaW5ncyI6IjtBQUFBLHlEQUF5RDtBQUN6RCw4QkFBOEI7OztBQXlGOUIsa0NBZ0JDO0FBdkdELDZCQUF1QjtBQUV2Qjs7O0dBR0c7QUFDVSxRQUFBLFNBQVMsR0FBRyxPQUFDLENBQUMsTUFBTSxDQUFDO0lBQ2hDLFFBQVE7SUFDUixZQUFZLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyx5QkFBeUIsQ0FBQztJQUN2RCxXQUFXO0lBQ1gsbUJBQW1CLEVBQUUsT0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUM7SUFDeEUsZUFBZSxFQUFFLE9BQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLEVBQUUsSUFBSTtJQUMxRSxlQUFlLEVBQUUsT0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRSxJQUFJO0lBRTVFLFdBQVc7SUFDWCxTQUFTLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDLFFBQVEsRUFBRTtJQUM1RCxVQUFVLEVBQUUsT0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUM7SUFDM0MsVUFBVSxFQUFFLE9BQUMs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QUFDO1FBQ2YsSUFBSSxLQUFLLFlBQVksT0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQ2hDLE1BQU0sYUFBYSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUU7Z0JBQzdDLE1BQU0sSUFBSSxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFBO2dCQUMvQixPQUFPLEdBQUcsSUFBSSxLQUFLLEdBQUcsQ0FBQyxPQUFPLEVBQUUsQ0FBQTtZQUNsQyxDQUFDLENBQUMsQ0FBQTtZQUVGLE1BQU0sSUFBSSxLQUFLLENBQ2IsY0FBYyxhQUFhLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FDaEUsQ0FBQTtRQUNILENBQUM7UUFDRCxNQUFNLEtBQUssQ0FBQTtJQUNiLENBQUM7QUFDSCxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcMTY2NjNcXERlc2t0b3BcXHR1aGVnXFxwYWNrYWdlc1xcY29tbW9uLWJhY2tlbmRcXHNyY1xcY29uZmlnXFxlbnYuc2NoZW1hLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIOaWh+S7tui3r+W+hDogcGFja2FnZXMvY29tbW9uLWJhY2tlbmQvc3JjL2NvbmZpZy9lbnYuc2NoZW1hLnRzXG4vLyDmoLjlv4PnkIblv7U6IOexu+Wei+WuieWFqOeahOeOr+Wig+WPmOmHj+mqjOivge+8jOWQr+WKqOaXtumqjOivgeaJgOaciemFjee9rlxuXG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJ1xuXG4vKipcbiAqIEBkZXNjcmlwdGlvbiDnjq/looPlj5jph48gU2NoZW1hXG4gKiDkvb/nlKggWm9kIOmqjOivgeaJgOacieeOr+Wig+WPmOmHj++8jOehruS/neexu+Wei+WuieWFqOWSjOmFjee9ruWujOaVtFxuICovXG5leHBvcnQgY29uc3QgZW52U2NoZW1hID0gei5vYmplY3Qoe1xuICAvLyDmlbDmja7lupPphY3nva5cbiAgREFUQUJBU0VfVVJMOiB6LnN0cmluZygpLnVybCgnREFUQUJBU0VfVVJMIOW/hemhu+aYr+acieaViOeahCBVUkwnKSxcbiAgLy8g5pWw5o2u5bqT6L+e5o6l5rGg6YWN572uXG4gIERCX0NPTk5FQ1RJT05fTElNSVQ6IHouY29lcmNlLm51bWJlcigpLmludCgpLm1pbigxKS5tYXgoMTAwKS5kZWZhdWx0KDIwKSxcbiAgREJfUE9PTF9USU1FT1VUOiB6LmNvZXJjZS5udW1iZXIoKS5pbnQoKS5taW4oMSkubWF4KDMwMCkuZGVmYXVsdCgyMCksIC8vIOenklxuICBEQl9JRExFX1RJTUVPVVQ6IHouY29lcmNlLm51bWJlcigpLmludCgpLm1pbigxKS5tYXgoMzYwMCkuZGVmYXVsdCgzMDApLCAvLyDnp5JcblxuICAvLyBSZWRpcyDphY3nva5cbiAgUkVESVNfVVJMOiB6LnN0cmluZygpLnVybCgnUkVESVNfVVJMIOW/hemhu+aYr+acieaViOeahCBVUkwnKS5vcHRpb25hbCgpLFxuICBSRURJU19IT1NUOiB6LnN0cmluZygpLmRlZmF1bHQoJ2xvY2FsaG9zdCcpLFxuICBSRURJU19QT1JUOiB6LmNvZXJjZS5udW1iZXIoKS5pbnQoKS5wb3NpdGl2ZSgpLmRlZmF1bHQoNjM3OSksXG5cbiAgLy8g5Yqg5a+G6YWN572uXG4gIEVOQ1JZUFRJT05fS0VZOiB6LnN0cmluZygpLm1pbigzMiwgJ0VOQ1JZUFRJT05fS0VZIOiHs+WwkemcgOimgSAzMiDkuKrlrZfnrKYnKSxcbiAgRU5DUllQVElPTl9TQUxUOiB6LnN0cmluZygpLm1pbigxNiwgJ0VOQ1JZUFRJT05fU0FMVCDoh7PlsJHpnIDopoEgMTYg5Liq5a2X56ymJyksXG4gIEVOQ1JZUFRJT05fVVNFX1NBTFQ6IHpcbiAgICAuc3RyaW5nKClcbiAgICAudHJhbnNmb3JtKCh2YWwpID0+IFsndHJ1ZScsICcxJywgJ3llcyddLmluY2x1ZGVzKHZhbC50b0xvd2VyQ2FzZSgpKSlcbiAgICAucGlwZSh6LmJvb2xlYW4oKSlcbiAgICAuZGVmYXVsdCgnZmFsc2UnKSxcbiAgRU5DUllQVElPTl9BTEdPUklUSE06IHouc3RyaW5nKCkuZGVmYXVsdCgnYWVzLTI1Ni1nY20nKSxcblxuICAvLyBTZW50cnkg6YWN572uXG4gIFNFTlRSWV9EU046IHouc3RyaW5nKCkudXJsKCdTRU5UUllfRFNOIOW/hemhu+aYr+acieaViOeahCBVUkwnKS5vcHRpb25hbCgpLFxuICBTRU5UUllfRU5WSVJPTk1FTlQ6IHouc3RyaW5nKCkuZGVmYXVsdCgnZGV2ZWxvcG1lbnQnKSxcbiAgU0VOVFJZX1RSQUNFU19TQU1QTEVfUkFURTogelxuICAgIC5zdHJpbmcoKVxuICAgIC50cmFuc2Zvcm0oKHZhbCkgPT4gTnVtYmVyLnBhcnNlRmxvYXQodmFsKSlcbiAgICAucGlwZSh6Lm51bWJlcigpLm1pbigwKS5tYXgoMSkpXG4gICAgLmRlZmF1bHQoJzEuMCcpLFxuXG4gIC8vIEFJIFByb3ZpZGVyIOmFjee9rlxuICBERUVQU0VFS19BUElfS0VZOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIERFRVBTRUVLX0JBU0VfVVJMOiB6LnN0cmluZygpLnVybCgpLmRlZmF1bHQoJ2h0dHBzOi8vYXBpLmRlZXBzZWVrLmNvbS92MScpLFxuXG4gIC8vIEFJIFByb3ZpZGVyIOWQjuWkh+mFjee9rlxuICBGQUxMQkFDS19BUElfS0VZOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIEZBTExCQUNLX01PREVMX0lEOiB6LnN0cmluZygpLmRlZmF1bHQoJ2RlZXBzZWVrLWNoYXQnKSxcbiAgRkFMTEJBQ0tfQkFTRV9VUkw6IHouc3RyaW5nKCkudXJsKCkub3B0aW9uYWwoKSxcblxuICAvLyDlupTnlKjphY3nva5cbiAgTk9ERV9FTlY6IHouZW51bShbJ2RldmVsb3BtZW50JywgJ3Byb2R1Y3Rpb24nLCAndGVzdCddKS5kZWZhdWx0KCdkZXZlbG9wbWVudCcpLFxuICBQT1JUOiB6LmNvZXJjZS5udW1iZXIoKS5pbnQoKS5wb3NpdGl2ZSgpLmRlZmF1bHQoMzAwMCksXG4gIENPUlNfT1JJR0lOOiB6LnN0cmluZygpLnVybCgpLmRlZmF1bHQoJ2h0dHA6Ly9sb2NhbGhvc3Q6NTE3MycpLFxuXG4gIC8vIFFkcmFudCDphY3nva7vvIjlkJHph4/mlbDmja7lupPvvIlcbiAgUURSQU5UX1VSTDogei5zdHJpbmcoKS51cmwoKS5kZWZhdWx0KCdodHRwOi8vbG9jYWxob3N0OjYzMzMnKSxcbiAgUURSQU5UX0FQSV9LRVk6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcblxuICAvLyBDbGVyayDphY3nva5cbiAgQ0xFUktfU0VDUkVUX0tFWTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBDTEVSS19QVUJMSVNIQUJMRV9LRVk6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgQ0xFUktfV0VCSE9PS19TRUNSRVRfS0VZOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG5cbiAgLy8gUmFiYml0TVEg6YWN572uXG4gIFJBQkJJVE1RX1VSTDogei5zdHJpbmcoKS51cmwoKS5kZWZhdWx0KCdhbXFwOi8vbG9jYWxob3N0OjU2NzInKSxcblxuICAvLyBKV1Qg6YWN572uICjnlKjkuo7kvKDnu5/orqTor4EpXG4gIEpXVF9TRUNSRVQ6IHouc3RyaW5nKCkubWluKDMyLCAnSldUX1NFQ1JFVCDoh7PlsJHpnIDopoEgMzIg5Liq5a2X56ymJyksXG4gIEpXVF9FWFBJUkFUSU9OX1NFQ09ORFM6IHouY29lcmNlLm51bWJlcigpLmludCgpLnBvc2l0aXZlKCkuZGVmYXVsdCgzNjAwKSxcblxuICAvLyDmnI3liqHnq6/lj6PphY3nva5cbiAgQkFDS0VORF9HQVRFV0FZX1BPUlQ6IHouY29lcmNlLm51bWJlcigpLmludCgpLnBvc2l0aXZlKCkuZGVmYXVsdCgzMDAwKSxcbiAgQ1JFQVRJT05fQUdFTlRfSFRUUF9QT1JUOiB6LmNvZXJjZS5udW1iZXIoKS5pbnQoKS5wb3NpdGl2ZSgpLmRlZmF1bHQoODA4MCksXG4gIExPR0lDX0FHRU5UX0hUVFBfUE9SVDogei5jb2VyY2UubnVtYmVyKCkuaW50KCkucG9zaXRpdmUoKS5kZWZhdWx0KDgwODEpLFxuICBOQVJSQVRJVkVfQUdFTlRfSFRUUF9QT1JUOiB6LmNvZXJjZS5udW1iZXIoKS5pbnQoKS5wb3NpdGl2ZSgpLmRlZmF1bHQoODA4MiksXG59KVxuXG4vKipcbiAqIEB0eXBlIEVudlxuICogQGRlc2NyaXB0aW9uIOmqjOivgeWQjueahOeOr+Wig+WPmOmHj+exu+Wei1xuICovXG5leHBvcnQgdHlwZSBFbnYgPSB6LmluZmVyPHR5cGVvZiBlbnZTY2hlbWE+XG5cbi8qKlxuICogQGZ1bmN0aW9uIHZhbGlkYXRlRW52XG4gKiBAZGVzY3JpcHRpb24g6aqM6K+B546v5aKD5Y+Y6YePXG4gKiBAcmV0dXJucyDpqozor4HlkI7nmoTnjq/looPlj5jph49cbiAqIEB0aHJvd3Mge0Vycm9yfSDlpoLmnpzpqozor4HlpLHotKVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlRW52KCk6IEVudiB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGVudlNjaGVtYS5wYXJzZShwcm9jZXNzLmVudilcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiB6LlpvZEVycm9yKSB7XG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2VzID0gZXJyb3IuZXJyb3JzLm1hcCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnN0IHBhdGggPSBlcnIucGF0aC5qb2luKCcuJylcbiAgICAgICAgcmV0dXJuIGAke3BhdGh9OiAke2Vyci5tZXNzYWdlfWBcbiAgICAgIH0pXG5cbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYOeOr+Wig+WPmOmHj+mqjOivgeWksei0pTpcXG4ke2Vycm9yTWVzc2FnZXMuam9pbignXFxuJyl9XFxuXFxu6K+35qOA5p+lIC5lbnYg5paH5Lu25oiW546v5aKD5Y+Y6YeP6YWN572u44CCYFxuICAgICAgKVxuICAgIH1cbiAgICB0aHJvdyBlcnJvclxuICB9XG59XG4iXSwidmVyc2lvbiI6M30=