{"file":"C:\\Users\\16663\\Desktop\\tuheg\\packages\\common-backend\\src\\pipes\\zod-validation.pipe.ts","mappings":";AAAA,qDAAqD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAErD,2CAAoF;AACpF,6BAA8C;IAGjC,iBAAiB;4BAD7B,IAAA,mBAAU,GAAE;;;;;;;;YACb,6KAiBC;;;YAjBY,uDAAiB;;QACR,MAAM;QAA1B,YAAoB,MAAiB;YAAjB,WAAM,GAAN,MAAM,CAAW;QAAG,CAAC;QAEzC,SAAS,CAAC,KAAc;YACtB,IAAI,CAAC;gBACH,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;YACjC,CAAC;YAAC,OAAO,KAAK,EAAE,CAAC;gBACf,IAAI,KAAK,YAAY,cAAQ,EAAE,CAAC;oBAC9B,MAAM,IAAI,4BAAmB,CAAC;wBAC5B,UAAU,EAAE,GAAG;wBACf,OAAO,EAAE,mBAAmB;wBAC5B,MAAM,EAAE,KAAK,CAAC,OAAO,EAAE,CAAC,WAAW;qBACpC,CAAC,CAAA;gBACJ,CAAC;gBACD,MAAM,IAAI,4BAAmB,CAAC,yBAAyB,CAAC,CAAA;YAC1D,CAAC;QACH,CAAC;;;;AAhBU,8CAAiB","names":[],"sources":["C:\\Users\\16663\\Desktop\\tuheg\\packages\\common-backend\\src\\pipes\\zod-validation.pipe.ts"],"sourcesContent":["// 文件路径: libs/common/src/pipes/zod-validation.pipe.ts\n\nimport { BadRequestException, Injectable, type PipeTransform } from '@nestjs/common'\nimport { ZodError, type ZodSchema } from 'zod'\n\n@Injectable()\nexport class ZodValidationPipe implements PipeTransform {\n  constructor(private schema: ZodSchema) {}\n\n  transform(value: unknown): unknown {\n    try {\n      return this.schema.parse(value)\n    } catch (error) {\n      if (error instanceof ZodError) {\n        throw new BadRequestException({\n          statusCode: 400,\n          message: 'Validation failed',\n          errors: error.flatten().fieldErrors,\n        })\n      }\n      throw new BadRequestException('Invalid request payload')\n    }\n  }\n}\n"],"version":3}