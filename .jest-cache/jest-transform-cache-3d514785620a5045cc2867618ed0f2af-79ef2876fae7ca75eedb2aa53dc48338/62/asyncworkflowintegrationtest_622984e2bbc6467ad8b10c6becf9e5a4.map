{"file":"C:\\Users\\16663\\Desktop\\tuheg\\apps\\vcptoolbox\\src\\integration-tests\\async-workflow-integration.test.ts","mappings":"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","names":[],"sources":["C:\\Users\\16663\\Desktop\\tuheg\\apps\\vcptoolbox\\src\\integration-tests\\async-workflow-integration.test.ts"],"sourcesContent":["// ============================================================================\r\n// 异步工作流引擎集成测试\r\n// 验证 VCPToolBox 工作流编排能力的正确集成\r\n// ============================================================================\r\n\r\nimport { Test, TestingModule } from '@nestjs/testing'\r\nimport { ConfigService } from '@nestjs/config'\r\nimport { AsyncWorkflowService } from '../../../../packages/common-backend/src/vcp/async-workflow.service'\r\n\r\ndescribe('AsyncWorkflowService Integration', () => {\r\n  let service: AsyncWorkflowService\r\n  let configService: ConfigService\r\n\r\n  beforeEach(async () => {\r\n    const module: TestingModule = await Test.createTestingModule({\r\n      providers: [\r\n        AsyncWorkflowService,\r\n        {\r\n          provide: ConfigService,\r\n          useValue: {\r\n            get: jest.fn((key: string, defaultValue?: any) => {\r\n              const config = {\r\n                WORKFLOW_MAX_CONCURRENT: 10,\r\n                WORKFLOW_DEFAULT_TIMEOUT: 300000,\r\n                WORKFLOW_CLEANUP_INTERVAL: 24,\r\n                WORKFLOW_STATS_INTERVAL: 5\r\n              }\r\n              return config[key] || defaultValue\r\n            })\r\n          }\r\n        }\r\n      ]\r\n    }).compile()\r\n\r\n    service = module.get<AsyncWorkflowService>(AsyncWorkflowService)\r\n    configService = module.get<ConfigService>(ConfigService)\r\n  })\r\n\r\n  it('应该能获取工作流统计信息', () => {\r\n    const stats = service.getWorkflowStats()\r\n\r\n    expect(stats).toHaveProperty('templates')\r\n    expect(stats).toHaveProperty('instances')\r\n    expect(stats).toHaveProperty('runningInstances')\r\n    expect(stats).toHaveProperty('queuedInstances')\r\n    expect(stats).toHaveProperty('nodeExecutors')\r\n    expect(typeof stats.templates).toBe('number')\r\n  })\r\n\r\n  it('应该能执行健康检查', async () => {\r\n    const health = await service.healthCheck()\r\n\r\n    expect(health).toHaveProperty('status')\r\n    expect(['healthy', 'warning', 'error']).toContain(health.status)\r\n\r\n    if (health.status !== 'error') {\r\n      expect(health).toHaveProperty('details')\r\n      expect(health.details).toHaveProperty('stats')\r\n      expect(health.details).toHaveProperty('activeWorkflows')\r\n    }\r\n  })\r\n\r\n  it('应该能获取工作流性能指标', () => {\r\n    const metrics = service.getWorkflowMetrics()\r\n\r\n    expect(metrics).toHaveProperty('templates')\r\n    expect(metrics).toHaveProperty('activeWorkflows')\r\n    expect(metrics).toHaveProperty('averageCompletionTime')\r\n    expect(metrics).toHaveProperty('successRate')\r\n    expect(metrics).toHaveProperty('resourceUtilization')\r\n  })\r\n\r\n  it('应该能获取可用模板列表', () => {\r\n    const templates = service.getAvailableTemplates()\r\n\r\n    expect(Array.isArray(templates)).toBe(true)\r\n    expect(templates.length).toBeGreaterThan(0)\r\n\r\n    // 检查是否包含预期的模板\r\n    const templateNames = templates.map(t => t.name)\r\n    expect(templateNames).toContain('故事创作工作流')\r\n    expect(templateNames).toContain('角色开发工作流')\r\n    expect(templateNames).toContain('世界构建工作流')\r\n    expect(templateNames).toContain('多模态叙事工作流')\r\n\r\n    templates.forEach(template => {\r\n      expect(template).toHaveProperty('id')\r\n      expect(template).toHaveProperty('name')\r\n      expect(template).toHaveProperty('description')\r\n      expect(template).toHaveProperty('tags')\r\n      expect(Array.isArray(template.tags)).toBe(true)\r\n    })\r\n  })\r\n\r\n  it('应该能获取模板详情', () => {\r\n    const templates = service.getAvailableTemplates()\r\n    const firstTemplate = templates[0]\r\n\r\n    const details = service.getTemplateDetails(firstTemplate.id)\r\n    expect(details).not.toBeNull()\r\n    expect(details?.id).toBe(firstTemplate.id)\r\n    expect(details?.name).toBe(firstTemplate.name)\r\n    expect(details).toHaveProperty('nodes')\r\n    expect(details).toHaveProperty('connections')\r\n    expect(details).toHaveProperty('defaultConfig')\r\n    expect(Array.isArray(details?.nodes)).toBe(true)\r\n  })\r\n\r\n  it('应该能创建故事创作工作流', async () => {\r\n    const storyId = 'test-story-workflow'\r\n    const userPrompt = '写一个关于太空探索的故事'\r\n\r\n    const workflowId = await service.createStoryCreationWorkflow(storyId, userPrompt, {\r\n      genre: 'sci-fi',\r\n      length: 'medium',\r\n      characters: 3\r\n    })\r\n\r\n    expect(typeof workflowId).toBe('string')\r\n    expect(workflowId.length).toBeGreaterThan(0)\r\n\r\n    // 验证工作流状态\r\n    const status = service.getWorkflowStatus(workflowId)\r\n    expect(status).not.toBeNull()\r\n    expect(status?.name).toContain('故事创作')\r\n    expect(status?.status).toBe('running') // 应该自动启动\r\n  })\r\n\r\n  it('应该能创建角色开发工作流', async () => {\r\n    const characterId = 'test-character-workflow'\r\n    const characterConcept = '一个勇敢的年轻探险家'\r\n\r\n    const workflowId = await service.createCharacterDevelopmentWorkflow(characterId, characterConcept, {\r\n      archetype: 'hero',\r\n      complexity: 'detailed'\r\n    })\r\n\r\n    expect(typeof workflowId).toBe('string')\r\n\r\n    const status = service.getWorkflowStatus(workflowId)\r\n    expect(status).not.toBeNull()\r\n    expect(status?.name).toContain('角色开发')\r\n    expect(status?.status).toBe('running')\r\n  })\r\n\r\n  it('应该能创建世界构建工作流', async () => {\r\n    const worldId = 'test-world-workflow'\r\n    const worldConcept = '一个魔法与科技并存的奇幻世界'\r\n\r\n    const workflowId = await service.createWorldBuildingWorkflow(worldId, worldConcept, {\r\n      scope: 'large',\r\n      genre: 'fantasy',\r\n      technologyLevel: 'magitech',\r\n      magicLevel: 'high'\r\n    })\r\n\r\n    expect(typeof workflowId).toBe('string')\r\n\r\n    const status = service.getWorkflowStatus(workflowId)\r\n    expect(status).not.toBeNull()\r\n    expect(status?.name).toContain('世界构建')\r\n    expect(status?.status).toBe('running')\r\n  })\r\n\r\n  it('应该能创建多模态叙事工作流', async () => {\r\n    const narrativeId = 'test-multimodal-workflow'\r\n    const script = '从前有一个勇敢的小孩，他决定探索未知的世界...'\r\n\r\n    const workflowId = await service.createMultimodalNarrativeWorkflow(narrativeId, script, [\r\n      'text', 'image', 'audio'\r\n    ])\r\n\r\n    expect(typeof workflowId).toBe('string')\r\n\r\n    const status = service.getWorkflowStatus(workflowId)\r\n    expect(status).not.toBeNull()\r\n    expect(status?.name).toContain('多模态叙事')\r\n    expect(status?.status).toBe('running')\r\n  })\r\n\r\n  it('应该能管理工作流生命周期', async () => {\r\n    // 创建一个简单的工作流用于测试\r\n    const storyId = 'lifecycle-test'\r\n    const workflowId = await service.createStoryCreationWorkflow(storyId, '测试生命周期')\r\n\r\n    // 验证初始状态\r\n    let status = service.getWorkflowStatus(workflowId)\r\n    expect(status?.status).toBe('running')\r\n\r\n    // 暂停工作流\r\n    await service.pauseWorkflow(workflowId)\r\n    status = service.getWorkflowStatus(workflowId)\r\n    expect(status?.status).toBe('paused')\r\n\r\n    // 恢复工作流\r\n    await service.resumeWorkflow(workflowId)\r\n    status = service.getWorkflowStatus(workflowId)\r\n    expect(status?.status).toBe('running')\r\n\r\n    // 取消工作流\r\n    await service.cancelWorkflow(workflowId, '测试取消')\r\n    status = service.getWorkflowStatus(workflowId)\r\n    expect(status?.status).toBe('cancelled')\r\n  })\r\n\r\n  it('应该能创建条件分支工作流', async () => {\r\n    const conditions = [\r\n      {\r\n        condition: 'inputData.genre === \"fantasy\"',\r\n        workflowTemplate: 'story-creation',\r\n        parameters: { genre: 'fantasy' }\r\n      },\r\n      {\r\n        condition: 'inputData.genre === \"sci-fi\"',\r\n        workflowTemplate: 'story-creation',\r\n        parameters: { genre: 'sci-fi' }\r\n      }\r\n    ]\r\n\r\n    const workflowId = await service.createConditionalWorkflow('条件故事创作', conditions)\r\n\r\n    expect(typeof workflowId).toBe('string')\r\n\r\n    const status = service.getWorkflowStatus(workflowId)\r\n    expect(status).not.toBeNull()\r\n    expect(status?.name).toContain('条件工作流')\r\n  })\r\n\r\n  it('应该能获取活跃工作流列表', () => {\r\n    const activeWorkflows = service.getActiveWorkflows()\r\n    expect(Array.isArray(activeWorkflows)).toBe(true)\r\n    // 当前实现可能返回空数组，取决于实际运行的工作流\r\n  })\r\n\r\n  it('应该能清理已完成的工作流', async () => {\r\n    const cleaned = await service.cleanupCompletedWorkflows(0) // 清理所有已完成的\r\n    expect(typeof cleaned).toBe('number')\r\n    expect(cleaned).toBeGreaterThanOrEqual(0)\r\n  })\r\n\r\n  it('应该能创建基于模板的工作流实例', async () => {\r\n    const templates = service.getAvailableTemplates()\r\n    const storyTemplate = templates.find(t => t.name === '故事创作工作流')\r\n\r\n    expect(storyTemplate).toBeDefined()\r\n\r\n    const workflowId = await service.createWorkflowFromTemplate('story-creation', '基于模板的故事', {\r\n      priority: 'high',\r\n      inputData: { customPrompt: '测试模板实例化' }\r\n    })\r\n\r\n    expect(typeof workflowId).toBe('string')\r\n\r\n    const status = service.getWorkflowStatus(workflowId)\r\n    expect(status).not.toBeNull()\r\n    expect(status?.name).toBe('基于模板的故事')\r\n  })\r\n\r\n  it('应该能创建自定义工作流', async () => {\r\n    const customTemplate = {\r\n      name: '自定义测试工作流',\r\n      description: '用于测试的简单工作流',\r\n      version: '1.0.0',\r\n      nodes: [\r\n        {\r\n          id: 'start-node',\r\n          type: 'task' as const,\r\n          name: '开始任务',\r\n          description: '工作流的起始任务',\r\n          config: { taskType: 'test' },\r\n          inputs: [],\r\n          outputs: [{ id: 'start-out', sourceNodeId: 'start-node', targetNodeId: 'end-node' }],\r\n          status: 'pending' as const,\r\n          retryCount: 0,\r\n          maxRetries: 1,\r\n          timeout: 30000\r\n        },\r\n        {\r\n          id: 'end-node',\r\n          type: 'task' as const,\r\n          name: '结束任务',\r\n          description: '工作流的结束任务',\r\n          config: { taskType: 'test' },\r\n          inputs: [{ id: 'end-in', sourceNodeId: 'start-node', targetNodeId: 'end-node' }],\r\n          outputs: [],\r\n          status: 'pending' as const,\r\n          retryCount: 0,\r\n          maxRetries: 1,\r\n          timeout: 30000,\r\n          dependencies: ['start-node']\r\n        }\r\n      ],\r\n      connections: [],\r\n      defaultConfig: {\r\n        maxRetries: 1,\r\n        timeout: 60000,\r\n        priority: 'normal' as const\r\n      },\r\n      tags: ['test', 'custom']\r\n    }\r\n\r\n    const workflowId = await service.createCustomWorkflow(customTemplate, '自定义工作流测试')\r\n\r\n    expect(typeof workflowId).toBe('string')\r\n\r\n    const status = service.getWorkflowStatus(workflowId)\r\n    expect(status).not.toBeNull()\r\n    expect(status?.name).toBe('自定义工作流测试')\r\n  })\r\n\r\n  it('应该正确配置工作流参数', () => {\r\n    expect(configService.get).toHaveBeenCalledWith('WORKFLOW_MAX_CONCURRENT', 10)\r\n    expect(configService.get).toHaveBeenCalledWith('WORKFLOW_DEFAULT_TIMEOUT', 300000)\r\n  })\r\n})\r\n"],"version":3}