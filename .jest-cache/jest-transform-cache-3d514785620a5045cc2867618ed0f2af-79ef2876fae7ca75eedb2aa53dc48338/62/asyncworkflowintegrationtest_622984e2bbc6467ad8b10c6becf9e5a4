45fe37b399bf731a5dad79b2ad3257bb
"use strict";
// ============================================================================
// 异步工作流引擎集成测试
// 验证 VCPToolBox 工作流编排能力的正确集成
// ============================================================================
Object.defineProperty(exports, "__esModule", { value: true });
const testing_1 = require("@nestjs/testing");
const config_1 = require("@nestjs/config");
const async_workflow_service_1 = require("../../../../packages/common-backend/src/vcp/async-workflow.service");
describe('AsyncWorkflowService Integration', () => {
    let service;
    let configService;
    beforeEach(async () => {
        const module = await testing_1.Test.createTestingModule({
            providers: [
                async_workflow_service_1.AsyncWorkflowService,
                {
                    provide: config_1.ConfigService,
                    useValue: {
                        get: jest.fn((key, defaultValue) => {
                            const config = {
                                WORKFLOW_MAX_CONCURRENT: 10,
                                WORKFLOW_DEFAULT_TIMEOUT: 300000,
                                WORKFLOW_CLEANUP_INTERVAL: 24,
                                WORKFLOW_STATS_INTERVAL: 5
                            };
                            return config[key] || defaultValue;
                        })
                    }
                }
            ]
        }).compile();
        service = module.get(async_workflow_service_1.AsyncWorkflowService);
        configService = module.get(config_1.ConfigService);
    });
    it('应该能获取工作流统计信息', () => {
        const stats = service.getWorkflowStats();
        expect(stats).toHaveProperty('templates');
        expect(stats).toHaveProperty('instances');
        expect(stats).toHaveProperty('runningInstances');
        expect(stats).toHaveProperty('queuedInstances');
        expect(stats).toHaveProperty('nodeExecutors');
        expect(typeof stats.templates).toBe('number');
    });
    it('应该能执行健康检查', async () => {
        const health = await service.healthCheck();
        expect(health).toHaveProperty('status');
        expect(['healthy', 'warning', 'error']).toContain(health.status);
        if (health.status !== 'error') {
            expect(health).toHaveProperty('details');
            expect(health.details).toHaveProperty('stats');
            expect(health.details).toHaveProperty('activeWorkflows');
        }
    });
    it('应该能获取工作流性能指标', () => {
        const metrics = service.getWorkflowMetrics();
        expect(metrics).toHaveProperty('templates');
        expect(metrics).toHaveProperty('activeWorkflows');
        expect(metrics).toHaveProperty('averageCompletionTime');
        expect(metrics).toHaveProperty('successRate');
        expect(metrics).toHaveProperty('resourceUtilization');
    });
    it('应该能获取可用模板列表', () => {
        const templates = service.getAvailableTemplates();
        expect(Array.isArray(templates)).toBe(true);
        expect(templates.length).toBeGreaterThan(0);
        // 检查是否包含预期的模板
        const templateNames = templates.map(t => t.name);
        expect(templateNames).toContain('故事创作工作流');
        expect(templateNames).toContain('角色开发工作流');
        expect(templateNames).toContain('世界构建工作流');
        expect(templateNames).toContain('多模态叙事工作流');
        templates.forEach(template => {
            expect(template).toHaveProperty('id');
            expect(template).toHaveProperty('name');
            expect(template).toHaveProperty('description');
            expect(template).toHaveProperty('tags');
            expect(Array.isArray(template.tags)).toBe(true);
        });
    });
    it('应该能获取模板详情', () => {
        const templates = service.getAvailableTemplates();
        const firstTemplate = templates[0];
        const details = service.getTemplateDetails(firstTemplate.id);
        expect(details).not.toBeNull();
        expect(details?.id).toBe(firstTemplate.id);
        expect(details?.name).toBe(firstTemplate.name);
        expect(details).toHaveProperty('nodes');
        expect(details).toHaveProperty('connections');
        expect(details).toHaveProperty('defaultConfig');
        expect(Array.isArray(details?.nodes)).toBe(true);
    });
    it('应该能创建故事创作工作流', async () => {
        const storyId = 'test-story-workflow';
        const userPrompt = '写一个关于太空探索的故事';
        const workflowId = await service.createStoryCreationWorkflow(storyId, userPrompt, {
            genre: 'sci-fi',
            length: 'medium',
            characters: 3
        });
        expect(typeof workflowId).toBe('string');
        expect(workflowId.length).toBeGreaterThan(0);
        // 验证工作流状态
        const status = service.getWorkflowStatus(workflowId);
        expect(status).not.toBeNull();
        expect(status?.name).toContain('故事创作');
        expect(status?.status).toBe('running'); // 应该自动启动
    });
    it('应该能创建角色开发工作流', async () => {
        const characterId = 'test-character-workflow';
        const characterConcept = '一个勇敢的年轻探险家';
        const workflowId = await service.createCharacterDevelopmentWorkflow(characterId, characterConcept, {
            archetype: 'hero',
            complexity: 'detailed'
        });
        expect(typeof workflowId).toBe('string');
        const status = service.getWorkflowStatus(workflowId);
        expect(status).not.toBeNull();
        expect(status?.name).toContain('角色开发');
        expect(status?.status).toBe('running');
    });
    it('应该能创建世界构建工作流', async () => {
        const worldId = 'test-world-workflow';
        const worldConcept = '一个魔法与科技并存的奇幻世界';
        const workflowId = await service.createWorldBuildingWorkflow(worldId, worldConcept, {
            scope: 'large',
            genre: 'fantasy',
            technologyLevel: 'magitech',
            magicLevel: 'high'
        });
        expect(typeof workflowId).toBe('string');
        const status = service.getWorkflowStatus(workflowId);
        expect(status).not.toBeNull();
        expect(status?.name).toContain('世界构建');
        expect(status?.status).toBe('running');
    });
    it('应该能创建多模态叙事工作流', async () => {
        const narrativeId = 'test-multimodal-workflow';
        const script = '从前有一个勇敢的小孩，他决定探索未知的世界...';
        const workflowId = await service.createMultimodalNarrativeWorkflow(narrativeId, script, [
            'text', 'image', 'audio'
        ]);
        expect(typeof workflowId).toBe('string');
        const status = service.getWorkflowStatus(workflowId);
        expect(status).not.toBeNull();
        expect(status?.name).toContain('多模态叙事');
        expect(status?.status).toBe('running');
    });
    it('应该能管理工作流生命周期', async () => {
        // 创建一个简单的工作流用于测试
        const storyId = 'lifecycle-test';
        const workflowId = await service.createStoryCreationWorkflow(storyId, '测试生命周期');
        // 验证初始状态
        let status = service.getWorkflowStatus(workflowId);
        expect(status?.status).toBe('running');
        // 暂停工作流
        await service.pauseWorkflow(workflowId);
        status = service.getWorkflowStatus(workflowId);
        expect(status?.status).toBe('paused');
        // 恢复工作流
        await service.resumeWorkflow(workflowId);
        status = service.getWorkflowStatus(workflowId);
        expect(status?.status).toBe('running');
        // 取消工作流
        await service.cancelWorkflow(workflowId, '测试取消');
        status = service.getWorkflowStatus(workflowId);
        expect(status?.status).toBe('cancelled');
    });
    it('应该能创建条件分支工作流', async () => {
        const conditions = [
            {
                condition: 'inputData.genre === "fantasy"',
                workflowTemplate: 'story-creation',
                parameters: { genre: 'fantasy' }
            },
            {
                condition: 'inputData.genre === "sci-fi"',
                workflowTemplate: 'story-creation',
                parameters: { genre: 'sci-fi' }
            }
        ];
        const workflowId = await service.createConditionalWorkflow('条件故事创作', conditions);
        expect(typeof workflowId).toBe('string');
        const status = service.getWorkflowStatus(workflowId);
        expect(status).not.toBeNull();
        expect(status?.name).toContain('条件工作流');
    });
    it('应该能获取活跃工作流列表', () => {
        const activeWorkflows = service.getActiveWorkflows();
        expect(Array.isArray(activeWorkflows)).toBe(true);
        // 当前实现可能返回空数组，取决于实际运行的工作流
    });
    it('应该能清理已完成的工作流', async () => {
        const cleaned = await service.cleanupCompletedWorkflows(0); // 清理所有已完成的
        expect(typeof cleaned).toBe('number');
        expect(cleaned).toBeGreaterThanOrEqual(0);
    });
    it('应该能创建基于模板的工作流实例', async () => {
        const templates = service.getAvailableTemplates();
        const storyTemplate = templates.find(t => t.name === '故事创作工作流');
        expect(storyTemplate).toBeDefined();
        const workflowId = await service.createWorkflowFromTemplate('story-creation', '基于模板的故事', {
            priority: 'high',
            inputData: { customPrompt: '测试模板实例化' }
        });
        expect(typeof workflowId).toBe('string');
        const status = service.getWorkflowStatus(workflowId);
        expect(status).not.toBeNull();
        expect(status?.name).toBe('基于模板的故事');
    });
    it('应该能创建自定义工作流', async () => {
        const customTemplate = {
            name: '自定义测试工作流',
            description: '用于测试的简单工作流',
            version: '1.0.0',
            nodes: [
                {
                    id: 'start-node',
                    type: 'task',
                    name: '开始任务',
                    description: '工作流的起始任务',
                    config: { taskType: 'test' },
                    inputs: [],
                    outputs: [{ id: 'start-out', sourceNodeId: 'start-node', targetNodeId: 'end-node' }],
                    status: 'pending',
                    retryCount: 0,
                    maxRetries: 1,
                    timeout: 30000
                },
                {
                    id: 'end-node',
                    type: 'task',
                    name: '结束任务',
                    description: '工作流的结束任务',
                    config: { taskType: 'test' },
                    inputs: [{ id: 'end-in', sourceNodeId: 'start-node', targetNodeId: 'end-node' }],
                    outputs: [],
                    status: 'pending',
                    retryCount: 0,
                    maxRetries: 1,
                    timeout: 30000,
                    dependencies: ['start-node']
                }
            ],
            connections: [],
            defaultConfig: {
                maxRetries: 1,
                timeout: 60000,
                priority: 'normal'
            },
            tags: ['test', 'custom']
        };
        const workflowId = await service.createCustomWorkflow(customTemplate, '自定义工作流测试');
        expect(typeof workflowId).toBe('string');
        const status = service.getWorkflowStatus(workflowId);
        expect(status).not.toBeNull();
        expect(status?.name).toBe('自定义工作流测试');
    });
    it('应该正确配置工作流参数', () => {
        expect(configService.get).toHaveBeenCalledWith('WORKFLOW_MAX_CONCURRENT', 10);
        expect(configService.get).toHaveBeenCalledWith('WORKFLOW_DEFAULT_TIMEOUT', 300000);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFwxNjY2M1xcRGVza3RvcFxcdHVoZWdcXGFwcHNcXHZjcHRvb2xib3hcXHNyY1xcaW50ZWdyYXRpb24tdGVzdHNcXGFzeW5jLXdvcmtmbG93LWludGVncmF0aW9uLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBLCtFQUErRTtBQUMvRSxjQUFjO0FBQ2QsNkJBQTZCO0FBQzdCLCtFQUErRTs7QUFFL0UsNkNBQXFEO0FBQ3JELDJDQUE4QztBQUM5QywrR0FBeUc7QUFFekcsUUFBUSxDQUFDLGtDQUFrQyxFQUFFLEdBQUcsRUFBRTtJQUNoRCxJQUFJLE9BQTZCLENBQUE7SUFDakMsSUFBSSxhQUE0QixDQUFBO0lBRWhDLFVBQVUsQ0FBQyxLQUFLLElBQUksRUFBRTtRQUNwQixNQUFNLE1BQU0sR0FBa0IsTUFBTSxjQUFJLENBQUMsbUJBQW1CLENBQUM7WUFDM0QsU0FBUyxFQUFFO2dCQUNULDZDQUFvQjtnQkFDcEI7b0JBQ0UsT0FBTyxFQUFFLHNCQUFhO29CQUN0QixRQUFRLEVBQUU7d0JBQ1IsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFXLEVBQUUsWUFBa0IsRUFBRSxFQUFFOzRCQUMvQyxNQUFNLE1BQU0sR0FBRztnQ0FDYix1QkFBdUIsRUFBRSxFQUFFO2dDQUMzQix3QkFBd0IsRUFBRSxNQUFNO2dDQUNoQyx5QkFBeUIsRUFBRSxFQUFFO2dDQUM3Qix1QkFBdUIsRUFBRSxDQUFDOzZCQUMzQixDQUFBOzRCQUNELE9BQU8sTUFBTSxDQUFDLEdBQUcsQ0FBQyxJQUFJLFlBQVksQ0FBQTt3QkFDcEMsQ0FBQyxDQUFDO3FCQUNIO2lCQUNGO2FBQ0Y7U0FDRixDQUFDLENBQUMsT0FBTyxFQUFFLENBQUE7UUFFWixPQUFPLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBdUIsNkNBQW9CLENBQUMsQ0FBQTtRQUNoRSxhQUFhLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBZ0Isc0JBQWEsQ0FBQyxDQUFBO0lBQzFELENBQUMsQ0FBQyxDQUFBO0lBRUYsRUFB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Q0FBQyxPQUFPLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQTtRQUV4QyxNQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsaUJBQWlCLENBQUMsVUFBVSxDQUFDLENBQUE7UUFDcEQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQTtRQUM3QixNQUFNLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQTtJQUN2QyxDQUFDLENBQUMsQ0FBQTtJQUVGLEVBQUUsQ0FBQyxhQUFhLEVBQUUsR0FBRyxFQUFFO1FBQ3JCLE1BQU0sQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUMsb0JBQW9CLENBQUMseUJBQXlCLEVBQUUsRUFBRSxDQUFDLENBQUE7UUFDN0UsTUFBTSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQywwQkFBMEIsRUFBRSxNQUFNLENBQUMsQ0FBQTtJQUNwRixDQUFDLENBQUMsQ0FBQTtBQUNKLENBQUMsQ0FBQyxDQUFBIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcMTY2NjNcXERlc2t0b3BcXHR1aGVnXFxhcHBzXFx2Y3B0b29sYm94XFxzcmNcXGludGVncmF0aW9uLXRlc3RzXFxhc3luYy13b3JrZmxvdy1pbnRlZ3JhdGlvbi50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8g5byC5q2l5bel5L2c5rWB5byV5pOO6ZuG5oiQ5rWL6K+VXHJcbi8vIOmqjOivgSBWQ1BUb29sQm94IOW3peS9nOa1gee8luaOkuiDveWKm+eahOato+ehrumbhuaIkFxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5pbXBvcnQgeyBUZXN0LCBUZXN0aW5nTW9kdWxlIH0gZnJvbSAnQG5lc3Rqcy90ZXN0aW5nJ1xyXG5pbXBvcnQgeyBDb25maWdTZXJ2aWNlIH0gZnJvbSAnQG5lc3Rqcy9jb25maWcnXHJcbmltcG9ydCB7IEFzeW5jV29ya2Zsb3dTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vLi4vcGFja2FnZXMvY29tbW9uLWJhY2tlbmQvc3JjL3ZjcC9hc3luYy13b3JrZmxvdy5zZXJ2aWNlJ1xyXG5cclxuZGVzY3JpYmUoJ0FzeW5jV29ya2Zsb3dTZXJ2aWNlIEludGVncmF0aW9uJywgKCkgPT4ge1xyXG4gIGxldCBzZXJ2aWNlOiBBc3luY1dvcmtmbG93U2VydmljZVxyXG4gIGxldCBjb25maWdTZXJ2aWNlOiBDb25maWdTZXJ2aWNlXHJcblxyXG4gIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcclxuICAgICAgcHJvdmlkZXJzOiBbXHJcbiAgICAgICAgQXN5bmNXb3JrZmxvd1NlcnZpY2UsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcHJvdmlkZTogQ29uZmlnU2VydmljZSxcclxuICAgICAgICAgIHVzZVZhbHVlOiB7XHJcbiAgICAgICAgICAgIGdldDogamVzdC5mbigoa2V5OiBzdHJpbmcsIGRlZmF1bHRWYWx1ZT86IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IHtcclxuICAgICAgICAgICAgICAgIFdPUktGTE9XX01BWF9DT05DVVJSRU5UOiAxMCxcclxuICAgICAgICAgICAgICAgIFdPUktGTE9XX0RFRkFVTFRfVElNRU9VVDogMzAwMDAwLFxyXG4gICAgICAgICAgICAgICAgV09SS0ZMT1dfQ0xFQU5VUF9JTlRFUlZBTDogMjQsXHJcbiAgICAgICAgICAgICAgICBXT1JLRkxPV19TVEFUU19JTlRFUlZBTDogNVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICByZXR1cm4gY29uZmlnW2tleV0gfHwgZGVmYXVsdFZhbHVlXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICBdXHJcbiAgICB9KS5jb21waWxlKClcclxuXHJcbiAgICBzZXJ2aWNlID0gbW9kdWxlLmdldDxBc3luY1dvcmtmbG93U2VydmljZT4oQXN5bmNXb3JrZmxvd1NlcnZpY2UpXHJcbiAgICBjb25maWdTZXJ2aWNlID0gbW9kdWxlLmdldDxDb25maWdTZXJ2aWNlPihDb25maWdTZXJ2aWNlKVxyXG4gIH0pXHJcblxyXG4gIGl0KCflupTor6Xog73ojrflj5blt6XkvZzmtYHnu5/orqHkv6Hmga8nLCAoKSA9PiB7XHJcbiAgICBjb25zdCBzdGF0cyA9IHNlcnZpY2UuZ2V0V29ya2Zsb3dTdGF0cygpXHJcblxyXG4gICAgZXhwZWN0KHN0YXRzKS50b0hhdmVQcm9wZXJ0eSgndGVtcGxhdGVzJylcclxuICAgIGV4cGVjdChzdGF0cykudG9IYXZlUHJvcGVydHkoJ2luc3RhbmNlcycpXHJcbiAgICBleHBlY3Qoc3RhdHMpLnRvSGF2ZVByb3BlcnR5KCdydW5uaW5nSW5zdGFuY2VzJylcclxuICAgIGV4cGVjdChzdGF0cykudG9IYXZlUHJvcGVydHkoJ3F1ZXVlZEluc3RhbmNlcycpXHJcbiAgICBleHBlY3Qoc3RhdHMpLnRvSGF2ZVByb3BlcnR5KCdub2RlRXhlY3V0b3JzJylcclxuICAgIGV4cGVjdCh0eXBlb2Ygc3RhdHMudGVtcGxhdGVzKS50b0JlKCdudW1iZXInKVxyXG4gIH0pXHJcblxyXG4gIGl0KCflupTor6Xog73miafooYzlgaXlurfmo4Dmn6UnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBoZWFsdGggPSBhd2FpdCBzZXJ2aWNlLmhlYWx0aENoZWNrKClcclxuXHJcbiAgICBleHBlY3QoaGVhbHRoKS50b0hhdmVQcm9wZXJ0eSgnc3RhdHVzJylcclxuICAgIGV4cGVjdChbJ2hlYWx0aHknLCAnd2FybmluZycsICdlcnJvciddKS50b0NvbnRhaW4oaGVhbHRoLnN0YXR1cylcclxuXHJcbiAgICBpZiAoaGVhbHRoLnN0YXR1cyAhPT0gJ2Vycm9yJykge1xyXG4gICAgICBleHBlY3QoaGVhbHRoKS50b0hhdmVQcm9wZXJ0eSgnZGV0YWlscycpXHJcbiAgICAgIGV4cGVjdChoZWFsdGguZGV0YWlscykudG9IYXZlUHJvcGVydHkoJ3N0YXRzJylcclxuICAgICAgZXhwZWN0KGhlYWx0aC5kZXRhaWxzKS50b0hhdmVQcm9wZXJ0eSgnYWN0aXZlV29ya2Zsb3dzJylcclxuICAgIH1cclxuICB9KVxyXG5cclxuICBpdCgn5bqU6K+l6IO96I635Y+W5bel5L2c5rWB5oCn6IO95oyH5qCHJywgKCkgPT4ge1xyXG4gICAgY29uc3QgbWV0cmljcyA9IHNlcnZpY2UuZ2V0V29ya2Zsb3dNZXRyaWNzKClcclxuXHJcbiAgICBleHBlY3QobWV0cmljcykudG9IYXZlUHJvcGVydHkoJ3RlbXBsYXRlcycpXHJcbiAgICBleHBlY3QobWV0cmljcykudG9IYXZlUHJvcGVydHkoJ2FjdGl2ZVdvcmtmbG93cycpXHJcbiAgICBleHBlY3QobWV0cmljcykudG9IYXZlUHJvcGVydHkoJ2F2ZXJhZ2VDb21wbGV0aW9uVGltZScpXHJcbiAgICBleHBlY3QobWV0cmljcykudG9IYXZlUHJvcGVydHkoJ3N1Y2Nlc3NSYXRlJylcclxuICAgIGV4cGVjdChtZXRyaWNzKS50b0hhdmVQcm9wZXJ0eSgncmVzb3VyY2VVdGlsaXphdGlvbicpXHJcbiAgfSlcclxuXHJcbiAgaXQoJ+W6lOivpeiDveiOt+WPluWPr+eUqOaooeadv+WIl+ihqCcsICgpID0+IHtcclxuICAgIGNvbnN0IHRlbXBsYXRlcyA9IHNlcnZpY2UuZ2V0QXZhaWxhYmxlVGVtcGxhdGVzKClcclxuXHJcbiAgICBleHBlY3QoQXJyYXkuaXNBcnJheSh0ZW1wbGF0ZXMpKS50b0JlKHRydWUpXHJcbiAgICBleHBlY3QodGVtcGxhdGVzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApXHJcblxyXG4gICAgLy8g5qOA5p+l5piv5ZCm5YyF5ZCr6aKE5pyf55qE5qih5p2/XHJcbiAgICBjb25zdCB0ZW1wbGF0ZU5hbWVzID0gdGVtcGxhdGVzLm1hcCh0ID0+IHQubmFtZSlcclxuICAgIGV4cGVjdCh0ZW1wbGF0ZU5hbWVzKS50b0NvbnRhaW4oJ+aVheS6i+WIm+S9nOW3peS9nOa1gScpXHJcbiAgICBleHBlY3QodGVtcGxhdGVOYW1lcykudG9Db250YWluKCfop5LoibLlvIDlj5Hlt6XkvZzmtYEnKVxyXG4gICAgZXhwZWN0KHRlbXBsYXRlTmFtZXMpLnRvQ29udGFpbign5LiW55WM5p6E5bu65bel5L2c5rWBJylcclxuICAgIGV4cGVjdCh0ZW1wbGF0ZU5hbWVzKS50b0NvbnRhaW4oJ+WkmuaooeaAgeWPmeS6i+W3peS9nOa1gScpXHJcblxyXG4gICAgdGVtcGxhdGVzLmZvckVhY2godGVtcGxhdGUgPT4ge1xyXG4gICAgICBleHBlY3QodGVtcGxhdGUpLnRvSGF2ZVByb3BlcnR5KCdpZCcpXHJcbiAgICAgIGV4cGVjdCh0ZW1wbGF0ZSkudG9IYXZlUHJvcGVydHkoJ25hbWUnKVxyXG4gICAgICBleHBlY3QodGVtcGxhdGUpLnRvSGF2ZVByb3BlcnR5KCdkZXNjcmlwdGlvbicpXHJcbiAgICAgIGV4cGVjdCh0ZW1wbGF0ZSkudG9IYXZlUHJvcGVydHkoJ3RhZ3MnKVxyXG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheSh0ZW1wbGF0ZS50YWdzKSkudG9CZSh0cnVlKVxyXG4gICAgfSlcclxuICB9KVxyXG5cclxuICBpdCgn5bqU6K+l6IO96I635Y+W5qih5p2/6K+m5oOFJywgKCkgPT4ge1xyXG4gICAgY29uc3QgdGVtcGxhdGVzID0gc2VydmljZS5nZXRBdmFpbGFibGVUZW1wbGF0ZXMoKVxyXG4gICAgY29uc3QgZmlyc3RUZW1wbGF0ZSA9IHRlbXBsYXRlc1swXVxyXG5cclxuICAgIGNvbnN0IGRldGFpbHMgPSBzZXJ2aWNlLmdldFRlbXBsYXRlRGV0YWlscyhmaXJzdFRlbXBsYXRlLmlkKVxyXG4gICAgZXhwZWN0KGRldGFpbHMpLm5vdC50b0JlTnVsbCgpXHJcbiAgICBleHBlY3QoZGV0YWlscz8uaWQpLnRvQmUoZmlyc3RUZW1wbGF0ZS5pZClcclxuICAgIGV4cGVjdChkZXRhaWxzPy5uYW1lKS50b0JlKGZpcnN0VGVtcGxhdGUubmFtZSlcclxuICAgIGV4cGVjdChkZXRhaWxzKS50b0hhdmVQcm9wZXJ0eSgnbm9kZXMnKVxyXG4gICAgZXhwZWN0KGRldGFpbHMpLnRvSGF2ZVByb3BlcnR5KCdjb25uZWN0aW9ucycpXHJcbiAgICBleHBlY3QoZGV0YWlscykudG9IYXZlUHJvcGVydHkoJ2RlZmF1bHRDb25maWcnKVxyXG4gICAgZXhwZWN0KEFycmF5LmlzQXJyYXkoZGV0YWlscz8ubm9kZXMpKS50b0JlKHRydWUpXHJcbiAgfSlcclxuXHJcbiAgaXQoJ+W6lOivpeiDveWIm+W7uuaVheS6i+WIm+S9nOW3peS9nOa1gScsIGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IHN0b3J5SWQgPSAndGVzdC1zdG9yeS13b3JrZmxvdydcclxuICAgIGNvbnN0IHVzZXJQcm9tcHQgPSAn5YaZ5LiA5Liq5YWz5LqO5aSq56m65o6i57Si55qE5pWF5LqLJ1xyXG5cclxuICAgIGNvbnN0IHdvcmtmbG93SWQgPSBhd2FpdCBzZXJ2aWNlLmNyZWF0ZVN0b3J5Q3JlYXRpb25Xb3JrZmxvdyhzdG9yeUlkLCB1c2VyUHJvbXB0LCB7XHJcbiAgICAgIGdlbnJlOiAnc2NpLWZpJyxcclxuICAgICAgbGVuZ3RoOiAnbWVkaXVtJyxcclxuICAgICAgY2hhcmFjdGVyczogM1xyXG4gICAgfSlcclxuXHJcbiAgICBleHBlY3QodHlwZW9mIHdvcmtmbG93SWQpLnRvQmUoJ3N0cmluZycpXHJcbiAgICBleHBlY3Qod29ya2Zsb3dJZC5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKVxyXG5cclxuICAgIC8vIOmqjOivgeW3peS9nOa1geeKtuaAgVxyXG4gICAgY29uc3Qgc3RhdHVzID0gc2VydmljZS5nZXRXb3JrZmxvd1N0YXR1cyh3b3JrZmxvd0lkKVxyXG4gICAgZXhwZWN0KHN0YXR1cykubm90LnRvQmVOdWxsKClcclxuICAgIGV4cGVjdChzdGF0dXM/Lm5hbWUpLnRvQ29udGFpbign5pWF5LqL5Yib5L2cJylcclxuICAgIGV4cGVjdChzdGF0dXM/LnN0YXR1cykudG9CZSgncnVubmluZycpIC8vIOW6lOivpeiHquWKqOWQr+WKqFxyXG4gIH0pXHJcblxyXG4gIGl0KCflupTor6Xog73liJvlu7rop5LoibLlvIDlj5Hlt6XkvZzmtYEnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBjaGFyYWN0ZXJJZCA9ICd0ZXN0LWNoYXJhY3Rlci13b3JrZmxvdydcclxuICAgIGNvbnN0IGNoYXJhY3RlckNvbmNlcHQgPSAn5LiA5Liq5YuH5pWi55qE5bm06L275o6i6Zmp5a62J1xyXG5cclxuICAgIGNvbnN0IHdvcmtmbG93SWQgPSBhd2FpdCBzZXJ2aWNlLmNyZWF0ZUNoYXJhY3RlckRldmVsb3BtZW50V29ya2Zsb3coY2hhcmFjdGVySWQsIGNoYXJhY3RlckNvbmNlcHQsIHtcclxuICAgICAgYXJjaGV0eXBlOiAnaGVybycsXHJcbiAgICAgIGNvbXBsZXhpdHk6ICdkZXRhaWxlZCdcclxuICAgIH0pXHJcblxyXG4gICAgZXhwZWN0KHR5cGVvZiB3b3JrZmxvd0lkKS50b0JlKCdzdHJpbmcnKVxyXG5cclxuICAgIGNvbnN0IHN0YXR1cyA9IHNlcnZpY2UuZ2V0V29ya2Zsb3dTdGF0dXMod29ya2Zsb3dJZClcclxuICAgIGV4cGVjdChzdGF0dXMpLm5vdC50b0JlTnVsbCgpXHJcbiAgICBleHBlY3Qoc3RhdHVzPy5uYW1lKS50b0NvbnRhaW4oJ+inkuiJsuW8gOWPkScpXHJcbiAgICBleHBlY3Qoc3RhdHVzPy5zdGF0dXMpLnRvQmUoJ3J1bm5pbmcnKVxyXG4gIH0pXHJcblxyXG4gIGl0KCflupTor6Xog73liJvlu7rkuJbnlYzmnoTlu7rlt6XkvZzmtYEnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCB3b3JsZElkID0gJ3Rlc3Qtd29ybGQtd29ya2Zsb3cnXHJcbiAgICBjb25zdCB3b3JsZENvbmNlcHQgPSAn5LiA5Liq6a2U5rOV5LiO56eR5oqA5bm25a2Y55qE5aWH5bm75LiW55WMJ1xyXG5cclxuICAgIGNvbnN0IHdvcmtmbG93SWQgPSBhd2FpdCBzZXJ2aWNlLmNyZWF0ZVdvcmxkQnVpbGRpbmdXb3JrZmxvdyh3b3JsZElkLCB3b3JsZENvbmNlcHQsIHtcclxuICAgICAgc2NvcGU6ICdsYXJnZScsXHJcbiAgICAgIGdlbnJlOiAnZmFudGFzeScsXHJcbiAgICAgIHRlY2hub2xvZ3lMZXZlbDogJ21hZ2l0ZWNoJyxcclxuICAgICAgbWFnaWNMZXZlbDogJ2hpZ2gnXHJcbiAgICB9KVxyXG5cclxuICAgIGV4cGVjdCh0eXBlb2Ygd29ya2Zsb3dJZCkudG9CZSgnc3RyaW5nJylcclxuXHJcbiAgICBjb25zdCBzdGF0dXMgPSBzZXJ2aWNlLmdldFdvcmtmbG93U3RhdHVzKHdvcmtmbG93SWQpXHJcbiAgICBleHBlY3Qoc3RhdHVzKS5ub3QudG9CZU51bGwoKVxyXG4gICAgZXhwZWN0KHN0YXR1cz8ubmFtZSkudG9Db250YWluKCfkuJbnlYzmnoTlu7onKVxyXG4gICAgZXhwZWN0KHN0YXR1cz8uc3RhdHVzKS50b0JlKCdydW5uaW5nJylcclxuICB9KVxyXG5cclxuICBpdCgn5bqU6K+l6IO95Yib5bu65aSa5qih5oCB5Y+Z5LqL5bel5L2c5rWBJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgbmFycmF0aXZlSWQgPSAndGVzdC1tdWx0aW1vZGFsLXdvcmtmbG93J1xyXG4gICAgY29uc3Qgc2NyaXB0ID0gJ+S7juWJjeacieS4gOS4quWLh+aVoueahOWwj+Wtqe+8jOS7luWGs+WumuaOoue0ouacquefpeeahOS4lueVjC4uLidcclxuXHJcbiAgICBjb25zdCB3b3JrZmxvd0lkID0gYXdhaXQgc2VydmljZS5jcmVhdGVNdWx0aW1vZGFsTmFycmF0aXZlV29ya2Zsb3cobmFycmF0aXZlSWQsIHNjcmlwdCwgW1xyXG4gICAgICAndGV4dCcsICdpbWFnZScsICdhdWRpbydcclxuICAgIF0pXHJcblxyXG4gICAgZXhwZWN0KHR5cGVvZiB3b3JrZmxvd0lkKS50b0JlKCdzdHJpbmcnKVxyXG5cclxuICAgIGNvbnN0IHN0YXR1cyA9IHNlcnZpY2UuZ2V0V29ya2Zsb3dTdGF0dXMod29ya2Zsb3dJZClcclxuICAgIGV4cGVjdChzdGF0dXMpLm5vdC50b0JlTnVsbCgpXHJcbiAgICBleHBlY3Qoc3RhdHVzPy5uYW1lKS50b0NvbnRhaW4oJ+WkmuaooeaAgeWPmeS6iycpXHJcbiAgICBleHBlY3Qoc3RhdHVzPy5zdGF0dXMpLnRvQmUoJ3J1bm5pbmcnKVxyXG4gIH0pXHJcblxyXG4gIGl0KCflupTor6Xog73nrqHnkIblt6XkvZzmtYHnlJ/lkb3lkajmnJ8nLCBhc3luYyAoKSA9PiB7XHJcbiAgICAvLyDliJvlu7rkuIDkuKrnroDljZXnmoTlt6XkvZzmtYHnlKjkuo7mtYvor5VcclxuICAgIGNvbnN0IHN0b3J5SWQgPSAnbGlmZWN5Y2xlLXRlc3QnXHJcbiAgICBjb25zdCB3b3JrZmxvd0lkID0gYXdhaXQgc2VydmljZS5jcmVhdGVTdG9yeUNyZWF0aW9uV29ya2Zsb3coc3RvcnlJZCwgJ+a1i+ivleeUn+WRveWRqOacnycpXHJcblxyXG4gICAgLy8g6aqM6K+B5Yid5aeL54q25oCBXHJcbiAgICBsZXQgc3RhdHVzID0gc2VydmljZS5nZXRXb3JrZmxvd1N0YXR1cyh3b3JrZmxvd0lkKVxyXG4gICAgZXhwZWN0KHN0YXR1cz8uc3RhdHVzKS50b0JlKCdydW5uaW5nJylcclxuXHJcbiAgICAvLyDmmoLlgZzlt6XkvZzmtYFcclxuICAgIGF3YWl0IHNlcnZpY2UucGF1c2VXb3JrZmxvdyh3b3JrZmxvd0lkKVxyXG4gICAgc3RhdHVzID0gc2VydmljZS5nZXRXb3JrZmxvd1N0YXR1cyh3b3JrZmxvd0lkKVxyXG4gICAgZXhwZWN0KHN0YXR1cz8uc3RhdHVzKS50b0JlKCdwYXVzZWQnKVxyXG5cclxuICAgIC8vIOaBouWkjeW3peS9nOa1gVxyXG4gICAgYXdhaXQgc2VydmljZS5yZXN1bWVXb3JrZmxvdyh3b3JrZmxvd0lkKVxyXG4gICAgc3RhdHVzID0gc2VydmljZS5nZXRXb3JrZmxvd1N0YXR1cyh3b3JrZmxvd0lkKVxyXG4gICAgZXhwZWN0KHN0YXR1cz8uc3RhdHVzKS50b0JlKCdydW5uaW5nJylcclxuXHJcbiAgICAvLyDlj5bmtojlt6XkvZzmtYFcclxuICAgIGF3YWl0IHNlcnZpY2UuY2FuY2VsV29ya2Zsb3cod29ya2Zsb3dJZCwgJ+a1i+ivleWPlua2iCcpXHJcbiAgICBzdGF0dXMgPSBzZXJ2aWNlLmdldFdvcmtmbG93U3RhdHVzKHdvcmtmbG93SWQpXHJcbiAgICBleHBlY3Qoc3RhdHVzPy5zdGF0dXMpLnRvQmUoJ2NhbmNlbGxlZCcpXHJcbiAgfSlcclxuXHJcbiAgaXQoJ+W6lOivpeiDveWIm+W7uuadoeS7tuWIhuaUr+W3peS9nOa1gScsIGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IGNvbmRpdGlvbnMgPSBbXHJcbiAgICAgIHtcclxuICAgICAgICBjb25kaXRpb246ICdpbnB1dERhdGEuZ2VucmUgPT09IFwiZmFudGFzeVwiJyxcclxuICAgICAgICB3b3JrZmxvd1RlbXBsYXRlOiAnc3RvcnktY3JlYXRpb24nLFxyXG4gICAgICAgIHBhcmFtZXRlcnM6IHsgZ2VucmU6ICdmYW50YXN5JyB9XHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBjb25kaXRpb246ICdpbnB1dERhdGEuZ2VucmUgPT09IFwic2NpLWZpXCInLFxyXG4gICAgICAgIHdvcmtmbG93VGVtcGxhdGU6ICdzdG9yeS1jcmVhdGlvbicsXHJcbiAgICAgICAgcGFyYW1ldGVyczogeyBnZW5yZTogJ3NjaS1maScgfVxyXG4gICAgICB9XHJcbiAgICBdXHJcblxyXG4gICAgY29uc3Qgd29ya2Zsb3dJZCA9IGF3YWl0IHNlcnZpY2UuY3JlYXRlQ29uZGl0aW9uYWxXb3JrZmxvdygn5p2h5Lu25pWF5LqL5Yib5L2cJywgY29uZGl0aW9ucylcclxuXHJcbiAgICBleHBlY3QodHlwZW9mIHdvcmtmbG93SWQpLnRvQmUoJ3N0cmluZycpXHJcblxyXG4gICAgY29uc3Qgc3RhdHVzID0gc2VydmljZS5nZXRXb3JrZmxvd1N0YXR1cyh3b3JrZmxvd0lkKVxyXG4gICAgZXhwZWN0KHN0YXR1cykubm90LnRvQmVOdWxsKClcclxuICAgIGV4cGVjdChzdGF0dXM/Lm5hbWUpLnRvQ29udGFpbign5p2h5Lu25bel5L2c5rWBJylcclxuICB9KVxyXG5cclxuICBpdCgn5bqU6K+l6IO96I635Y+W5rS76LeD5bel5L2c5rWB5YiX6KGoJywgKCkgPT4ge1xyXG4gICAgY29uc3QgYWN0aXZlV29ya2Zsb3dzID0gc2VydmljZS5nZXRBY3RpdmVXb3JrZmxvd3MoKVxyXG4gICAgZXhwZWN0KEFycmF5LmlzQXJyYXkoYWN0aXZlV29ya2Zsb3dzKSkudG9CZSh0cnVlKVxyXG4gICAgLy8g5b2T5YmN5a6e546w5Y+v6IO96L+U5Zue56m65pWw57uE77yM5Y+W5Yaz5LqO5a6e6ZmF6L+Q6KGM55qE5bel5L2c5rWBXHJcbiAgfSlcclxuXHJcbiAgaXQoJ+W6lOivpeiDvea4heeQhuW3suWujOaIkOeahOW3peS9nOa1gScsIGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IGNsZWFuZWQgPSBhd2FpdCBzZXJ2aWNlLmNsZWFudXBDb21wbGV0ZWRXb3JrZmxvd3MoMCkgLy8g5riF55CG5omA5pyJ5bey5a6M5oiQ55qEXHJcbiAgICBleHBlY3QodHlwZW9mIGNsZWFuZWQpLnRvQmUoJ251bWJlcicpXHJcbiAgICBleHBlY3QoY2xlYW5lZCkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgwKVxyXG4gIH0pXHJcblxyXG4gIGl0KCflupTor6Xog73liJvlu7rln7rkuo7mqKHmnb/nmoTlt6XkvZzmtYHlrp7kvosnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCB0ZW1wbGF0ZXMgPSBzZXJ2aWNlLmdldEF2YWlsYWJsZVRlbXBsYXRlcygpXHJcbiAgICBjb25zdCBzdG9yeVRlbXBsYXRlID0gdGVtcGxhdGVzLmZpbmQodCA9PiB0Lm5hbWUgPT09ICfmlYXkuovliJvkvZzlt6XkvZzmtYEnKVxyXG5cclxuICAgIGV4cGVjdChzdG9yeVRlbXBsYXRlKS50b0JlRGVmaW5lZCgpXHJcblxyXG4gICAgY29uc3Qgd29ya2Zsb3dJZCA9IGF3YWl0IHNlcnZpY2UuY3JlYXRlV29ya2Zsb3dGcm9tVGVtcGxhdGUoJ3N0b3J5LWNyZWF0aW9uJywgJ+WfuuS6juaooeadv+eahOaVheS6iycsIHtcclxuICAgICAgcHJpb3JpdHk6ICdoaWdoJyxcclxuICAgICAgaW5wdXREYXRhOiB7IGN1c3RvbVByb21wdDogJ+a1i+ivleaooeadv+WunuS+i+WMlicgfVxyXG4gICAgfSlcclxuXHJcbiAgICBleHBlY3QodHlwZW9mIHdvcmtmbG93SWQpLnRvQmUoJ3N0cmluZycpXHJcblxyXG4gICAgY29uc3Qgc3RhdHVzID0gc2VydmljZS5nZXRXb3JrZmxvd1N0YXR1cyh3b3JrZmxvd0lkKVxyXG4gICAgZXhwZWN0KHN0YXR1cykubm90LnRvQmVOdWxsKClcclxuICAgIGV4cGVjdChzdGF0dXM/Lm5hbWUpLnRvQmUoJ+WfuuS6juaooeadv+eahOaVheS6iycpXHJcbiAgfSlcclxuXHJcbiAgaXQoJ+W6lOivpeiDveWIm+W7uuiHquWumuS5ieW3peS9nOa1gScsIGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IGN1c3RvbVRlbXBsYXRlID0ge1xyXG4gICAgICBuYW1lOiAn6Ieq5a6a5LmJ5rWL6K+V5bel5L2c5rWBJyxcclxuICAgICAgZGVzY3JpcHRpb246ICfnlKjkuo7mtYvor5XnmoTnroDljZXlt6XkvZzmtYEnLFxyXG4gICAgICB2ZXJzaW9uOiAnMS4wLjAnLFxyXG4gICAgICBub2RlczogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIGlkOiAnc3RhcnQtbm9kZScsXHJcbiAgICAgICAgICB0eXBlOiAndGFzaycgYXMgY29uc3QsXHJcbiAgICAgICAgICBuYW1lOiAn5byA5aeL5Lu75YqhJyxcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAn5bel5L2c5rWB55qE6LW35aeL5Lu75YqhJyxcclxuICAgICAgICAgIGNvbmZpZzogeyB0YXNrVHlwZTogJ3Rlc3QnIH0sXHJcbiAgICAgICAgICBpbnB1dHM6IFtdLFxyXG4gICAgICAgICAgb3V0cHV0czogW3sgaWQ6ICdzdGFydC1vdXQnLCBzb3VyY2VOb2RlSWQ6ICdzdGFydC1ub2RlJywgdGFyZ2V0Tm9kZUlkOiAnZW5kLW5vZGUnIH1dLFxyXG4gICAgICAgICAgc3RhdHVzOiAncGVuZGluZycgYXMgY29uc3QsXHJcbiAgICAgICAgICByZXRyeUNvdW50OiAwLFxyXG4gICAgICAgICAgbWF4UmV0cmllczogMSxcclxuICAgICAgICAgIHRpbWVvdXQ6IDMwMDAwXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBpZDogJ2VuZC1ub2RlJyxcclxuICAgICAgICAgIHR5cGU6ICd0YXNrJyBhcyBjb25zdCxcclxuICAgICAgICAgIG5hbWU6ICfnu5PmnZ/ku7vliqEnLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246ICflt6XkvZzmtYHnmoTnu5PmnZ/ku7vliqEnLFxyXG4gICAgICAgICAgY29uZmlnOiB7IHRhc2tUeXBlOiAndGVzdCcgfSxcclxuICAgICAgICAgIGlucHV0czogW3sgaWQ6ICdlbmQtaW4nLCBzb3VyY2VOb2RlSWQ6ICdzdGFydC1ub2RlJywgdGFyZ2V0Tm9kZUlkOiAnZW5kLW5vZGUnIH1dLFxyXG4gICAgICAgICAgb3V0cHV0czogW10sXHJcbiAgICAgICAgICBzdGF0dXM6ICdwZW5kaW5nJyBhcyBjb25zdCxcclxuICAgICAgICAgIHJldHJ5Q291bnQ6IDAsXHJcbiAgICAgICAgICBtYXhSZXRyaWVzOiAxLFxyXG4gICAgICAgICAgdGltZW91dDogMzAwMDAsXHJcbiAgICAgICAgICBkZXBlbmRlbmNpZXM6IFsnc3RhcnQtbm9kZSddXHJcbiAgICAgICAgfVxyXG4gICAgICBdLFxyXG4gICAgICBjb25uZWN0aW9uczogW10sXHJcbiAgICAgIGRlZmF1bHRDb25maWc6IHtcclxuICAgICAgICBtYXhSZXRyaWVzOiAxLFxyXG4gICAgICAgIHRpbWVvdXQ6IDYwMDAwLFxyXG4gICAgICAgIHByaW9yaXR5OiAnbm9ybWFsJyBhcyBjb25zdFxyXG4gICAgICB9LFxyXG4gICAgICB0YWdzOiBbJ3Rlc3QnLCAnY3VzdG9tJ11cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB3b3JrZmxvd0lkID0gYXdhaXQgc2VydmljZS5jcmVhdGVDdXN0b21Xb3JrZmxvdyhjdXN0b21UZW1wbGF0ZSwgJ+iHquWumuS5ieW3peS9nOa1gea1i+ivlScpXHJcblxyXG4gICAgZXhwZWN0KHR5cGVvZiB3b3JrZmxvd0lkKS50b0JlKCdzdHJpbmcnKVxyXG5cclxuICAgIGNvbnN0IHN0YXR1cyA9IHNlcnZpY2UuZ2V0V29ya2Zsb3dTdGF0dXMod29ya2Zsb3dJZClcclxuICAgIGV4cGVjdChzdGF0dXMpLm5vdC50b0JlTnVsbCgpXHJcbiAgICBleHBlY3Qoc3RhdHVzPy5uYW1lKS50b0JlKCfoh6rlrprkuYnlt6XkvZzmtYHmtYvor5UnKVxyXG4gIH0pXHJcblxyXG4gIGl0KCflupTor6XmraPnoa7phY3nva7lt6XkvZzmtYHlj4LmlbAnLCAoKSA9PiB7XHJcbiAgICBleHBlY3QoY29uZmlnU2VydmljZS5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdXT1JLRkxPV19NQVhfQ09OQ1VSUkVOVCcsIDEwKVxyXG4gICAgZXhwZWN0KGNvbmZpZ1NlcnZpY2UuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnV09SS0ZMT1dfREVGQVVMVF9USU1FT1VUJywgMzAwMDAwKVxyXG4gIH0pXHJcbn0pXHJcbiJdLCJ2ZXJzaW9uIjozfQ==