{"file":"C:\\Users\\16663\\Desktop\\tuheg\\packages\\common-backend\\src\\config\\performance-config.ts","mappings":"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","names":[],"sources":["C:\\Users\\16663\\Desktop\\tuheg\\packages\\common-backend\\src\\config\\performance-config.ts"],"sourcesContent":["// 文件路径: packages/common-backend/src/config/performance-config.ts\n// 职责: 性能监控基线配置和SLA指标定义\n\n/**\n * @interface SLATargets\n * @description SLA目标定义\n */\nexport interface SLATargets {\n  /** 响应时间目标 (毫秒) */\n  responseTime: {\n    /** P50响应时间 */\n    p50: number\n    /** P95响应时间 */\n    p95: number\n    /** P99响应时间 */\n    p99: number\n  }\n  /** 可用性目标 (百分比) */\n  availability: number\n  /** 错误率目标 (百分比) */\n  errorRate: number\n  /** 吞吐量目标 (RPS) */\n  throughput: number\n}\n\n/**\n * @interface PerformanceThresholds\n * @description 性能阈值配置\n */\nexport interface PerformanceThresholds {\n  /** 警告阈值 */\n  warning: number\n  /** 严重阈值 */\n  critical: number\n  /** 紧急阈值 */\n  emergency: number\n}\n\n/**\n * @interface ServiceSLAs\n * @description 各服务的SLA配置\n */\nexport interface ServiceSLAs {\n  /** API网关 */\n  api: SLATargets\n  /** AI推理服务 */\n  ai: SLATargets\n  /** 数据库查询 */\n  database: SLATargets\n  /** 缓存操作 */\n  cache: SLATargets\n  /** 消息队列 */\n  queue: SLATargets\n  /** WebSocket连接 */\n  websocket: SLATargets\n}\n\n/**\n * @constant PERFORMANCE_CONFIG\n * @description 性能监控配置\n */\nexport const PERFORMANCE_CONFIG = {\n  // SLA目标\n  slas: {\n    api: {\n      responseTime: { p50: 200, p95: 500, p99: 1000 },\n      availability: 99.9,\n      errorRate: 0.1,\n      throughput: 1000,\n    },\n    ai: {\n      responseTime: { p50: 2000, p95: 3000, p99: 5000 },\n      availability: 99.5,\n      errorRate: 1.0,\n      throughput: 100,\n    },\n    database: {\n      responseTime: { p50: 50, p95: 200, p99: 500 },\n      availability: 99.9,\n      errorRate: 0.01,\n      throughput: 5000,\n    },\n    cache: {\n      responseTime: { p50: 5, p95: 20, p99: 50 },\n      availability: 99.99,\n      errorRate: 0.001,\n      throughput: 10000,\n    },\n    queue: {\n      responseTime: { p50: 100, p95: 500, p99: 2000 },\n      availability: 99.9,\n      errorRate: 0.1,\n      throughput: 2000,\n    },\n    websocket: {\n      responseTime: { p50: 50, p95: 100, p99: 200 },\n      availability: 99.9,\n      errorRate: 0.1,\n      throughput: 5000,\n    },\n  } as ServiceSLAs,\n\n  // 性能阈值\n  thresholds: {\n    responseTime: {\n      warning: 1000, // 1秒\n      critical: 3000, // 3秒\n      emergency: 10000, // 10秒\n    },\n    errorRate: {\n      warning: 1.0, // 1%\n      critical: 5.0, // 5%\n      emergency: 10.0, // 10%\n    },\n    cpuUsage: {\n      warning: 70, // 70%\n      critical: 85, // 85%\n      emergency: 95, // 95%\n    },\n    memoryUsage: {\n      warning: 80, // 80%\n      critical: 90, // 90%\n      emergency: 95, // 95%\n    },\n    connectionCount: {\n      warning: 1000, // 1000连接\n      critical: 2000, // 2000连接\n      emergency: 5000, // 5000连接\n    },\n  } as Record<string, PerformanceThresholds>,\n\n  // 监控配置\n  monitoring: {\n    /** 采样率 */\n    sampleRate: 0.1, // 10%采样\n\n    /** 指标收集间隔 (毫秒) */\n    collectionInterval: 60000, // 1分钟\n\n    /** 告警检查间隔 (毫秒) */\n    alertCheckInterval: 300000, // 5分钟\n\n    /** 性能报告生成间隔 (毫秒) */\n    reportInterval: 3600000, // 1小时\n\n    /** 历史数据保留天数 */\n    retentionDays: 30,\n  },\n\n  // 容量规划\n  capacity: {\n    /** 最大并发用户数 */\n    maxConcurrentUsers: 10000,\n\n    /** 数据库连接池大小 */\n    dbConnectionPool: 50,\n\n    /** Redis连接池大小 */\n    redisConnectionPool: 100,\n\n    /** WebSocket最大连接数 */\n    maxWebSocketConnections: 50000,\n\n    /** 队列并发处理数 */\n    queueConcurrency: 20,\n  },\n}\n\n/**\n * @function getSLATarget\n * @description 获取指定服务的SLA目标\n */\nexport function getSLATarget(service: keyof ServiceSLAs): SLATargets {\n  return PERFORMANCE_CONFIG.slas[service]\n}\n\n/**\n * @function getPerformanceThreshold\n * @description 获取指定指标的性能阈值\n */\nexport function getPerformanceThreshold(\n  metric: string,\n  level: keyof PerformanceThresholds\n): number {\n  return PERFORMANCE_CONFIG.thresholds[metric]?.[level] || 0\n}\n\n/**\n * @function isPerformanceHealthy\n * @description 检查性能指标是否健康\n */\nexport function isPerformanceHealthy(\n  service: keyof ServiceSLAs,\n  metric: 'responseTime' | 'errorRate' | 'availability',\n  value: number\n): { healthy: boolean; level: 'healthy' | 'warning' | 'critical' | 'emergency' } {\n  const sla = getSLATarget(service)\n\n  switch (metric) {\n    case 'responseTime':\n      if (value <= sla.responseTime.p95) return { healthy: true, level: 'healthy' }\n      if (value <= getPerformanceThreshold('responseTime', 'warning'))\n        return { healthy: false, level: 'warning' }\n      if (value <= getPerformanceThreshold('responseTime', 'critical'))\n        return { healthy: false, level: 'critical' }\n      return { healthy: false, level: 'emergency' }\n\n    case 'errorRate':\n      if (value <= sla.errorRate) return { healthy: true, level: 'healthy' }\n      if (value <= getPerformanceThreshold('errorRate', 'warning'))\n        return { healthy: false, level: 'warning' }\n      if (value <= getPerformanceThreshold('errorRate', 'critical'))\n        return { healthy: false, level: 'critical' }\n      return { healthy: false, level: 'emergency' }\n\n    case 'availability':\n      if (value >= sla.availability) return { healthy: true, level: 'healthy' }\n      if (value >= sla.availability - 0.1) return { healthy: false, level: 'warning' }\n      if (value >= sla.availability - 0.5) return { healthy: false, level: 'critical' }\n      return { healthy: false, level: 'emergency' }\n\n    default:\n      return { healthy: true, level: 'healthy' }\n  }\n}\n"],"version":3}