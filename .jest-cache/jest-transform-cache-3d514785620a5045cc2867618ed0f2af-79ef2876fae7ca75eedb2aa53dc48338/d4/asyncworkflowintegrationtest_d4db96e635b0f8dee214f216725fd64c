0618ae334125790c515c7bef1864d195
"use strict";
// ============================================================================
// 异步工作流引擎集成测试
// 验证 VCPToolBox 工作流编排能力的正确集成
// ============================================================================
Object.defineProperty(exports, "__esModule", { value: true });
const config_1 = require("@nestjs/config");
const testing_1 = require("@nestjs/testing");
const ai_domain_1 = require("@tuheg/ai-domain");
describe('AsyncWorkflowService Integration', () => {
    let service;
    let configService;
    beforeEach(async () => {
        const module = await testing_1.Test.createTestingModule({
            providers: [
                ai_domain_1.AsyncWorkflowService,
                {
                    provide: config_1.ConfigService,
                    useValue: {
                        get: jest.fn((key, defaultValue) => {
                            const config = {
                                WORKFLOW_MAX_CONCURRENT: 10,
                                WORKFLOW_DEFAULT_TIMEOUT: 300000,
                                WORKFLOW_CLEANUP_INTERVAL: 24,
                                WORKFLOW_STATS_INTERVAL: 5,
                            };
                            return config[key] || defaultValue;
                        }),
                    },
                },
            ],
        }).compile();
        service = module.get(ai_domain_1.AsyncWorkflowService);
        configService = module.get(config_1.ConfigService);
    });
    it('应该能获取工作流统计信息', () => {
        const stats = service.getWorkflowStats();
        expect(stats).toHaveProperty('templates');
        expect(stats).toHaveProperty('instances');
        expect(stats).toHaveProperty('runningInstances');
        expect(stats).toHaveProperty('queuedInstances');
        expect(stats).toHaveProperty('nodeExecutors');
        expect(typeof stats.templates).toBe('number');
    });
    it('应该能执行健康检查', async () => {
        const health = await service.healthCheck();
        expect(health).toHaveProperty('status');
        expect(['healthy', 'warning', 'error']).toContain(health.status);
        if (health.status !== 'error') {
            expect(health).toHaveProperty('details');
            expect(health.details).toHaveProperty('stats');
            expect(health.details).toHaveProperty('activeWorkflows');
        }
    });
    it('应该能获取工作流性能指标', () => {
        const metrics = service.getWorkflowMetrics();
        expect(metrics).toHaveProperty('templates');
        expect(metrics).toHaveProperty('activeWorkflows');
        expect(metrics).toHaveProperty('averageCompletionTime');
        expect(metrics).toHaveProperty('successRate');
        expect(metrics).toHaveProperty('resourceUtilization');
    });
    it('应该能获取可用模板列表', () => {
        const templates = service.getAvailableTemplates();
        expect(Array.isArray(templates)).toBe(true);
        expect(templates.length).toBeGreaterThan(0);
        // 检查是否包含预期的模板
        const templateNames = templates.map((t) => t.name);
        expect(templateNames).toContain('故事创作工作流');
        expect(templateNames).toContain('角色开发工作流');
        expect(templateNames).toContain('世界构建工作流');
        expect(templateNames).toContain('多模态叙事工作流');
        templates.forEach((template) => {
            expect(template).toHaveProperty('id');
            expect(template).toHaveProperty('name');
            expect(template).toHaveProperty('description');
            expect(template).toHaveProperty('tags');
            expect(Array.isArray(template.tags)).toBe(true);
        });
    });
    it('应该能获取模板详情', () => {
        const templates = service.getAvailableTemplates();
        const firstTemplate = templates[0];
        const details = service.getTemplateDetails(firstTemplate.id);
        expect(details).not.toBeNull();
        expect(details?.id).toBe(firstTemplate.id);
        expect(details?.name).toBe(firstTemplate.name);
        expect(details).toHaveProperty('nodes');
        expect(details).toHaveProperty('connections');
        expect(details).toHaveProperty('defaultConfig');
        expect(Array.isArray(details?.nodes)).toBe(true);
    });
    it('应该能创建故事创作工作流', async () => {
        const storyId = 'test-story-workflow';
        const userPrompt = '写一个关于太空探索的故事';
        const workflowId = await service.createStoryCreationWorkflow(storyId, userPrompt, {
            genre: 'sci-fi',
            length: 'medium',
            characters: 3,
        });
        expect(typeof workflowId).toBe('string');
        expect(workflowId.length).toBeGreaterThan(0);
        // 验证工作流状态
        const status = service.getWorkflowStatus(workflowId);
        expect(status).not.toBeNull();
        expect(status?.name).toContain('故事创作');
        expect(status?.status).toBe('running'); // 应该自动启动
    });
    it('应该能创建角色开发工作流', async () => {
        const characterId = 'test-character-workflow';
        const characterConcept = '一个勇敢的年轻探险家';
        const workflowId = await service.createCharacterDevelopmentWorkflow(characterId, characterConcept, {
            archetype: 'hero',
            complexity: 'detailed',
        });
        expect(typeof workflowId).toBe('string');
        const status = service.getWorkflowStatus(workflowId);
        expect(status).not.toBeNull();
        expect(status?.name).toContain('角色开发');
        expect(status?.status).toBe('running');
    });
    it('应该能创建世界构建工作流', async () => {
        const worldId = 'test-world-workflow';
        const worldConcept = '一个魔法与科技并存的奇幻世界';
        const workflowId = await service.createWorldBuildingWorkflow(worldId, worldConcept, {
            scope: 'large',
            genre: 'fantasy',
            technologyLevel: 'magitech',
            magicLevel: 'high',
        });
        expect(typeof workflowId).toBe('string');
        const status = service.getWorkflowStatus(workflowId);
        expect(status).not.toBeNull();
        expect(status?.name).toContain('世界构建');
        expect(status?.status).toBe('running');
    });
    it('应该能创建多模态叙事工作流', async () => {
        const narrativeId = 'test-multimodal-workflow';
        const script = '从前有一个勇敢的小孩，他决定探索未知的世界...';
        const workflowId = await service.createMultimodalNarrativeWorkflow(narrativeId, script, [
            'text',
            'image',
            'audio',
        ]);
        expect(typeof workflowId).toBe('string');
        const status = service.getWorkflowStatus(workflowId);
        expect(status).not.toBeNull();
        expect(status?.name).toContain('多模态叙事');
        expect(status?.status).toBe('running');
    });
    it('应该能管理工作流生命周期', async () => {
        // 创建一个简单的工作流用于测试
        const storyId = 'lifecycle-test';
        const workflowId = await service.createStoryCreationWorkflow(storyId, '测试生命周期');
        // 验证初始状态
        let status = service.getWorkflowStatus(workflowId);
        expect(status?.status).toBe('running');
        // 暂停工作流
        await service.pauseWorkflow(workflowId);
        status = service.getWorkflowStatus(workflowId);
        expect(status?.status).toBe('paused');
        // 恢复工作流
        await service.resumeWorkflow(workflowId);
        status = service.getWorkflowStatus(workflowId);
        expect(status?.status).toBe('running');
        // 取消工作流
        await service.cancelWorkflow(workflowId, '测试取消');
        status = service.getWorkflowStatus(workflowId);
        expect(status?.status).toBe('cancelled');
    });
    it('应该能创建条件分支工作流', async () => {
        const conditions = [
            {
                condition: 'inputData.genre === "fantasy"',
                workflowTemplate: 'story-creation',
                parameters: { genre: 'fantasy' },
            },
            {
                condition: 'inputData.genre === "sci-fi"',
                workflowTemplate: 'story-creation',
                parameters: { genre: 'sci-fi' },
            },
        ];
        const workflowId = await service.createConditionalWorkflow('条件故事创作', conditions);
        expect(typeof workflowId).toBe('string');
        const status = service.getWorkflowStatus(workflowId);
        expect(status).not.toBeNull();
        expect(status?.name).toContain('条件工作流');
    });
    it('应该能获取活跃工作流列表', () => {
        const activeWorkflows = service.getActiveWorkflows();
        expect(Array.isArray(activeWorkflows)).toBe(true);
        // 当前实现可能返回空数组，取决于实际运行的工作流
    });
    it('应该能清理已完成的工作流', async () => {
        const cleaned = await service.cleanupCompletedWorkflows(0); // 清理所有已完成的
        expect(typeof cleaned).toBe('number');
        expect(cleaned).toBeGreaterThanOrEqual(0);
    });
    it('应该能创建基于模板的工作流实例', async () => {
        const templates = service.getAvailableTemplates();
        const storyTemplate = templates.find((t) => t.name === '故事创作工作流');
        expect(storyTemplate).toBeDefined();
        const workflowId = await service.createWorkflowFromTemplate('story-creation', '基于模板的故事', {
            priority: 'high',
            inputData: { customPrompt: '测试模板实例化' },
        });
        expect(typeof workflowId).toBe('string');
        const status = service.getWorkflowStatus(workflowId);
        expect(status).not.toBeNull();
        expect(status?.name).toBe('基于模板的故事');
    });
    it('应该能创建自定义工作流', async () => {
        const customTemplate = {
            name: '自定义测试工作流',
            description: '用于测试的简单工作流',
            version: '1.0.0',
            nodes: [
                {
                    id: 'start-node',
                    type: 'task',
                    name: '开始任务',
                    description: '工作流的起始任务',
                    config: { taskType: 'test' },
                    inputs: [],
                    outputs: [{ id: 'start-out', sourceNodeId: 'start-node', targetNodeId: 'end-node' }],
                    status: 'pending',
                    retryCount: 0,
                    maxRetries: 1,
                    timeout: 30000,
                },
                {
                    id: 'end-node',
                    type: 'task',
                    name: '结束任务',
                    description: '工作流的结束任务',
                    config: { taskType: 'test' },
                    inputs: [{ id: 'end-in', sourceNodeId: 'start-node', targetNodeId: 'end-node' }],
                    outputs: [],
                    status: 'pending',
                    retryCount: 0,
                    maxRetries: 1,
                    timeout: 30000,
                    dependencies: ['start-node'],
                },
            ],
            connections: [],
            defaultConfig: {
                maxRetries: 1,
                timeout: 60000,
                priority: 'normal',
            },
            tags: ['test', 'custom'],
        };
        const workflowId = await service.createCustomWorkflow(customTemplate, '自定义工作流测试');
        expect(typeof workflowId).toBe('string');
        const status = service.getWorkflowStatus(workflowId);
        expect(status).not.toBeNull();
        expect(status?.name).toBe('自定义工作流测试');
    });
    it('应该正确配置工作流参数', () => {
        expect(configService.get).toHaveBeenCalledWith('WORKFLOW_MAX_CONCURRENT', 10);
        expect(configService.get).toHaveBeenCalledWith('WORKFLOW_DEFAULT_TIMEOUT', 300000);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFwxNjY2M1xcRGVza3RvcFxcdHVoZWdcXGFwcHNcXHZjcHRvb2xib3hcXHNyY1xcaW50ZWdyYXRpb24tdGVzdHNcXGFzeW5jLXdvcmtmbG93LWludGVncmF0aW9uLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBLCtFQUErRTtBQUMvRSxjQUFjO0FBQ2QsNkJBQTZCO0FBQzdCLCtFQUErRTs7QUFFL0UsMkNBQThDO0FBQzlDLDZDQUEwRDtBQUMxRCxnREFBdUQ7QUFFdkQsUUFBUSxDQUFDLGtDQUFrQyxFQUFFLEdBQUcsRUFBRTtJQUNoRCxJQUFJLE9BQTZCLENBQUE7SUFDakMsSUFBSSxhQUE0QixDQUFBO0lBRWhDLFVBQVUsQ0FBQyxLQUFLLElBQUksRUFBRTtRQUNwQixNQUFNLE1BQU0sR0FBa0IsTUFBTSxjQUFJLENBQUMsbUJBQW1CLENBQUM7WUFDM0QsU0FBUyxFQUFFO2dCQUNULGdDQUFvQjtnQkFDcEI7b0JBQ0UsT0FBTyxFQUFFLHNCQUFhO29CQUN0QixRQUFRLEVBQUU7d0JBQ1IsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFXLEVBQUUsWUFBa0IsRUFBRSxFQUFFOzRCQUMvQyxNQUFNLE1BQU0sR0FBRztnQ0FDYix1QkFBdUIsRUFBRSxFQUFFO2dDQUMzQix3QkFBd0IsRUFBRSxNQUFNO2dDQUNoQyx5QkFBeUIsRUFBRSxFQUFFO2dDQUM3Qix1QkFBdUIsRUFBRSxDQUFDOzZCQUMzQixDQUFBOzRCQUNELE9BQU8sTUFBTSxDQUFDLEdBQUcsQ0FBQyxJQUFJLFlBQVksQ0FBQTt3QkFDcEMsQ0FBQyxDQUFDO3FCQUNIO2lCQUNGO2FBQ0Y7U0FDRixDQUFDLENBQUMsT0FBTyxFQUFFLENBQUE7UUFFWixPQUFPLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBdUIsZ0NBQW9CLENBQUMsQ0FBQTtRQUNoRSxhQUFhLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBZ0Isc0JBQWEsQ0FBQyxDQUFBO0lBQzFELENBQUMsQ0FBQyxDQUFBO0lBRUYsRUFB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Q0FBQTtRQUVqRixNQUFNLENBQUMsT0FBTyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUE7UUFFeEMsTUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxDQUFBO1FBQ3BELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLENBQUE7UUFDN0IsTUFBTSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUE7SUFDdkMsQ0FBQyxDQUFDLENBQUE7SUFFRixFQUFFLENBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRTtRQUNyQixNQUFNLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLHlCQUF5QixFQUFFLEVBQUUsQ0FBQyxDQUFBO1FBQzdFLE1BQU0sQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUMsb0JBQW9CLENBQUMsMEJBQTBCLEVBQUUsTUFBTSxDQUFDLENBQUE7SUFDcEYsQ0FBQyxDQUFDLENBQUE7QUFDSixDQUFDLENBQUMsQ0FBQSIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXDE2NjYzXFxEZXNrdG9wXFx0dWhlZ1xcYXBwc1xcdmNwdG9vbGJveFxcc3JjXFxpbnRlZ3JhdGlvbi10ZXN0c1xcYXN5bmMtd29ya2Zsb3ctaW50ZWdyYXRpb24udGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDlvILmraXlt6XkvZzmtYHlvJXmk47pm4bmiJDmtYvor5Vcbi8vIOmqjOivgSBWQ1BUb29sQm94IOW3peS9nOa1gee8luaOkuiDveWKm+eahOato+ehrumbhuaIkFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgeyBDb25maWdTZXJ2aWNlIH0gZnJvbSAnQG5lc3Rqcy9jb25maWcnXG5pbXBvcnQgeyBUZXN0LCB0eXBlIFRlc3RpbmdNb2R1bGUgfSBmcm9tICdAbmVzdGpzL3Rlc3RpbmcnXG5pbXBvcnQgeyBBc3luY1dvcmtmbG93U2VydmljZSB9IGZyb20gJ0B0dWhlZy9haS1kb21haW4nXG5cbmRlc2NyaWJlKCdBc3luY1dvcmtmbG93U2VydmljZSBJbnRlZ3JhdGlvbicsICgpID0+IHtcbiAgbGV0IHNlcnZpY2U6IEFzeW5jV29ya2Zsb3dTZXJ2aWNlXG4gIGxldCBjb25maWdTZXJ2aWNlOiBDb25maWdTZXJ2aWNlXG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgbW9kdWxlOiBUZXN0aW5nTW9kdWxlID0gYXdhaXQgVGVzdC5jcmVhdGVUZXN0aW5nTW9kdWxlKHtcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICBBc3luY1dvcmtmbG93U2VydmljZSxcbiAgICAgICAge1xuICAgICAgICAgIHByb3ZpZGU6IENvbmZpZ1NlcnZpY2UsXG4gICAgICAgICAgdXNlVmFsdWU6IHtcbiAgICAgICAgICAgIGdldDogamVzdC5mbigoa2V5OiBzdHJpbmcsIGRlZmF1bHRWYWx1ZT86IGFueSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICAgICAgICAgICAgV09SS0ZMT1dfTUFYX0NPTkNVUlJFTlQ6IDEwLFxuICAgICAgICAgICAgICAgIFdPUktGTE9XX0RFRkFVTFRfVElNRU9VVDogMzAwMDAwLFxuICAgICAgICAgICAgICAgIFdPUktGTE9XX0NMRUFOVVBfSU5URVJWQUw6IDI0LFxuICAgICAgICAgICAgICAgIFdPUktGTE9XX1NUQVRTX0lOVEVSVkFMOiA1LFxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJldHVybiBjb25maWdba2V5XSB8fCBkZWZhdWx0VmFsdWVcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0pLmNvbXBpbGUoKVxuXG4gICAgc2VydmljZSA9IG1vZHVsZS5nZXQ8QXN5bmNXb3JrZmxvd1NlcnZpY2U+KEFzeW5jV29ya2Zsb3dTZXJ2aWNlKVxuICAgIGNvbmZpZ1NlcnZpY2UgPSBtb2R1bGUuZ2V0PENvbmZpZ1NlcnZpY2U+KENvbmZpZ1NlcnZpY2UpXG4gIH0pXG5cbiAgaXQoJ+W6lOivpeiDveiOt+WPluW3peS9nOa1gee7n+iuoeS/oeaBrycsICgpID0+IHtcbiAgICBjb25zdCBzdGF0cyA9IHNlcnZpY2UuZ2V0V29ya2Zsb3dTdGF0cygpXG5cbiAgICBleHBlY3Qoc3RhdHMpLnRvSGF2ZVByb3BlcnR5KCd0ZW1wbGF0ZXMnKVxuICAgIGV4cGVjdChzdGF0cykudG9IYXZlUHJvcGVydHkoJ2luc3RhbmNlcycpXG4gICAgZXhwZWN0KHN0YXRzKS50b0hhdmVQcm9wZXJ0eSgncnVubmluZ0luc3RhbmNlcycpXG4gICAgZXhwZWN0KHN0YXRzKS50b0hhdmVQcm9wZXJ0eSgncXVldWVkSW5zdGFuY2VzJylcbiAgICBleHBlY3Qoc3RhdHMpLnRvSGF2ZVByb3BlcnR5KCdub2RlRXhlY3V0b3JzJylcbiAgICBleHBlY3QodHlwZW9mIHN0YXRzLnRlbXBsYXRlcykudG9CZSgnbnVtYmVyJylcbiAgfSlcblxuICBpdCgn5bqU6K+l6IO95omn6KGM5YGl5bq35qOA5p+lJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGhlYWx0aCA9IGF3YWl0IHNlcnZpY2UuaGVhbHRoQ2hlY2soKVxuXG4gICAgZXhwZWN0KGhlYWx0aCkudG9IYXZlUHJvcGVydHkoJ3N0YXR1cycpXG4gICAgZXhwZWN0KFsnaGVhbHRoeScsICd3YXJuaW5nJywgJ2Vycm9yJ10pLnRvQ29udGFpbihoZWFsdGguc3RhdHVzKVxuXG4gICAgaWYgKGhlYWx0aC5zdGF0dXMgIT09ICdlcnJvcicpIHtcbiAgICAgIGV4cGVjdChoZWFsdGgpLnRvSGF2ZVByb3BlcnR5KCdkZXRhaWxzJylcbiAgICAgIGV4cGVjdChoZWFsdGguZGV0YWlscykudG9IYXZlUHJvcGVydHkoJ3N0YXRzJylcbiAgICAgIGV4cGVjdChoZWFsdGguZGV0YWlscykudG9IYXZlUHJvcGVydHkoJ2FjdGl2ZVdvcmtmbG93cycpXG4gICAgfVxuICB9KVxuXG4gIGl0KCflupTor6Xog73ojrflj5blt6XkvZzmtYHmgKfog73mjIfmoIcnLCAoKSA9PiB7XG4gICAgY29uc3QgbWV0cmljcyA9IHNlcnZpY2UuZ2V0V29ya2Zsb3dNZXRyaWNzKClcblxuICAgIGV4cGVjdChtZXRyaWNzKS50b0hhdmVQcm9wZXJ0eSgndGVtcGxhdGVzJylcbiAgICBleHBlY3QobWV0cmljcykudG9IYXZlUHJvcGVydHkoJ2FjdGl2ZVdvcmtmbG93cycpXG4gICAgZXhwZWN0KG1ldHJpY3MpLnRvSGF2ZVByb3BlcnR5KCdhdmVyYWdlQ29tcGxldGlvblRpbWUnKVxuICAgIGV4cGVjdChtZXRyaWNzKS50b0hhdmVQcm9wZXJ0eSgnc3VjY2Vzc1JhdGUnKVxuICAgIGV4cGVjdChtZXRyaWNzKS50b0hhdmVQcm9wZXJ0eSgncmVzb3VyY2VVdGlsaXphdGlvbicpXG4gIH0pXG5cbiAgaXQoJ+W6lOivpeiDveiOt+WPluWPr+eUqOaooeadv+WIl+ihqCcsICgpID0+IHtcbiAgICBjb25zdCB0ZW1wbGF0ZXMgPSBzZXJ2aWNlLmdldEF2YWlsYWJsZVRlbXBsYXRlcygpXG5cbiAgICBleHBlY3QoQXJyYXkuaXNBcnJheSh0ZW1wbGF0ZXMpKS50b0JlKHRydWUpXG4gICAgZXhwZWN0KHRlbXBsYXRlcy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKVxuXG4gICAgLy8g5qOA5p+l5piv5ZCm5YyF5ZCr6aKE5pyf55qE5qih5p2/XG4gICAgY29uc3QgdGVtcGxhdGVOYW1lcyA9IHRlbXBsYXRlcy5tYXAoKHQpID0+IHQubmFtZSlcbiAgICBleHBlY3QodGVtcGxhdGVOYW1lcykudG9Db250YWluKCfmlYXkuovliJvkvZzlt6XkvZzmtYEnKVxuICAgIGV4cGVjdCh0ZW1wbGF0ZU5hbWVzKS50b0NvbnRhaW4oJ+inkuiJsuW8gOWPkeW3peS9nOa1gScpXG4gICAgZXhwZWN0KHRlbXBsYXRlTmFtZXMpLnRvQ29udGFpbign5LiW55WM5p6E5bu65bel5L2c5rWBJylcbiAgICBleHBlY3QodGVtcGxhdGVOYW1lcykudG9Db250YWluKCflpJrmqKHmgIHlj5nkuovlt6XkvZzmtYEnKVxuXG4gICAgdGVtcGxhdGVzLmZvckVhY2goKHRlbXBsYXRlKSA9PiB7XG4gICAgICBleHBlY3QodGVtcGxhdGUpLnRvSGF2ZVByb3BlcnR5KCdpZCcpXG4gICAgICBleHBlY3QodGVtcGxhdGUpLnRvSGF2ZVByb3BlcnR5KCduYW1lJylcbiAgICAgIGV4cGVjdCh0ZW1wbGF0ZSkudG9IYXZlUHJvcGVydHkoJ2Rlc2NyaXB0aW9uJylcbiAgICAgIGV4cGVjdCh0ZW1wbGF0ZSkudG9IYXZlUHJvcGVydHkoJ3RhZ3MnKVxuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkodGVtcGxhdGUudGFncykpLnRvQmUodHJ1ZSlcbiAgICB9KVxuICB9KVxuXG4gIGl0KCflupTor6Xog73ojrflj5bmqKHmnb/or6bmg4UnLCAoKSA9PiB7XG4gICAgY29uc3QgdGVtcGxhdGVzID0gc2VydmljZS5nZXRBdmFpbGFibGVUZW1wbGF0ZXMoKVxuICAgIGNvbnN0IGZpcnN0VGVtcGxhdGUgPSB0ZW1wbGF0ZXNbMF1cblxuICAgIGNvbnN0IGRldGFpbHMgPSBzZXJ2aWNlLmdldFRlbXBsYXRlRGV0YWlscyhmaXJzdFRlbXBsYXRlLmlkKVxuICAgIGV4cGVjdChkZXRhaWxzKS5ub3QudG9CZU51bGwoKVxuICAgIGV4cGVjdChkZXRhaWxzPy5pZCkudG9CZShmaXJzdFRlbXBsYXRlLmlkKVxuICAgIGV4cGVjdChkZXRhaWxzPy5uYW1lKS50b0JlKGZpcnN0VGVtcGxhdGUubmFtZSlcbiAgICBleHBlY3QoZGV0YWlscykudG9IYXZlUHJvcGVydHkoJ25vZGVzJylcbiAgICBleHBlY3QoZGV0YWlscykudG9IYXZlUHJvcGVydHkoJ2Nvbm5lY3Rpb25zJylcbiAgICBleHBlY3QoZGV0YWlscykudG9IYXZlUHJvcGVydHkoJ2RlZmF1bHRDb25maWcnKVxuICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGRldGFpbHM/Lm5vZGVzKSkudG9CZSh0cnVlKVxuICB9KVxuXG4gIGl0KCflupTor6Xog73liJvlu7rmlYXkuovliJvkvZzlt6XkvZzmtYEnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgc3RvcnlJZCA9ICd0ZXN0LXN0b3J5LXdvcmtmbG93J1xuICAgIGNvbnN0IHVzZXJQcm9tcHQgPSAn5YaZ5LiA5Liq5YWz5LqO5aSq56m65o6i57Si55qE5pWF5LqLJ1xuXG4gICAgY29uc3Qgd29ya2Zsb3dJZCA9IGF3YWl0IHNlcnZpY2UuY3JlYXRlU3RvcnlDcmVhdGlvbldvcmtmbG93KHN0b3J5SWQsIHVzZXJQcm9tcHQsIHtcbiAgICAgIGdlbnJlOiAnc2NpLWZpJyxcbiAgICAgIGxlbmd0aDogJ21lZGl1bScsXG4gICAgICBjaGFyYWN0ZXJzOiAzLFxuICAgIH0pXG5cbiAgICBleHBlY3QodHlwZW9mIHdvcmtmbG93SWQpLnRvQmUoJ3N0cmluZycpXG4gICAgZXhwZWN0KHdvcmtmbG93SWQubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMClcblxuICAgIC8vIOmqjOivgeW3peS9nOa1geeKtuaAgVxuICAgIGNvbnN0IHN0YXR1cyA9IHNlcnZpY2UuZ2V0V29ya2Zsb3dTdGF0dXMod29ya2Zsb3dJZClcbiAgICBleHBlY3Qoc3RhdHVzKS5ub3QudG9CZU51bGwoKVxuICAgIGV4cGVjdChzdGF0dXM/Lm5hbWUpLnRvQ29udGFpbign5pWF5LqL5Yib5L2cJylcbiAgICBleHBlY3Qoc3RhdHVzPy5zdGF0dXMpLnRvQmUoJ3J1bm5pbmcnKSAvLyDlupTor6Xoh6rliqjlkK/liqhcbiAgfSlcblxuICBpdCgn5bqU6K+l6IO95Yib5bu66KeS6Imy5byA5Y+R5bel5L2c5rWBJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGNoYXJhY3RlcklkID0gJ3Rlc3QtY2hhcmFjdGVyLXdvcmtmbG93J1xuICAgIGNvbnN0IGNoYXJhY3RlckNvbmNlcHQgPSAn5LiA5Liq5YuH5pWi55qE5bm06L275o6i6Zmp5a62J1xuXG4gICAgY29uc3Qgd29ya2Zsb3dJZCA9IGF3YWl0IHNlcnZpY2UuY3JlYXRlQ2hhcmFjdGVyRGV2ZWxvcG1lbnRXb3JrZmxvdyhcbiAgICAgIGNoYXJhY3RlcklkLFxuICAgICAgY2hhcmFjdGVyQ29uY2VwdCxcbiAgICAgIHtcbiAgICAgICAgYXJjaGV0eXBlOiAnaGVybycsXG4gICAgICAgIGNvbXBsZXhpdHk6ICdkZXRhaWxlZCcsXG4gICAgICB9XG4gICAgKVxuXG4gICAgZXhwZWN0KHR5cGVvZiB3b3JrZmxvd0lkKS50b0JlKCdzdHJpbmcnKVxuXG4gICAgY29uc3Qgc3RhdHVzID0gc2VydmljZS5nZXRXb3JrZmxvd1N0YXR1cyh3b3JrZmxvd0lkKVxuICAgIGV4cGVjdChzdGF0dXMpLm5vdC50b0JlTnVsbCgpXG4gICAgZXhwZWN0KHN0YXR1cz8ubmFtZSkudG9Db250YWluKCfop5LoibLlvIDlj5EnKVxuICAgIGV4cGVjdChzdGF0dXM/LnN0YXR1cykudG9CZSgncnVubmluZycpXG4gIH0pXG5cbiAgaXQoJ+W6lOivpeiDveWIm+W7uuS4lueVjOaehOW7uuW3peS9nOa1gScsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB3b3JsZElkID0gJ3Rlc3Qtd29ybGQtd29ya2Zsb3cnXG4gICAgY29uc3Qgd29ybGRDb25jZXB0ID0gJ+S4gOS4qumtlOazleS4juenkeaKgOW5tuWtmOeahOWlh+W5u+S4lueVjCdcblxuICAgIGNvbnN0IHdvcmtmbG93SWQgPSBhd2FpdCBzZXJ2aWNlLmNyZWF0ZVdvcmxkQnVpbGRpbmdXb3JrZmxvdyh3b3JsZElkLCB3b3JsZENvbmNlcHQsIHtcbiAgICAgIHNjb3BlOiAnbGFyZ2UnLFxuICAgICAgZ2VucmU6ICdmYW50YXN5JyxcbiAgICAgIHRlY2hub2xvZ3lMZXZlbDogJ21hZ2l0ZWNoJyxcbiAgICAgIG1hZ2ljTGV2ZWw6ICdoaWdoJyxcbiAgICB9KVxuXG4gICAgZXhwZWN0KHR5cGVvZiB3b3JrZmxvd0lkKS50b0JlKCdzdHJpbmcnKVxuXG4gICAgY29uc3Qgc3RhdHVzID0gc2VydmljZS5nZXRXb3JrZmxvd1N0YXR1cyh3b3JrZmxvd0lkKVxuICAgIGV4cGVjdChzdGF0dXMpLm5vdC50b0JlTnVsbCgpXG4gICAgZXhwZWN0KHN0YXR1cz8ubmFtZSkudG9Db250YWluKCfkuJbnlYzmnoTlu7onKVxuICAgIGV4cGVjdChzdGF0dXM/LnN0YXR1cykudG9CZSgncnVubmluZycpXG4gIH0pXG5cbiAgaXQoJ+W6lOivpeiDveWIm+W7uuWkmuaooeaAgeWPmeS6i+W3peS9nOa1gScsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBuYXJyYXRpdmVJZCA9ICd0ZXN0LW11bHRpbW9kYWwtd29ya2Zsb3cnXG4gICAgY29uc3Qgc2NyaXB0ID0gJ+S7juWJjeacieS4gOS4quWLh+aVoueahOWwj+Wtqe+8jOS7luWGs+WumuaOoue0ouacquefpeeahOS4lueVjC4uLidcblxuICAgIGNvbnN0IHdvcmtmbG93SWQgPSBhd2FpdCBzZXJ2aWNlLmNyZWF0ZU11bHRpbW9kYWxOYXJyYXRpdmVXb3JrZmxvdyhuYXJyYXRpdmVJZCwgc2NyaXB0LCBbXG4gICAgICAndGV4dCcsXG4gICAgICAnaW1hZ2UnLFxuICAgICAgJ2F1ZGlvJyxcbiAgICBdKVxuXG4gICAgZXhwZWN0KHR5cGVvZiB3b3JrZmxvd0lkKS50b0JlKCdzdHJpbmcnKVxuXG4gICAgY29uc3Qgc3RhdHVzID0gc2VydmljZS5nZXRXb3JrZmxvd1N0YXR1cyh3b3JrZmxvd0lkKVxuICAgIGV4cGVjdChzdGF0dXMpLm5vdC50b0JlTnVsbCgpXG4gICAgZXhwZWN0KHN0YXR1cz8ubmFtZSkudG9Db250YWluKCflpJrmqKHmgIHlj5nkuosnKVxuICAgIGV4cGVjdChzdGF0dXM/LnN0YXR1cykudG9CZSgncnVubmluZycpXG4gIH0pXG5cbiAgaXQoJ+W6lOivpeiDveeuoeeQhuW3peS9nOa1geeUn+WRveWRqOacnycsIGFzeW5jICgpID0+IHtcbiAgICAvLyDliJvlu7rkuIDkuKrnroDljZXnmoTlt6XkvZzmtYHnlKjkuo7mtYvor5VcbiAgICBjb25zdCBzdG9yeUlkID0gJ2xpZmVjeWNsZS10ZXN0J1xuICAgIGNvbnN0IHdvcmtmbG93SWQgPSBhd2FpdCBzZXJ2aWNlLmNyZWF0ZVN0b3J5Q3JlYXRpb25Xb3JrZmxvdyhzdG9yeUlkLCAn5rWL6K+V55Sf5ZG95ZGo5pyfJylcblxuICAgIC8vIOmqjOivgeWIneWni+eKtuaAgVxuICAgIGxldCBzdGF0dXMgPSBzZXJ2aWNlLmdldFdvcmtmbG93U3RhdHVzKHdvcmtmbG93SWQpXG4gICAgZXhwZWN0KHN0YXR1cz8uc3RhdHVzKS50b0JlKCdydW5uaW5nJylcblxuICAgIC8vIOaaguWBnOW3peS9nOa1gVxuICAgIGF3YWl0IHNlcnZpY2UucGF1c2VXb3JrZmxvdyh3b3JrZmxvd0lkKVxuICAgIHN0YXR1cyA9IHNlcnZpY2UuZ2V0V29ya2Zsb3dTdGF0dXMod29ya2Zsb3dJZClcbiAgICBleHBlY3Qoc3RhdHVzPy5zdGF0dXMpLnRvQmUoJ3BhdXNlZCcpXG5cbiAgICAvLyDmgaLlpI3lt6XkvZzmtYFcbiAgICBhd2FpdCBzZXJ2aWNlLnJlc3VtZVdvcmtmbG93KHdvcmtmbG93SWQpXG4gICAgc3RhdHVzID0gc2VydmljZS5nZXRXb3JrZmxvd1N0YXR1cyh3b3JrZmxvd0lkKVxuICAgIGV4cGVjdChzdGF0dXM/LnN0YXR1cykudG9CZSgncnVubmluZycpXG5cbiAgICAvLyDlj5bmtojlt6XkvZzmtYFcbiAgICBhd2FpdCBzZXJ2aWNlLmNhbmNlbFdvcmtmbG93KHdvcmtmbG93SWQsICfmtYvor5Xlj5bmtognKVxuICAgIHN0YXR1cyA9IHNlcnZpY2UuZ2V0V29ya2Zsb3dTdGF0dXMod29ya2Zsb3dJZClcbiAgICBleHBlY3Qoc3RhdHVzPy5zdGF0dXMpLnRvQmUoJ2NhbmNlbGxlZCcpXG4gIH0pXG5cbiAgaXQoJ+W6lOivpeiDveWIm+W7uuadoeS7tuWIhuaUr+W3peS9nOa1gScsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBjb25kaXRpb25zID0gW1xuICAgICAge1xuICAgICAgICBjb25kaXRpb246ICdpbnB1dERhdGEuZ2VucmUgPT09IFwiZmFudGFzeVwiJyxcbiAgICAgICAgd29ya2Zsb3dUZW1wbGF0ZTogJ3N0b3J5LWNyZWF0aW9uJyxcbiAgICAgICAgcGFyYW1ldGVyczogeyBnZW5yZTogJ2ZhbnRhc3knIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBjb25kaXRpb246ICdpbnB1dERhdGEuZ2VucmUgPT09IFwic2NpLWZpXCInLFxuICAgICAgICB3b3JrZmxvd1RlbXBsYXRlOiAnc3RvcnktY3JlYXRpb24nLFxuICAgICAgICBwYXJhbWV0ZXJzOiB7IGdlbnJlOiAnc2NpLWZpJyB9LFxuICAgICAgfSxcbiAgICBdXG5cbiAgICBjb25zdCB3b3JrZmxvd0lkID0gYXdhaXQgc2VydmljZS5jcmVhdGVDb25kaXRpb25hbFdvcmtmbG93KCfmnaHku7bmlYXkuovliJvkvZwnLCBjb25kaXRpb25zKVxuXG4gICAgZXhwZWN0KHR5cGVvZiB3b3JrZmxvd0lkKS50b0JlKCdzdHJpbmcnKVxuXG4gICAgY29uc3Qgc3RhdHVzID0gc2VydmljZS5nZXRXb3JrZmxvd1N0YXR1cyh3b3JrZmxvd0lkKVxuICAgIGV4cGVjdChzdGF0dXMpLm5vdC50b0JlTnVsbCgpXG4gICAgZXhwZWN0KHN0YXR1cz8ubmFtZSkudG9Db250YWluKCfmnaHku7blt6XkvZzmtYEnKVxuICB9KVxuXG4gIGl0KCflupTor6Xog73ojrflj5bmtLvot4Plt6XkvZzmtYHliJfooagnLCAoKSA9PiB7XG4gICAgY29uc3QgYWN0aXZlV29ya2Zsb3dzID0gc2VydmljZS5nZXRBY3RpdmVXb3JrZmxvd3MoKVxuICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGFjdGl2ZVdvcmtmbG93cykpLnRvQmUodHJ1ZSlcbiAgICAvLyDlvZPliY3lrp7njrDlj6/og73ov5Tlm57nqbrmlbDnu4TvvIzlj5blhrPkuo7lrp7pmYXov5DooYznmoTlt6XkvZzmtYFcbiAgfSlcblxuICBpdCgn5bqU6K+l6IO95riF55CG5bey5a6M5oiQ55qE5bel5L2c5rWBJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGNsZWFuZWQgPSBhd2FpdCBzZXJ2aWNlLmNsZWFudXBDb21wbGV0ZWRXb3JrZmxvd3MoMCkgLy8g5riF55CG5omA5pyJ5bey5a6M5oiQ55qEXG4gICAgZXhwZWN0KHR5cGVvZiBjbGVhbmVkKS50b0JlKCdudW1iZXInKVxuICAgIGV4cGVjdChjbGVhbmVkKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApXG4gIH0pXG5cbiAgaXQoJ+W6lOivpeiDveWIm+W7uuWfuuS6juaooeadv+eahOW3peS9nOa1geWunuS+iycsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB0ZW1wbGF0ZXMgPSBzZXJ2aWNlLmdldEF2YWlsYWJsZVRlbXBsYXRlcygpXG4gICAgY29uc3Qgc3RvcnlUZW1wbGF0ZSA9IHRlbXBsYXRlcy5maW5kKCh0KSA9PiB0Lm5hbWUgPT09ICfmlYXkuovliJvkvZzlt6XkvZzmtYEnKVxuXG4gICAgZXhwZWN0KHN0b3J5VGVtcGxhdGUpLnRvQmVEZWZpbmVkKClcblxuICAgIGNvbnN0IHdvcmtmbG93SWQgPSBhd2FpdCBzZXJ2aWNlLmNyZWF0ZVdvcmtmbG93RnJvbVRlbXBsYXRlKFxuICAgICAgJ3N0b3J5LWNyZWF0aW9uJyxcbiAgICAgICfln7rkuo7mqKHmnb/nmoTmlYXkuosnLFxuICAgICAge1xuICAgICAgICBwcmlvcml0eTogJ2hpZ2gnLFxuICAgICAgICBpbnB1dERhdGE6IHsgY3VzdG9tUHJvbXB0OiAn5rWL6K+V5qih5p2/5a6e5L6L5YyWJyB9LFxuICAgICAgfVxuICAgIClcblxuICAgIGV4cGVjdCh0eXBlb2Ygd29ya2Zsb3dJZCkudG9CZSgnc3RyaW5nJylcblxuICAgIGNvbnN0IHN0YXR1cyA9IHNlcnZpY2UuZ2V0V29ya2Zsb3dTdGF0dXMod29ya2Zsb3dJZClcbiAgICBleHBlY3Qoc3RhdHVzKS5ub3QudG9CZU51bGwoKVxuICAgIGV4cGVjdChzdGF0dXM/Lm5hbWUpLnRvQmUoJ+WfuuS6juaooeadv+eahOaVheS6iycpXG4gIH0pXG5cbiAgaXQoJ+W6lOivpeiDveWIm+W7uuiHquWumuS5ieW3peS9nOa1gScsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBjdXN0b21UZW1wbGF0ZSA9IHtcbiAgICAgIG5hbWU6ICfoh6rlrprkuYnmtYvor5Xlt6XkvZzmtYEnLFxuICAgICAgZGVzY3JpcHRpb246ICfnlKjkuo7mtYvor5XnmoTnroDljZXlt6XkvZzmtYEnLFxuICAgICAgdmVyc2lvbjogJzEuMC4wJyxcbiAgICAgIG5vZGVzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ3N0YXJ0LW5vZGUnLFxuICAgICAgICAgIHR5cGU6ICd0YXNrJyBhcyBjb25zdCxcbiAgICAgICAgICBuYW1lOiAn5byA5aeL5Lu75YqhJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ+W3peS9nOa1geeahOi1t+Wni+S7u+WKoScsXG4gICAgICAgICAgY29uZmlnOiB7IHRhc2tUeXBlOiAndGVzdCcgfSxcbiAgICAgICAgICBpbnB1dHM6IFtdLFxuICAgICAgICAgIG91dHB1dHM6IFt7IGlkOiAnc3RhcnQtb3V0Jywgc291cmNlTm9kZUlkOiAnc3RhcnQtbm9kZScsIHRhcmdldE5vZGVJZDogJ2VuZC1ub2RlJyB9XSxcbiAgICAgICAgICBzdGF0dXM6ICdwZW5kaW5nJyBhcyBjb25zdCxcbiAgICAgICAgICByZXRyeUNvdW50OiAwLFxuICAgICAgICAgIG1heFJldHJpZXM6IDEsXG4gICAgICAgICAgdGltZW91dDogMzAwMDAsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ2VuZC1ub2RlJyxcbiAgICAgICAgICB0eXBlOiAndGFzaycgYXMgY29uc3QsXG4gICAgICAgICAgbmFtZTogJ+e7k+adn+S7u+WKoScsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICflt6XkvZzmtYHnmoTnu5PmnZ/ku7vliqEnLFxuICAgICAgICAgIGNvbmZpZzogeyB0YXNrVHlwZTogJ3Rlc3QnIH0sXG4gICAgICAgICAgaW5wdXRzOiBbeyBpZDogJ2VuZC1pbicsIHNvdXJjZU5vZGVJZDogJ3N0YXJ0LW5vZGUnLCB0YXJnZXROb2RlSWQ6ICdlbmQtbm9kZScgfV0sXG4gICAgICAgICAgb3V0cHV0czogW10sXG4gICAgICAgICAgc3RhdHVzOiAncGVuZGluZycgYXMgY29uc3QsXG4gICAgICAgICAgcmV0cnlDb3VudDogMCxcbiAgICAgICAgICBtYXhSZXRyaWVzOiAxLFxuICAgICAgICAgIHRpbWVvdXQ6IDMwMDAwLFxuICAgICAgICAgIGRlcGVuZGVuY2llczogWydzdGFydC1ub2RlJ10sXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgY29ubmVjdGlvbnM6IFtdLFxuICAgICAgZGVmYXVsdENvbmZpZzoge1xuICAgICAgICBtYXhSZXRyaWVzOiAxLFxuICAgICAgICB0aW1lb3V0OiA2MDAwMCxcbiAgICAgICAgcHJpb3JpdHk6ICdub3JtYWwnIGFzIGNvbnN0LFxuICAgICAgfSxcbiAgICAgIHRhZ3M6IFsndGVzdCcsICdjdXN0b20nXSxcbiAgICB9XG5cbiAgICBjb25zdCB3b3JrZmxvd0lkID0gYXdhaXQgc2VydmljZS5jcmVhdGVDdXN0b21Xb3JrZmxvdyhjdXN0b21UZW1wbGF0ZSwgJ+iHquWumuS5ieW3peS9nOa1gea1i+ivlScpXG5cbiAgICBleHBlY3QodHlwZW9mIHdvcmtmbG93SWQpLnRvQmUoJ3N0cmluZycpXG5cbiAgICBjb25zdCBzdGF0dXMgPSBzZXJ2aWNlLmdldFdvcmtmbG93U3RhdHVzKHdvcmtmbG93SWQpXG4gICAgZXhwZWN0KHN0YXR1cykubm90LnRvQmVOdWxsKClcbiAgICBleHBlY3Qoc3RhdHVzPy5uYW1lKS50b0JlKCfoh6rlrprkuYnlt6XkvZzmtYHmtYvor5UnKVxuICB9KVxuXG4gIGl0KCflupTor6XmraPnoa7phY3nva7lt6XkvZzmtYHlj4LmlbAnLCAoKSA9PiB7XG4gICAgZXhwZWN0KGNvbmZpZ1NlcnZpY2UuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnV09SS0ZMT1dfTUFYX0NPTkNVUlJFTlQnLCAxMClcbiAgICBleHBlY3QoY29uZmlnU2VydmljZS5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdXT1JLRkxPV19ERUZBVUxUX1RJTUVPVVQnLCAzMDAwMDApXG4gIH0pXG59KVxuIl0sInZlcnNpb24iOjN9