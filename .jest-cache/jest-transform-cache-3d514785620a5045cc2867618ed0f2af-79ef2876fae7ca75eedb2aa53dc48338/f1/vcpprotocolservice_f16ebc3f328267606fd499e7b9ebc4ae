004b0d8401f5ac2485e36fc5a16e1e75
"use strict";
// ============================================================================
// VCP协议核心服务集成
// 集成 VCPToolBox 的统一交互标准到创世星环
// ============================================================================
var __esDecorate = (this && this.__esDecorate) || function (ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {
    function accept(f) { if (f !== void 0 && typeof f !== "function") throw new TypeError("Function expected"); return f; }
    var kind = contextIn.kind, key = kind === "getter" ? "get" : kind === "setter" ? "set" : "value";
    var target = !descriptorIn && ctor ? contextIn["static"] ? ctor : ctor.prototype : null;
    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});
    var _, done = false;
    for (var i = decorators.length - 1; i >= 0; i--) {
        var context = {};
        for (var p in contextIn) context[p] = p === "access" ? {} : contextIn[p];
        for (var p in contextIn.access) context.access[p] = contextIn.access[p];
        context.addInitializer = function (f) { if (done) throw new TypeError("Cannot add initializers after decoration has completed"); extraInitializers.push(accept(f || null)); };
        var result = (0, decorators[i])(kind === "accessor" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);
        if (kind === "accessor") {
            if (result === void 0) continue;
            if (result === null || typeof result !== "object") throw new TypeError("Object expected");
            if (_ = accept(result.get)) descriptor.get = _;
            if (_ = accept(result.set)) descriptor.set = _;
            if (_ = accept(result.init)) initializers.unshift(_);
        }
        else if (_ = accept(result)) {
            if (kind === "field") initializers.unshift(_);
            else descriptor[key] = _;
        }
    }
    if (target) Object.defineProperty(target, contextIn.name, descriptor);
    done = true;
};
var __runInitializers = (this && this.__runInitializers) || function (thisArg, initializers, value) {
    var useValue = arguments.length > 2;
    for (var i = 0; i < initializers.length; i++) {
        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);
    }
    return useValue ? value : void 0;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.VCPProtocolService = void 0;
const common_1 = require("@nestjs/common");
const VCPProtocol_1 = require("../../../apps/vcptoolbox/src/modules/communication/VCPProtocol");
let VCPProtocolService = (() => {
    let _classDecorators = [(0, common_1.Injectable)()];
    let _classDescriptor;
    let _classExtraInitializers = [];
    let _classThis;
    var VCPProtocolService = class {
        static { _classThis = this; }
        static {
            const _metadata = typeof Symbol === "function" && Symbol.metadata ? Object.create(null) : void 0;
            __esDecorate(null, _classDescriptor = { value: _classThis }, _classDecorators, { kind: "class", name: _classThis.name, metadata: _metadata }, null, _classExtraInitializers);
            VCPProtocolService = _classThis = _classDescriptor.value;
            if (_metadata) Object.defineProperty(_classThis, Symbol.metadata, { enumerable: true, configurable: true, writable: true, value: _metadata });
            __runInitializers(_classThis, _classExtraInitializers);
        }
        configService;
        logger = new common_1.Logger(VCPProtocolService.name);
        constructor(configService) {
            this.configService = configService;
        }
        async onModuleInit() {
            await this.initializeVCPProtocol();
            this.setupProtocolHandlers();
            this.registerSystemEndpoints();
            this.logger.log('VCP协议服务已初始化');
        }
        // ==================== 协议初始化 ====================
        /**
         * 初始化VCP协议
         */
        async initializeVCPProtocol() {
            // 设置协议事件监听器
            VCPProtocol_1.vcpProtocol.on('message', (message) => {
                this.logger.debug(`VCP消息接收: ${message.action}`);
            });
            VCPProtocol_1.vcpProtocol.on('error', (error) => {
                this.logger.error('VCP协议错误:', error);
            });
            this.logger.log('VCP协议核心已初始化');
        }
        /**
         * 设置协议处理器
         */
        setupProtocolHandlers() {
            // 订阅重要的协议事件
            VCPProtocol_1.vcpProtocol.subscribe('tool.execution', (message) => {
                this.handleToolExecutionEvent(message);
            });
            VCPProtocol_1.vcpProtocol.subscribe('agent.collaboration', (message) => {
                this.handleAgentCollaborationEvent(message);
            });
            VCPProtocol_1.vcpProtocol.subscribe('narrative.generation', (message) => {
                this.handleNarrativeGenerationEvent(message);
            });
        }
        /**
         * 注册系统端点
         */
        registerSystemEndpoints() {
            // 注册AI服务端点
            VCPProtocol_1.vcpProtocol.registerEndpoint({
                id: 'ai-service',
                type: 'service',
                url: 'internal://ai-service',
                capabilities: ['text-generation', 'image-generation', 'analysis'],
                status: 'online',
                metadata: {
                    version: '1.0.0',
                    description: 'AI服务端点',
                    author: 'system',
                    lastSeen: new Date(),
                },
            });
            // 注册记忆服务端点
            VCPProtocol_1.vcpProtocol.registerEndpoint({
                id: 'memory-service',
                type: 'service',
                url: 'internal://memory-service',
                capabilities: ['memory-read', 'memory-write', 'memory-search'],
                status: 'online',
                metadata: {
                    version: '1.0.0',
                    description: '记忆服务端点',
                    author: 'system',
                    lastSeen: new Date(),
                },
            });
            // 注册文件服务端点
            VCPProtocol_1.vcpProtocol.registerEndpoint({
                id: 'file-service',
                type: 'service',
                url: 'internal://file-service',
                capabilities: ['file-upload', 'file-download', 'file-list'],
                status: 'online',
                metadata: {
                    version: '1.0.0',
                    description: '文件服务端点',
                    author: 'system',
                    lastSeen: new Date(),
                },
            });
            this.logger.log('系统端点已注册');
        }
        // ==================== 事件处理器 ====================
        /**
         * 处理工具执行事件
         */
        async handleToolExecutionEvent(message) {
            const { toolId, status, result } = message.payload;
            this.logger.debug(`工具执行事件: ${toolId} - ${status}`);
            // 可以在这里添加监控、日志记录等
            if (status === 'error') {
                this.logger.warn(`工具执行失败: ${toolId}`, result);
            }
        }
        /**
         * 处理Agent协作事件
         */
        async handleAgentCollaborationEvent(message) {
            const { agentId, action, context } = message.payload;
            this.logger.debug(`Agent协作事件: ${agentId} - ${action}`);
            // 处理协作相关的逻辑
        }
        /**
         * 处理叙事生成事件
         */
        async handleNarrativeGenerationEvent(message) {
            const { storyId, progress, status } = message.payload;
            this.logger.debug(`叙事生成事件: ${storyId} - ${progress}% - ${status}`);
            // 处理叙事生成进度
        }
        // ==================== 工具集成接口 ====================
        /**
         * 调用AI生成工具
         */
        async callAIGenerationTool(prompt, options = {}) {
            const request = {
                toolId: options.type === 'image' ? 'image-generator' : 'text-generator',
                action: 'generate',
                parameters: {
                    prompt,
                    model: options.model || 'gpt-4',
                    temperature: options.temperature || 0.7,
                    maxTokens: options.maxTokens || 1000,
                },
                options: {
                    timeout: 60000, // 60秒超时
                    async: true,
                },
            };
            try {
                const response = await VCPProtocol_1.vcpProtocol.callTool(request);
                this.logger.log(`AI工具调用成功: ${request.toolId}`);
                return response;
            }
            catch (error) {
                this.logger.error(`AI工具调用失败: ${request.toolId}`, error);
                throw error;
            }
        }
        /**
         * 调用分析工具
         */
        async callAnalysisTool(content, analysisType) {
            const request = {
                toolId: 'content-analyzer',
                action: 'analyze',
                parameters: {
                    content,
                    type: analysisType,
                },
                options: {
                    timeout: 30000,
                    async: false,
                },
            };
            const response = await VCPProtocol_1.vcpProtocol.callTool(request);
            this.logger.log(`分析工具调用成功: ${analysisType}`);
            return response;
        }
        /**
         * 调用翻译工具
         */
        async callTranslationTool(text, targetLanguage) {
            const request = {
                toolId: 'translator',
                action: 'translate',
                parameters: {
                    text,
                    targetLanguage,
                },
            };
            const response = await VCPProtocol_1.vcpProtocol.callTool(request);
            return response.result?.translatedText || text;
        }
        // ==================== 记忆操作接口 ====================
        /**
         * 读取记忆
         */
        async readMemory(key, scope = 'global') {
            const operation = {
                operation: 'read',
                scope,
                parameters: { key },
            };
            const message = {
                id: `memory-read-${Date.now()}`,
                version: '1.0',
                type: 'request',
                action: 'memory.read',
                payload: operation,
                metadata: {
                    timestamp: new Date(),
                    source: 'vcp-protocol-service',
                    priority: 'normal',
                },
                security: {
                    permissions: ['memory.read'],
                },
            };
            const response = await VCPProtocol_1.vcpProtocol.sendMessage(message);
            return response;
        }
        /**
         * 写入记忆
         */
        async writeMemory(key, value, scope = 'global') {
            const operation = {
                operation: 'write',
                scope,
                parameters: { key, value },
            };
            const message = {
                id: `memory-write-${Date.now()}`,
                version: '1.0',
                type: 'request',
                action: 'memory.write',
                payload: operation,
                metadata: {
                    timestamp: new Date(),
                    source: 'vcp-protocol-service',
                    priority: 'normal',
                },
                security: {
                    permissions: ['memory.write'],
                },
            };
            await VCPProtocol_1.vcpProtocol.sendMessage(message);
        }
        /**
         * 搜索记忆
         */
        async searchMemory(query, tags) {
            const operation = {
                operation: 'search',
                scope: 'global',
                parameters: {
                    query,
                    tags,
                    limit: 10,
                },
            };
            const message = {
                id: `memory-search-${Date.now()}`,
                version: '1.0',
                type: 'request',
                action: 'memory.search',
                payload: operation,
                metadata: {
                    timestamp: new Date(),
                    source: 'vcp-protocol-service',
                    priority: 'normal',
                },
                security: {
                    permissions: ['memory.read'],
                },
            };
            const response = await VCPProtocol_1.vcpProtocol.sendMessage(message);
            return response?.results || [];
        }
        // ==================== 文件操作接口 ====================
        /**
         * 上传文件
         */
        async uploadFile(fileData, options) {
            const operation = {
                operation: 'upload',
                path: options?.filename || `upload-${Date.now()}`,
                data: fileData,
                options: {
                    mimeType: options?.mimeType,
                },
            };
            const message = {
                id: `file-upload-${Date.now()}`,
                version: '1.0',
                type: 'request',
                action: 'file.upload',
                payload: operation,
                metadata: {
                    timestamp: new Date(),
                    source: 'vcp-protocol-service',
                    priority: 'normal',
                },
                security: {
                    permissions: ['file.upload'],
                },
            };
            const response = await VCPProtocol_1.vcpProtocol.sendMessage(message);
            return response;
        }
        /**
         * 下载文件
         */
        async downloadFile(fileId) {
            const operation = {
                operation: 'download',
                path: fileId,
            };
            const message = {
                id: `file-download-${Date.now()}`,
                version: '1.0',
                type: 'request',
                action: 'file.download',
                payload: operation,
                metadata: {
                    timestamp: new Date(),
                    source: 'vcp-protocol-service',
                    priority: 'normal',
                },
                security: {
                    permissions: ['file.download'],
                },
            };
            const response = await VCPProtocol_1.vcpProtocol.sendMessage(message);
            return response?.data;
        }
        // ==================== 叙事专用接口 ====================
        /**
         * 发送叙事生成请求
         */
        async requestNarrativeGeneration(storyId, prompt, context) {
            const message = {
                id: `narrative-gen-${Date.now()}`,
                version: '1.0',
                type: 'request',
                action: 'narrative.generate',
                payload: {
                    storyId,
                    prompt,
                    context,
                    options: {
                        async: true,
                        priority: 'high',
                    },
                },
                metadata: {
                    timestamp: new Date(),
                    source: 'narrative-service',
                    priority: 'high',
                },
                security: {
                    permissions: ['narrative.generate'],
                },
            };
            const response = await VCPProtocol_1.vcpProtocol.sendMessage(message);
            return response?.taskId || message.id;
        }
        /**
         * 发送Agent协作请求
         */
        async requestAgentCollaboration(collaborationId, agentIds, task) {
            const message = {
                id: `collaboration-${Date.now()}`,
                version: '1.0',
                type: 'request',
                action: 'agent.collaborate',
                payload: {
                    collaborationId,
                    agentIds,
                    task,
                    strategy: 'parallel', // 并行协作
                },
                metadata: {
                    timestamp: new Date(),
                    source: 'collaboration-service',
                    priority: 'normal',
                },
                security: {
                    permissions: ['agent.collaborate'],
                },
            };
            const response = await VCPProtocol_1.vcpProtocol.sendMessage(message);
            return response?.collaborationId || collaborationId;
        }
        /**
         * 广播系统事件
         */
        async broadcastSystemEvent(eventType, eventData) {
            const message = {
                id: `system-event-${Date.now()}`,
                version: '1.0',
                type: 'event',
                action: `system.${eventType}`,
                payload: eventData,
                metadata: {
                    timestamp: new Date(),
                    source: 'system',
                    priority: 'normal',
                },
                security: {
                    permissions: ['system.broadcast'],
                },
            };
            await VCPProtocol_1.vcpProtocol.sendMessage(message);
        }
        // ==================== 端点管理 ====================
        /**
         * 获取可用端点
         */
        getAvailableEndpoints(capability) {
            return VCPProtocol_1.vcpProtocol.findEndpoints(capability);
        }
        /**
         * 注册自定义端点
         */
        registerEndpoint(endpoint) {
            VCPProtocol_1.vcpProtocol.registerEndpoint(endpoint);
            this.logger.log(`自定义端点已注册: ${endpoint.id}`);
        }
        /**
         * 注销端点
         */
        unregisterEndpoint(endpointId) {
            VCPProtocol_1.vcpProtocol.unregisterEndpoint(endpointId);
            this.logger.log(`端点已注销: ${endpointId}`);
        }
        // ==================== 监控和统计 ====================
        /**
         * 获取协议统计信息
         */
        getProtocolStats() {
            return VCPProtocol_1.vcpProtocol.getStats();
        }
        /**
         * 健康检查
         */
        async healthCheck() {
            try {
                const stats = this.getProtocolStats();
                return {
                    status: 'healthy',
                    details: stats,
                };
            }
            catch (error) {
                return {
                    status: 'error',
                    details: error.message,
                };
            }
        }
        /**
         * 清理过期任务
         */
        async cleanupExpiredTasks() {
            // 清理VCP协议中的过期任务
            this.logger.log('VCP协议任务清理完成');
        }
    };
    return VCPProtocolService = _classThis;
})();
exports.VCPProtocolService = VCPProtocolService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFwxNjY2M1xcRGVza3RvcFxcdHVoZWdcXHBhY2thZ2VzXFxjb21tb24tYmFja2VuZFxcc3JjXFx2Y3BcXHZjcC1wcm90b2NvbC5zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7QUFBQSwrRUFBK0U7QUFDL0UsY0FBYztBQUNkLDZCQUE2QjtBQUM3QiwrRUFBK0U7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFL0UsMkNBQXNFO0FBRXRFLGdHQVF1RTtJQUcxRCxrQkFBa0I7NEJBRDlCLElBQUEsbUJBQVUsR0FBRTs7Ozs7Ozs7WUFDYiw2S0FnaEJDOzs7WUFoaEJZLHVEQUFrQjs7UUFHVCxhQUFhO1FBRmhCLE1BQU0sR0FBRyxJQUFJLGVBQU0sQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsQ0FBQTtRQUU3RCxZQUFvQixhQUE0QjtZQUE1QixrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQUFHLENBQUM7UUFFcEQsS0FBSyxDQUFDLFlBQVk7WUFDaEIsTUFBTSxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQTtZQUNsQyxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQTtZQUM1QixJQUFJLENBQUMsdUJBQXVCLEVBQUUsQ0FBQTtZQUM5QixJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQTtRQUNoQyxDQUFDO1FBRUQsa0RBQWtEO1FBRWxEOztXQUVHO1FBQ0ssS0FBSyxDQUFDLHFCQUFxQjtZQUNqQyxZQUFZO1lBQ1oseUJBQVcsQ0FBQyxFQUFFLENBQUMsU0FBUyxFQUFFLENBQUMsT0FBbUIsRUFBRSxFQUFFO2dCQUNoRCxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxZQUFZLE9BQU8sQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFBO1lBQ2pELENBQUMsQ0FBQyxDQUFBO1lBRUYseUJBQVcsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLENBQUMsS0FBWSxFQUFFLEVBQUU7Z0JBQ3ZDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxLQUFLLENBQUMsQ0FBQTtZQUN0QyxDQUFDLENBQUMsQ0FBQTtZQUVGLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxDQUFBO1FBQ2hDLENBQUM7UUFFRDs7V0FFRztRQUNLLHFCQUFxQjtZQUMzQixZQUFZO1lBQ1oseUJBQVcsQ0FBQyxTQUFTLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQyxPQUFtQixFQUFFLEVBQUU7Z0JBQzlELElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxPQUFPLENBQUMsQ0FBQTtZQUN4QyxDQUFDLENBQUMsQ0FBQTtZQUVGLHlCQUFXLENBQUMsU0FBUyxDQUFDLHFCQUFxQixFQUFFLENBQUMsT0FBbUIsRUFBRSxFQUFFO2dCQUNuRSxJQUFJLENBQUMsNkJBQTZCLENBQUMsT0FBTyxDQUFDLENBQUE7WUFDN0MsQ0FBQyxDQUFDLENBQUE7WUFFRix5QkFBVyxDQUFDLFNBQVMsQ0FBQyxzQkFBc0IsRUFBRSxDQUFDLE9BQW1CLEVBQUUsRUFBRTtnQkFDcEUsSUFBSSxDQUFDLDhCQUE4QixDQUFDLE9BQU8sQ0FBQyxDQUFBO1lBQzlDLENBQUMsQ0FBQyxDQUFBO1FBQ0osQ0FBQztRQUVEOztXQUVHO1FBQ0ssdUJBQXVCO1lBQzdCLFdBQVc7WUFDWCx5QkFBVyxDQUFDLGdCQUFnQixDQUFDO2dCQUMzQixFQUFFLEVBQUUsWUFBWTtnQkFDaEIsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsR0FBRyxFQUFFLHVCQUF1QjtnQkFDNUIsWUFBWSxFQUFFLENBQUMsaUJBQWlCLEVBQUUsa0JBQWtCLEVBQUUsVUFBVSxDQUFDO2dCQUNqRSxNQUFNLEVBQUUsUUFBUTtnQkFDaEIsUUFBUSxFQUFFO29CQUNSLE9BQU8sRUFBRSxPQUFPO29CQUNoQixXQUFXLEVBQUUsUUFBUTtvQkFDckIsTUFBTSxFQUFFLFFBQVE7b0JBQ2hCLFFBQVEsRUFBRSxJQUFJLElBQUksRUFBRTtpQkFDckI7YUFDRixDQUFDLENBQUE7WUFFRixXQUFXO1lBQ1gseUJBQVcsQ0FBQyxnQkFBZ0IsQ0FBQztnQkFDM0IsRUFBRSxFQUFFLGdCQUFnQjtnQkFDcEIsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsR0FBRyxFQUFFLDJCQUEyQjtnQkFDaEMsWUFBWSxFQUFFLENBQUMsYUFBYSxFQUFFLGNBQWMsRUFBRSxlQUFlLENBQUM7Z0JBQzlELE1BQU0sRUFBRSxRQUFRO2dCQUNoQixRQUFRLEVBQUU7b0JBQ1IsT0FBTyxFQUFFLE9BQU87b0JBQ2hCLFdBQVcsRUFBRSxRQUFRO29CQUNyQixNQUFNLEVBQUUsUUFBUTtvQkFDaEIsUUFBUSxFQUFFLElBQUksSUFBSSxFQUFFO2lCQUNyQjthQUNGLENBQUMsQ0FBQTtZQUVGLFdBQVc7WUFDWCx5QkFBVyxDQUFDLGdCQUFnQixDQUFDO2dCQUMzQixFQUFFLEVBQUUsY0FBYztnQkFDbEIsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsR0FBRyxFQUFFLHlCQUF5QjtnQkFDOUIsWUFBWSxFQUFFLENBQUMsYUFBYSxFQUFFLGVBQWUsRUFBRSxXQUFXLENBQUM7Z0JBQzNELE1BQU0sRUFBRSxRQUFRO2dCQUNoQixRQUFRLEVBQUU7b0JBQ1IsT0FBTyxFQUFFLE9BQU87b0JBQ2hCLFdBQVcsRUFBRSxRQUFRO29CQUNyQixNQUFNLEVBQUUsUUFBUTtvQkFDaEIsUUFBUSxFQUFFLElBQUksSUFBSSxFQUFFO2lCQUNyQjthQUNGLENBQUMsQ0FBQTtZQUVGLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFBO1FBQzVCLENBQUM7UUFFRCxrREFBa0Q7UUFFbEQ7O1dBRUc7UUFDSyxLQUFLLENBQUMsd0JBQXdCLENBQUMsT0FBbUI7WUFDeEQsTUFBTSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQTtZQUNsRCxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxXQUFXLE1BQU0sTUFBTSxNQUFNLEVBQUUsQ0FBQyxDQUFBO1lBRWxELGtCQUFrQjtZQUNsQixJQUFJLE1BQU0sS0FBSyxPQUFPLEVBQUUsQ0FBQztnQkFDdkIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsV0FBVyxNQUFNLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQTtZQUMvQyxDQUFDO1FBQ0gsQ0FBQztRQUVEOztXQUVHO1FBQ0ssS0FBSyxDQUFDLDZCQUE2QixDQUFDLE9BQW1CO1lBQzdELE1BQU0sRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUE7WUFDcEQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsY0FBYyxPQUFPLE1BQU0sTUFBTSxFQUFFLENBQUMsQ0FBQTtZQUV0RCxZQUFZO1FBQ2QsQ0FBQztRQUVEOztXQUVHO1FBQ0ssS0FBSyxDQUFDLDhCQUE4QixDQUFDLE9BQW1CO1lBQzlELE1BQU0sRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUE7WUFDckQsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsV0FBVyxPQUFPLE1BQU0sUUFBUSxPQUFPLE1BQU0sRUFBRSxDQUFDLENBQUE7WUFFbEUsV0FBVztRQUNiLENBQUM7UUFFRCxtREFBbUQ7UUFFbkQ7O1dBRUc7UUFDSCxLQUFLLENBQUMsb0JBQW9CLENBQ3hCLE1BQWMsRUFDZCxVQUtJLEVBQUU7WUFFTixNQUFNLE9BQU8sR0FBbUI7Z0JBQzlCLE1BQU0sRUFBRSxPQUFPLENBQUMsSUFBSSxLQUFLLE9BQU8sQ0FBQyxDQUFDLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLGdCQUFnQjtnQkFDdkUsTUFBTSxFQUFFLFVBQVU7Z0JBQ2xCLFVBQVUsRUFBRTtvQkFDVixNQUFNO29CQUNOLEtBQUssRUFBRSxPQUFPLENBQUMsS0FBSyxJQUFJLE9BQU87b0JBQy9CLFdBQVcsRUFBRSxPQUFPLENBQUMsV0FBVyxJQUFJLEdBQUc7b0JBQ3ZDLFNBQVMsRUFBRSxPQUFPLENBQUMsU0FBUyxJQUFJLElBQUk7aUJBQ3JDO2dCQUNELE9BQU8sRUFBRTtvQkFDUCxPQUFPLEVBQUUsS0FBSyxFQUFFLFFBQVE7b0JBQ3hCLEtBQUssRUFBRSxJQUFJO2lCQUNaO2FBQ0YsQ0FBQTtZQUVELElBQUksQ0FBQztnQkFDSCxNQUFNLFFBQVEsR0FBRyxNQUFNLHlCQUFXLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFBO2dCQUNwRCxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxhQUFhLE9BQU8sQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFBO2dCQUM5QyxPQUFPLFFBQVEsQ0FBQTtZQUNqQixDQUFDO1lBQUMsT0FBTyxLQUFVLEVBQUUsQ0FBQztnQkFDcEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsYUFBYSxPQUFPLENBQUMsTUFBTSxFQUFFLEVBQUUsS0FBSyxDQUFDLENBQUE7Z0JBQ3ZELE1BQU0sS0FBSyxDQUFBO1lBQ2IsQ0FBQztRQUNILENBQUM7UUFFRDs7V0FFRztRQUNILEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFlLEVBQUUsWUFBb0I7WUFDMUQsTUFBTSxPQUFPLEdBQW1CO2dCQUM5QixNQUFNLEVBQUUsa0JBQWtCO2dCQUMxQixNQUFNLEVBQUUsU0FBUztnQkFDakIsVUFBVSxFQUFFO29CQUNWLE9BQU87b0JBQ1AsSUFBSSxFQUFFLFlBQVk7aUJBQ25CO2dCQUNELE9BQU8sRUFBRTtvQkFDUCxPQUFPLEVBQUUsS0FBSztvQkFDZCxLQUFLLEVBQUUsS0FBSztpQkFDYjthQUNGLENBQUE7WUFFRCxNQUFNLFFBQVEsR0FBRyxNQUFNLHlCQUFXLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFBO1lBQ3BELElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLGFBQWEsWUFBWSxFQUFFLENBQUMsQ0FBQTtZQUM1QyxPQUFPLFFBQVEsQ0FBQTtRQUNqQixDQUFDO1FBRUQ7O1dBRUc7UUFDSCxLQUFLLENBQUMsbUJBQW1CLENBQUMsSUFBWSxFQUFFLGNBQXNCO1lBQzVELE1BQU0sT0FBTyxHQUFtQjtnQkFDOUIsTUFBTSxFQUFFLFlBQVk7Z0JBQ3BCLE1BQU0sRUFBRSxXQUFXO2dCQUNuQixVQUFVLEVBQUU7b0JBQ1YsSUFBSTtvQkFDSixjQUFjO2lCQUNmO2FBQ0YsQ0FBQTtZQUVELE1BQU0sUUFBUSxHQUFHLE1BQU0seUJBQVcsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUE7WUFDcEQsT0FBTyxRQUFRLENBQUMsTUFBTSxFQUFFLGNBQWMsSUFBSSxJQUFJLENBQUE7UUFDaEQsQ0FBQztRQUVELG1EQUFtRDtRQUVuRDs7V0FFRztRQUNILEtBQUssQ0FBQyxVQUFVLENBQUMsR0FBVyxFQUFFLFFBQXdDLFFBQVE7WUFDNUUsTUFBTSxTQUFTLEdBQXVCO2dCQUNwQyxTQUFTLEVBQUUsTUFBTTtnQkFDakIsS0FBSztnQkFDTCxVQUFVLEVBQUUsRUFBRSxHQUFHLEVBQUU7YUFDcEIsQ0FBQTtZQUVELE1BQU0sT0FBTyxHQUFlO2dCQUMxQixFQUFFLEVBQUUsZUFBZSxJQUFJLENBQUMsR0FBRyxFQUFFLEVBQUU7Z0JBQy9CLE9BQU8sRUFBRSxLQUFLO2dCQUNkLElBQUksRUFBRSxTQUFTO2dCQUNmLE1BQU0sRUFBRSxhQUFhO2dCQUNyQixPQUFPLEVBQUUsU0FBUztnQkFDbEIsUUFBUSxFQUFFO29CQUNSLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTtvQkFDckIsTUFBTSxFQUFFLHNCQUFzQjtvQkFDOUIsUUFBUSxFQUFFLFFBQVE7aUJBQ25CO2dCQUNELFFBQVEsRUFBRTtvQkFDUixXQUFXLEVBQUUsQ0FBQyxhQUFhLENBQUM7aUJBQzdCO2FBQ0YsQ0FBQTtZQUVELE1BQU0sUUFBUSxHQUFHLE1BQU0seUJBQVcsQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUE7WUFDdkQsT0FBTyxRQUFRLENBQUE7UUFDakIsQ0FBQztRQUVEOztXQUVHO1FBQ0gsS0FBSyxDQUFDLFdBQVcsQ0FDZixHQUFXLEVBQ1gsS0FBVSxFQUNWLFFBQXdDLFFBQVE7WUFFaEQsTUFBTSxTQUFTLEdBQXVCO2dCQUNwQyxTQUFTLEVBQUUsT0FBTztnQkFDbEIsS0FBSztnQkFDTCxVQUFVLEVBQUUsRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFO2FBQzNCLENBQUE7WUFFRCxNQUFNLE9BQU8sR0FBZTtnQkFDMUIsRUFBRSxFQUFFLGdCQUFnQixJQUFJLENBQUMsR0FBRyxFQUFFLEVBQUU7Z0JBQ2hDLE9BQU8sRUFBRSxLQUFLO2dCQUNkLElBQUksRUFBRSxTQUFTO2dCQUNmLE1BQU0sRUFBRSxjQUFjO2dCQUN0QixPQUFPLEVBQUUsU0FBUztnQkFDbEIsUUFBUSxFQUFFO29CQUNSLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTtvQkFDckIsTUFBTSxFQUFFLHNCQUFzQjtvQkFDOUIsUUFBUSxFQUFFLFFBQVE7aUJBQ25CO2dCQUNELFFBQVEsRUFBRTtvQkFDUixXQUFXLEVBQUUsQ0FBQyxjQUFjLENBQUM7aUJBQzlCO2FBQ0YsQ0FBQTtZQUVELE1BQU0seUJBQVcsQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUE7UUFDeEMsQ0FBQztRQUVEOztXQUVHO1FBQ0gsS0FBSyxDQUFDLFlBQVksQ0FBQyxLQUFhLEVBQUUsSUFBZTtZQUMvQyxNQUFNLFNBQVMsR0FBdUI7Z0JBQ3BDLFNBQVMsRUFBRSxRQUFRO2dCQUNuQixLQUFLLEVBQUUsUUFBUTtnQkFDZixVQUFVLEVBQUU7b0JBQ1YsS0FBSztvQkFDTCxJQUFJO29CQUNKLEtBQUssRUFBRSxFQUFFO2lCQUNWO2FBQ0YsQ0FBQTtZQUVELE1BQU0sT0FBTyxHQUFlO2dCQUMxQixFQUFFLEVBQUUsaUJBQWlCLElBQUksQ0FBQyxHQUFHLEVBQUUsRUFBRTtnQkFDakMsT0FBTyxFQUFFLEtBQUs7Z0JBQ2QsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsTUFBTSxFQUFFLGVBQWU7Z0JBQ3ZCLE9BQU8sRUFBRSxTQUFTO2dCQUNsQixRQUFRLEVBQUU7b0JBQ1IsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO29CQUNyQixNQUFNLEVBQUUsc0JBQXNCO29CQUM5QixRQUFRLEVBQUUsUUFBUTtpQkFDbkI7Z0JBQ0QsUUFBUSxFQUFFO29CQUNSLFdBQVcsRUFBRSxDQUFDLGFBQWEsQ0FBQztpQkFDN0I7YUFDRixDQUFBO1lBRUQsTUFBTSxRQUFRLEdBQUcsTUFBTSx5QkFBVyxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQTtZQUN2RCxPQUFPLFFBQVEsRUFBRSxPQUFPLElBQUksRUFBRSxDQUFBO1FBQ2hDLENBQUM7UUFFRCxtREFBbUQ7UUFFbkQ7O1dBRUc7UUFDSCxLQUFLLENBQUMsVUFBVSxDQUNkLFFBQWEsRUFDYixPQUFrRDtZQUVsRCxNQUFNLFNBQVMsR0FBcUI7Z0JBQ2xDLFNBQVMsRUFBRSxRQUFRO2dCQUNuQixJQUFJLEVBQUUsT0FBTyxFQUFFLFFBQVEsSUFBSSxVQUFVLElBQUksQ0FBQyxHQUFHLEVBQUUsRUFBRTtnQkFDakQsSUFBSSxFQUFFLFFBQVE7Z0JBQ2QsT0FBTyxFQUFFO29CQUNQLFFBQVEsRUFBRSxPQUFPLEVBQUUsUUFBUTtpQkFDNUI7YUFDRixDQUFBO1lBRUQsTUFBTSxPQUFPLEdBQWU7Z0JBQzFCLEVBQUUsRUFBRSxlQUFlLElBQUksQ0FBQyxHQUFHLEVBQUUsRUFBRTtnQkFDL0IsT0FBTyxFQUFFLEtBQUs7Z0JBQ2QsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsTUFBTSxFQUFFLGFBQWE7Z0JBQ3JCLE9BQU8sRUFBRSxTQUFTO2dCQUNsQixRQUFRLEVBQUU7b0JBQ1IsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO29CQUNyQixNQUFNLEVBQUUsc0JBQXNCO29CQUM5QixRQUFRLEVBQUUsUUFBUTtpQkFDbkI7Z0JBQ0QsUUFBUSxFQUFFO29CQUNSLFdBQVcsRUFBRSxDQUFDLGFBQWEsQ0FBQztpQkFDN0I7YUFDRixDQUFBO1lBRUQsTUFBTSxRQUFRLEdBQUcsTUFBTSx5QkFBVyxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQTtZQUN2RCxPQUFPLFFBQVEsQ0FBQTtRQUNqQixDQUFDO1FBRUQ7O1dBRUc7UUFDSCxLQUFLLENBQUMsWUFBWSxDQUFDLE1BQWM7WUFDL0IsTUFBTSxTQUFTLEdBQXFCO2dCQUNsQyxTQUFTLEVBQUUsVUFBVTtnQkFDckIsSUFBSSxFQUFFLE1BQU07YUFDYixDQUFBO1lBRUQsTUFBTSxPQUFPLEdBQWU7Z0JBQzFCLEVBQUUsRUFBRSxpQkFBaUIsSUFBSSxDQUFDLEdBQUcsRUFBRSxFQUFFO2dCQUNqQyxPQUFPLEVBQUUsS0FBSztnQkFDZCxJQUFJLEVBQUUsU0FBUztnQkFDZixNQUFNLEVBQUUsZUFBZTtnQkFDdkIsT0FBTyxFQUFFLFNBQVM7Z0JBQ2xCLFFBQVEsRUFBRTtvQkFDUixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7b0JBQ3JCLE1BQU0sRUFBRSxzQkFBc0I7b0JBQzlCLFFBQVEsRUFBRSxRQUFRO2lCQUNuQjtnQkFDRCxRQUFRLEVBQUU7b0JBQ1IsV0FBVyxFQUFFLENBQUMsZUFBZSxDQUFDO2lCQUMvQjthQUNGLENBQUE7WUFFRCxNQUFNLFFBQVEsR0FBRyxNQUFNLHlCQUFXLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFBO1lBQ3ZELE9BQU8sUUFBUSxFQUFFLElBQUksQ0FBQTtRQUN2QixDQUFDO1FBRUQsbURBQW1EO1FBRW5EOztXQUVHO1FBQ0gsS0FBSyxDQUFDLDBCQUEwQixDQUFDLE9BQWUsRUFBRSxNQUFjLEVBQUUsT0FBWTtZQUM1RSxNQUFNLE9BQU8sR0FBZTtnQkFDMUIsRUFBRSxFQUFFLGlCQUFpQixJQUFJLENBQUMsR0FBRyxFQUFFLEVBQUU7Z0JBQ2pDLE9BQU8sRUFBRSxLQUFLO2dCQUNkLElBQUksRUFBRSxTQUFTO2dCQUNmLE1BQU0sRUFBRSxvQkFBb0I7Z0JBQzVCLE9BQU8sRUFBRTtvQkFDUCxPQUFPO29CQUNQLE1BQU07b0JBQ04sT0FBTztvQkFDUCxPQUFPLEVBQUU7d0JBQ1AsS0FBSyxFQUFFLElBQUk7d0JBQ1gsUUFBUSxFQUFFLE1BQU07cUJBQ2pCO2lCQUNGO2dCQUNELFFBQVEsRUFBRTtvQkFDUixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7b0JBQ3JCLE1BQU0sRUFBRSxtQkFBbUI7b0JBQzNCLFFBQVEsRUFBRSxNQUFNO2lCQUNqQjtnQkFDRCxRQUFRLEVBQUU7b0JBQ1IsV0FBVyxFQUFFLENBQUMsb0JBQW9CLENBQUM7aUJBQ3BDO2FBQ0YsQ0FBQTtZQUVELE1BQU0sUUFBUSxHQUFHLE1BQU0seUJBQVcsQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUE7WUFDdkQsT0FBTyxRQUFRLEVBQUUsTUFBTSxJQUFJLE9BQU8sQ0FBQyxFQUFFLENBQUE7UUFDdkMsQ0FBQztRQUVEOztXQUVHO1FBQ0gsS0FBSyxDQUFDLHlCQUF5QixDQUM3QixlQUF1QixFQUN2QixRQUFrQixFQUNsQixJQUFTO1lBRVQsTUFBTSxPQUFPLEdBQWU7Z0JBQzFCLEVBQUUsRUFBRSxpQkFBaUIsSUFBSSxDQUFDLEdBQUcsRUFBRSxFQUFFO2dCQUNqQyxPQUFPLEVBQUUsS0FBSztnQkFDZCxJQUFJLEVBQUUsU0FBUztnQkFDZixNQUFNLEVBQUUsbUJBQW1CO2dCQUMzQixPQUFPLEVBQUU7b0JBQ1AsZUFBZTtvQkFDZixRQUFRO29CQUNSLElBQUk7b0JBQ0osUUFBUSxFQUFFLFVBQVUsRUFBRSxPQUFPO2lCQUM5QjtnQkFDRCxRQUFRLEVBQUU7b0JBQ1IsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO29CQUNyQixNQUFNLEVBQUUsdUJBQXVCO29CQUMvQixRQUFRLEVBQUUsUUFBUTtpQkFDbkI7Z0JBQ0QsUUFBUSxFQUFFO29CQUNSLFdBQVcsRUFBRSxDQUFDLG1CQUFtQixDQUFDO2lCQUNuQzthQUNGLENBQUE7WUFFRCxNQUFNLFFBQVEsR0FBRyxNQUFNLHlCQUFXLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFBO1lBQ3ZELE9BQU8sUUFBUSxFQUFFLGVBQWUsSUFBSSxlQUFlLENBQUE7UUFDckQsQ0FBQztRQUVEOztXQUVHO1FBQ0gsS0FBSyxDQUFDLG9CQUFvQixDQUFDLFNBQWlCLEVBQUUsU0FBYztZQUMxRCxNQUFNLE9BQU8sR0FBZTtnQkFDMUIsRUFBRSxFQUFFLGdCQUFnQixJQUFJLENBQUMsR0FBRyxFQUFFLEVBQUU7Z0JBQ2hDLE9BQU8sRUFBRSxLQUFLO2dCQUNkLElBQUksRUFBRSxPQUFPO2dCQUNiLE1BQU0sRUFBRSxVQUFVLFNBQVMsRUFBRTtnQkFDN0IsT0FBTyxFQUFFLFNBQVM7Z0JBQ2xCLFFBQVEsRUFBRTtvQkFDUixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7b0JBQ3JCLE1BQU0sRUFBRSxRQUFRO29CQUNoQixRQUFRLEVBQUUsUUFBUTtpQkFDbkI7Z0JBQ0QsUUFBUSxFQUFFO29CQUNSLFdBQVcsRUFBRSxDQUFDLGtCQUFrQixDQUFDO2lCQUNsQzthQUNGLENBQUE7WUFFRCxNQUFNLHlCQUFXLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFBO1FBQ3hDLENBQUM7UUFFRCxpREFBaUQ7UUFFakQ7O1dBRUc7UUFDSCxxQkFBcUIsQ0FBQyxVQUFtQjtZQUN2QyxPQUFPLHlCQUFXLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFBO1FBQzlDLENBQUM7UUFFRDs7V0FFRztRQUNILGdCQUFnQixDQUFDLFFBQXFCO1lBQ3BDLHlCQUFXLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLENBQUE7WUFDdEMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsYUFBYSxRQUFRLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQTtRQUM3QyxDQUFDO1FBRUQ7O1dBRUc7UUFDSCxrQkFBa0IsQ0FBQyxVQUFrQjtZQUNuQyx5QkFBVyxDQUFDLGtCQUFrQixDQUFDLFVBQVUsQ0FBQyxDQUFBO1lBQzFDLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLFVBQVUsVUFBVSxFQUFFLENBQUMsQ0FBQTtRQUN6QyxDQUFDO1FBRUQsa0RBQWtEO1FBRWxEOztXQUVHO1FBQ0gsZ0JBQWdCO1lBQ2QsT0FBTyx5QkFBVyxDQUFDLFFBQVEsRUFBRSxDQUFBO1FBQy9CLENBQUM7UUFFRDs7V0FFRztRQUNILEtBQUssQ0FBQyxXQUFXO1lBQ2YsSUFBSSxDQUFDO2dCQUNILE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFBO2dCQUNyQyxPQUFPO29CQUNMLE1BQU0sRUFBRSxTQUFTO29CQUNqQixPQUFPLEVBQUUsS0FBSztpQkFDZixDQUFBO1lBQ0gsQ0FBQztZQUFDLE9BQU8sS0FBVSxFQUFFLENBQUM7Z0JBQ3BCLE9BQU87b0JBQ0wsTUFBTSxFQUFFLE9BQU87b0JBQ2YsT0FBTyxFQUFFLEtBQUssQ0FBQyxPQUFPO2lCQUN2QixDQUFBO1lBQ0gsQ0FBQztRQUNILENBQUM7UUFFRDs7V0FFRztRQUNILEtBQUssQ0FBQyxtQkFBbUI7WUFDdkIsZ0JBQWdCO1lBQ2hCLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxDQUFBO1FBQ2hDLENBQUM7Ozs7QUEvZ0JVLGdEQUFrQiIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXDE2NjYzXFxEZXNrdG9wXFx0dWhlZ1xccGFja2FnZXNcXGNvbW1vbi1iYWNrZW5kXFxzcmNcXHZjcFxcdmNwLXByb3RvY29sLnNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVkNQ5Y2P6K6u5qC45b+D5pyN5Yqh6ZuG5oiQXG4vLyDpm4bmiJAgVkNQVG9vbEJveCDnmoTnu5/kuIDkuqTkupLmoIflh4bliLDliJvkuJbmmJ/njq9cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuaW1wb3J0IHsgSW5qZWN0YWJsZSwgTG9nZ2VyLCB0eXBlIE9uTW9kdWxlSW5pdCB9IGZyb20gJ0BuZXN0anMvY29tbW9uJ1xuaW1wb3J0IHsgQ29uZmlnU2VydmljZSB9IGZyb20gJ0BuZXN0anMvY29uZmlnJ1xuaW1wb3J0IHtcbiAgdHlwZSBWQ1BFbmRwb2ludCxcbiAgdHlwZSBWQ1BGaWxlT3BlcmF0aW9uLFxuICB0eXBlIFZDUE1lbW9yeU9wZXJhdGlvbixcbiAgdHlwZSBWQ1BNZXNzYWdlLFxuICB0eXBlIFZDUFRvb2xSZXF1ZXN0LFxuICB0eXBlIFZDUFRvb2xSZXNwb25zZSxcbiAgdmNwUHJvdG9jb2wsXG59IGZyb20gJy4uLy4uLy4uL2FwcHMvdmNwdG9vbGJveC9zcmMvbW9kdWxlcy9jb21tdW5pY2F0aW9uL1ZDUFByb3RvY29sJ1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgVkNQUHJvdG9jb2xTZXJ2aWNlIGltcGxlbWVudHMgT25Nb2R1bGVJbml0IHtcbiAgcHJpdmF0ZSByZWFkb25seSBsb2dnZXIgPSBuZXcgTG9nZ2VyKFZDUFByb3RvY29sU2VydmljZS5uYW1lKVxuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgY29uZmlnU2VydmljZTogQ29uZmlnU2VydmljZSkge31cblxuICBhc3luYyBvbk1vZHVsZUluaXQoKSB7XG4gICAgYXdhaXQgdGhpcy5pbml0aWFsaXplVkNQUHJvdG9jb2woKVxuICAgIHRoaXMuc2V0dXBQcm90b2NvbEhhbmRsZXJzKClcbiAgICB0aGlzLnJlZ2lzdGVyU3lzdGVtRW5kcG9pbnRzKClcbiAgICB0aGlzLmxvZ2dlci5sb2coJ1ZDUOWNj+iuruacjeWKoeW3suWIneWni+WMlicpXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PSDljY/orq7liJ3lp4vljJYgPT09PT09PT09PT09PT09PT09PT1cblxuICAvKipcbiAgICog5Yid5aeL5YyWVkNQ5Y2P6K6uXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGluaXRpYWxpemVWQ1BQcm90b2NvbCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyDorr7nva7ljY/orq7kuovku7bnm5HlkKzlmahcbiAgICB2Y3BQcm90b2NvbC5vbignbWVzc2FnZScsIChtZXNzYWdlOiBWQ1BNZXNzYWdlKSA9PiB7XG4gICAgICB0aGlzLmxvZ2dlci5kZWJ1ZyhgVkNQ5raI5oGv5o6l5pS2OiAke21lc3NhZ2UuYWN0aW9ufWApXG4gICAgfSlcblxuICAgIHZjcFByb3RvY29sLm9uKCdlcnJvcicsIChlcnJvcjogRXJyb3IpID0+IHtcbiAgICAgIHRoaXMubG9nZ2VyLmVycm9yKCdWQ1DljY/orq7plJnor686JywgZXJyb3IpXG4gICAgfSlcblxuICAgIHRoaXMubG9nZ2VyLmxvZygnVkNQ5Y2P6K6u5qC45b+D5bey5Yid5aeL5YyWJylcbiAgfVxuXG4gIC8qKlxuICAgKiDorr7nva7ljY/orq7lpITnkIblmahcbiAgICovXG4gIHByaXZhdGUgc2V0dXBQcm90b2NvbEhhbmRsZXJzKCk6IHZvaWQge1xuICAgIC8vIOiuoumYhemHjeimgeeahOWNj+iuruS6i+S7tlxuICAgIHZjcFByb3RvY29sLnN1YnNjcmliZSgndG9vbC5leGVjdXRpb24nLCAobWVzc2FnZTogVkNQTWVzc2FnZSkgPT4ge1xuICAgICAgdGhpcy5oYW5kbGVUb29sRXhlY3V0aW9uRXZlbnQobWVzc2FnZSlcbiAgICB9KVxuXG4gICAgdmNwUHJvdG9jb2wuc3Vic2NyaWJlKCdhZ2VudC5jb2xsYWJvcmF0aW9uJywgKG1lc3NhZ2U6IFZDUE1lc3NhZ2UpID0+IHtcbiAgICAgIHRoaXMuaGFuZGxlQWdlbnRDb2xsYWJvcmF0aW9uRXZlbnQobWVzc2FnZSlcbiAgICB9KVxuXG4gICAgdmNwUHJvdG9jb2wuc3Vic2NyaWJlKCduYXJyYXRpdmUuZ2VuZXJhdGlvbicsIChtZXNzYWdlOiBWQ1BNZXNzYWdlKSA9PiB7XG4gICAgICB0aGlzLmhhbmRsZU5hcnJhdGl2ZUdlbmVyYXRpb25FdmVudChtZXNzYWdlKVxuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICog5rOo5YaM57O757uf56uv54K5XG4gICAqL1xuICBwcml2YXRlIHJlZ2lzdGVyU3lzdGVtRW5kcG9pbnRzKCk6IHZvaWQge1xuICAgIC8vIOazqOWGjEFJ5pyN5Yqh56uv54K5XG4gICAgdmNwUHJvdG9jb2wucmVnaXN0ZXJFbmRwb2ludCh7XG4gICAgICBpZDogJ2FpLXNlcnZpY2UnLFxuICAgICAgdHlwZTogJ3NlcnZpY2UnLFxuICAgICAgdXJsOiAnaW50ZXJuYWw6Ly9haS1zZXJ2aWNlJyxcbiAgICAgIGNhcGFiaWxpdGllczogWyd0ZXh0LWdlbmVyYXRpb24nLCAnaW1hZ2UtZ2VuZXJhdGlvbicsICdhbmFseXNpcyddLFxuICAgICAgc3RhdHVzOiAnb25saW5lJyxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQUnmnI3liqHnq6/ngrknLFxuICAgICAgICBhdXRob3I6ICdzeXN0ZW0nLFxuICAgICAgICBsYXN0U2VlbjogbmV3IERhdGUoKSxcbiAgICAgIH0sXG4gICAgfSlcblxuICAgIC8vIOazqOWGjOiusOW/huacjeWKoeerr+eCuVxuICAgIHZjcFByb3RvY29sLnJlZ2lzdGVyRW5kcG9pbnQoe1xuICAgICAgaWQ6ICdtZW1vcnktc2VydmljZScsXG4gICAgICB0eXBlOiAnc2VydmljZScsXG4gICAgICB1cmw6ICdpbnRlcm5hbDovL21lbW9yeS1zZXJ2aWNlJyxcbiAgICAgIGNhcGFiaWxpdGllczogWydtZW1vcnktcmVhZCcsICdtZW1vcnktd3JpdGUnLCAnbWVtb3J5LXNlYXJjaCddLFxuICAgICAgc3RhdHVzOiAnb25saW5lJyxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAn6K6w5b+G5pyN5Yqh56uv54K5JyxcbiAgICAgICAgYXV0aG9yOiAnc3lzdGVtJyxcbiAgICAgICAgbGFzdFNlZW46IG5ldyBEYXRlKCksXG4gICAgICB9LFxuICAgIH0pXG5cbiAgICAvLyDms6jlhozmlofku7bmnI3liqHnq6/ngrlcbiAgICB2Y3BQcm90b2NvbC5yZWdpc3RlckVuZHBvaW50KHtcbiAgICAgIGlkOiAnZmlsZS1zZXJ2aWNlJyxcbiAgICAgIHR5cGU6ICdzZXJ2aWNlJyxcbiAgICAgIHVybDogJ2ludGVybmFsOi8vZmlsZS1zZXJ2aWNlJyxcbiAgICAgIGNhcGFiaWxpdGllczogWydmaWxlLXVwbG9hZCcsICdmaWxlLWRvd25sb2FkJywgJ2ZpbGUtbGlzdCddLFxuICAgICAgc3RhdHVzOiAnb25saW5lJyxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAn5paH5Lu25pyN5Yqh56uv54K5JyxcbiAgICAgICAgYXV0aG9yOiAnc3lzdGVtJyxcbiAgICAgICAgbGFzdFNlZW46IG5ldyBEYXRlKCksXG4gICAgICB9LFxuICAgIH0pXG5cbiAgICB0aGlzLmxvZ2dlci5sb2coJ+ezu+e7n+err+eCueW3suazqOWGjCcpXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PSDkuovku7blpITnkIblmaggPT09PT09PT09PT09PT09PT09PT1cblxuICAvKipcbiAgICog5aSE55CG5bel5YW35omn6KGM5LqL5Lu2XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZVRvb2xFeGVjdXRpb25FdmVudChtZXNzYWdlOiBWQ1BNZXNzYWdlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgeyB0b29sSWQsIHN0YXR1cywgcmVzdWx0IH0gPSBtZXNzYWdlLnBheWxvYWRcbiAgICB0aGlzLmxvZ2dlci5kZWJ1Zyhg5bel5YW35omn6KGM5LqL5Lu2OiAke3Rvb2xJZH0gLSAke3N0YXR1c31gKVxuXG4gICAgLy8g5Y+v5Lul5Zyo6L+Z6YeM5re75Yqg55uR5o6n44CB5pel5b+X6K6w5b2V562JXG4gICAgaWYgKHN0YXR1cyA9PT0gJ2Vycm9yJykge1xuICAgICAgdGhpcy5sb2dnZXIud2Fybihg5bel5YW35omn6KGM5aSx6LSlOiAke3Rvb2xJZH1gLCByZXN1bHQpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhkFnZW505Y2P5L2c5LqL5Lu2XG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZUFnZW50Q29sbGFib3JhdGlvbkV2ZW50KG1lc3NhZ2U6IFZDUE1lc3NhZ2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB7IGFnZW50SWQsIGFjdGlvbiwgY29udGV4dCB9ID0gbWVzc2FnZS5wYXlsb2FkXG4gICAgdGhpcy5sb2dnZXIuZGVidWcoYEFnZW505Y2P5L2c5LqL5Lu2OiAke2FnZW50SWR9IC0gJHthY3Rpb259YClcblxuICAgIC8vIOWkhOeQhuWNj+S9nOebuOWFs+eahOmAu+i+kVxuICB9XG5cbiAgLyoqXG4gICAqIOWkhOeQhuWPmeS6i+eUn+aIkOS6i+S7tlxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVOYXJyYXRpdmVHZW5lcmF0aW9uRXZlbnQobWVzc2FnZTogVkNQTWVzc2FnZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHsgc3RvcnlJZCwgcHJvZ3Jlc3MsIHN0YXR1cyB9ID0gbWVzc2FnZS5wYXlsb2FkXG4gICAgdGhpcy5sb2dnZXIuZGVidWcoYOWPmeS6i+eUn+aIkOS6i+S7tjogJHtzdG9yeUlkfSAtICR7cHJvZ3Jlc3N9JSAtICR7c3RhdHVzfWApXG5cbiAgICAvLyDlpITnkIblj5nkuovnlJ/miJDov5vluqZcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09IOW3peWFt+mbhuaIkOaOpeWPoyA9PT09PT09PT09PT09PT09PT09PVxuXG4gIC8qKlxuICAgKiDosIPnlKhBSeeUn+aIkOW3peWFt1xuICAgKi9cbiAgYXN5bmMgY2FsbEFJR2VuZXJhdGlvblRvb2woXG4gICAgcHJvbXB0OiBzdHJpbmcsXG4gICAgb3B0aW9uczoge1xuICAgICAgbW9kZWw/OiBzdHJpbmdcbiAgICAgIHRlbXBlcmF0dXJlPzogbnVtYmVyXG4gICAgICBtYXhUb2tlbnM/OiBudW1iZXJcbiAgICAgIHR5cGU/OiAndGV4dCcgfCAnaW1hZ2UnIHwgJ2F1ZGlvJ1xuICAgIH0gPSB7fVxuICApOiBQcm9taXNlPFZDUFRvb2xSZXNwb25zZT4ge1xuICAgIGNvbnN0IHJlcXVlc3Q6IFZDUFRvb2xSZXF1ZXN0ID0ge1xuICAgICAgdG9vbElkOiBvcHRpb25zLnR5cGUgPT09ICdpbWFnZScgPyAnaW1hZ2UtZ2VuZXJhdG9yJyA6ICd0ZXh0LWdlbmVyYXRvcicsXG4gICAgICBhY3Rpb246ICdnZW5lcmF0ZScsXG4gICAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAgIHByb21wdCxcbiAgICAgICAgbW9kZWw6IG9wdGlvbnMubW9kZWwgfHwgJ2dwdC00JyxcbiAgICAgICAgdGVtcGVyYXR1cmU6IG9wdGlvbnMudGVtcGVyYXR1cmUgfHwgMC43LFxuICAgICAgICBtYXhUb2tlbnM6IG9wdGlvbnMubWF4VG9rZW5zIHx8IDEwMDAsXG4gICAgICB9LFxuICAgICAgb3B0aW9uczoge1xuICAgICAgICB0aW1lb3V0OiA2MDAwMCwgLy8gNjDnp5LotoXml7ZcbiAgICAgICAgYXN5bmM6IHRydWUsXG4gICAgICB9LFxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHZjcFByb3RvY29sLmNhbGxUb29sKHJlcXVlc3QpXG4gICAgICB0aGlzLmxvZ2dlci5sb2coYEFJ5bel5YW36LCD55So5oiQ5YqfOiAke3JlcXVlc3QudG9vbElkfWApXG4gICAgICByZXR1cm4gcmVzcG9uc2VcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihgQUnlt6XlhbfosIPnlKjlpLHotKU6ICR7cmVxdWVzdC50b29sSWR9YCwgZXJyb3IpXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDosIPnlKjliIbmnpDlt6XlhbdcbiAgICovXG4gIGFzeW5jIGNhbGxBbmFseXNpc1Rvb2woY29udGVudDogc3RyaW5nLCBhbmFseXNpc1R5cGU6IHN0cmluZyk6IFByb21pc2U8VkNQVG9vbFJlc3BvbnNlPiB7XG4gICAgY29uc3QgcmVxdWVzdDogVkNQVG9vbFJlcXVlc3QgPSB7XG4gICAgICB0b29sSWQ6ICdjb250ZW50LWFuYWx5emVyJyxcbiAgICAgIGFjdGlvbjogJ2FuYWx5emUnLFxuICAgICAgcGFyYW1ldGVyczoge1xuICAgICAgICBjb250ZW50LFxuICAgICAgICB0eXBlOiBhbmFseXNpc1R5cGUsXG4gICAgICB9LFxuICAgICAgb3B0aW9uczoge1xuICAgICAgICB0aW1lb3V0OiAzMDAwMCxcbiAgICAgICAgYXN5bmM6IGZhbHNlLFxuICAgICAgfSxcbiAgICB9XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHZjcFByb3RvY29sLmNhbGxUb29sKHJlcXVlc3QpXG4gICAgdGhpcy5sb2dnZXIubG9nKGDliIbmnpDlt6XlhbfosIPnlKjmiJDlip86ICR7YW5hbHlzaXNUeXBlfWApXG4gICAgcmV0dXJuIHJlc3BvbnNlXG4gIH1cblxuICAvKipcbiAgICog6LCD55So57+76K+R5bel5YW3XG4gICAqL1xuICBhc3luYyBjYWxsVHJhbnNsYXRpb25Ub29sKHRleHQ6IHN0cmluZywgdGFyZ2V0TGFuZ3VhZ2U6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgcmVxdWVzdDogVkNQVG9vbFJlcXVlc3QgPSB7XG4gICAgICB0b29sSWQ6ICd0cmFuc2xhdG9yJyxcbiAgICAgIGFjdGlvbjogJ3RyYW5zbGF0ZScsXG4gICAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAgIHRleHQsXG4gICAgICAgIHRhcmdldExhbmd1YWdlLFxuICAgICAgfSxcbiAgICB9XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHZjcFByb3RvY29sLmNhbGxUb29sKHJlcXVlc3QpXG4gICAgcmV0dXJuIHJlc3BvbnNlLnJlc3VsdD8udHJhbnNsYXRlZFRleHQgfHwgdGV4dFxuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT0g6K6w5b+G5pON5L2c5o6l5Y+jID09PT09PT09PT09PT09PT09PT09XG5cbiAgLyoqXG4gICAqIOivu+WPluiusOW/hlxuICAgKi9cbiAgYXN5bmMgcmVhZE1lbW9yeShrZXk6IHN0cmluZywgc2NvcGU6ICdhZ2VudCcgfCAnc2Vzc2lvbicgfCAnZ2xvYmFsJyA9ICdnbG9iYWwnKTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCBvcGVyYXRpb246IFZDUE1lbW9yeU9wZXJhdGlvbiA9IHtcbiAgICAgIG9wZXJhdGlvbjogJ3JlYWQnLFxuICAgICAgc2NvcGUsXG4gICAgICBwYXJhbWV0ZXJzOiB7IGtleSB9LFxuICAgIH1cblxuICAgIGNvbnN0IG1lc3NhZ2U6IFZDUE1lc3NhZ2UgPSB7XG4gICAgICBpZDogYG1lbW9yeS1yZWFkLSR7RGF0ZS5ub3coKX1gLFxuICAgICAgdmVyc2lvbjogJzEuMCcsXG4gICAgICB0eXBlOiAncmVxdWVzdCcsXG4gICAgICBhY3Rpb246ICdtZW1vcnkucmVhZCcsXG4gICAgICBwYXlsb2FkOiBvcGVyYXRpb24sXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIHNvdXJjZTogJ3ZjcC1wcm90b2NvbC1zZXJ2aWNlJyxcbiAgICAgICAgcHJpb3JpdHk6ICdub3JtYWwnLFxuICAgICAgfSxcbiAgICAgIHNlY3VyaXR5OiB7XG4gICAgICAgIHBlcm1pc3Npb25zOiBbJ21lbW9yeS5yZWFkJ10sXG4gICAgICB9LFxuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdmNwUHJvdG9jb2wuc2VuZE1lc3NhZ2UobWVzc2FnZSlcbiAgICByZXR1cm4gcmVzcG9uc2VcbiAgfVxuXG4gIC8qKlxuICAgKiDlhpnlhaXorrDlv4ZcbiAgICovXG4gIGFzeW5jIHdyaXRlTWVtb3J5KFxuICAgIGtleTogc3RyaW5nLFxuICAgIHZhbHVlOiBhbnksXG4gICAgc2NvcGU6ICdhZ2VudCcgfCAnc2Vzc2lvbicgfCAnZ2xvYmFsJyA9ICdnbG9iYWwnXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IG9wZXJhdGlvbjogVkNQTWVtb3J5T3BlcmF0aW9uID0ge1xuICAgICAgb3BlcmF0aW9uOiAnd3JpdGUnLFxuICAgICAgc2NvcGUsXG4gICAgICBwYXJhbWV0ZXJzOiB7IGtleSwgdmFsdWUgfSxcbiAgICB9XG5cbiAgICBjb25zdCBtZXNzYWdlOiBWQ1BNZXNzYWdlID0ge1xuICAgICAgaWQ6IGBtZW1vcnktd3JpdGUtJHtEYXRlLm5vdygpfWAsXG4gICAgICB2ZXJzaW9uOiAnMS4wJyxcbiAgICAgIHR5cGU6ICdyZXF1ZXN0JyxcbiAgICAgIGFjdGlvbjogJ21lbW9yeS53cml0ZScsXG4gICAgICBwYXlsb2FkOiBvcGVyYXRpb24sXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIHNvdXJjZTogJ3ZjcC1wcm90b2NvbC1zZXJ2aWNlJyxcbiAgICAgICAgcHJpb3JpdHk6ICdub3JtYWwnLFxuICAgICAgfSxcbiAgICAgIHNlY3VyaXR5OiB7XG4gICAgICAgIHBlcm1pc3Npb25zOiBbJ21lbW9yeS53cml0ZSddLFxuICAgICAgfSxcbiAgICB9XG5cbiAgICBhd2FpdCB2Y3BQcm90b2NvbC5zZW5kTWVzc2FnZShtZXNzYWdlKVxuICB9XG5cbiAgLyoqXG4gICAqIOaQnOe0ouiusOW/hlxuICAgKi9cbiAgYXN5bmMgc2VhcmNoTWVtb3J5KHF1ZXJ5OiBzdHJpbmcsIHRhZ3M/OiBzdHJpbmdbXSk6IFByb21pc2U8YW55W10+IHtcbiAgICBjb25zdCBvcGVyYXRpb246IFZDUE1lbW9yeU9wZXJhdGlvbiA9IHtcbiAgICAgIG9wZXJhdGlvbjogJ3NlYXJjaCcsXG4gICAgICBzY29wZTogJ2dsb2JhbCcsXG4gICAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAgIHF1ZXJ5LFxuICAgICAgICB0YWdzLFxuICAgICAgICBsaW1pdDogMTAsXG4gICAgICB9LFxuICAgIH1cblxuICAgIGNvbnN0IG1lc3NhZ2U6IFZDUE1lc3NhZ2UgPSB7XG4gICAgICBpZDogYG1lbW9yeS1zZWFyY2gtJHtEYXRlLm5vdygpfWAsXG4gICAgICB2ZXJzaW9uOiAnMS4wJyxcbiAgICAgIHR5cGU6ICdyZXF1ZXN0JyxcbiAgICAgIGFjdGlvbjogJ21lbW9yeS5zZWFyY2gnLFxuICAgICAgcGF5bG9hZDogb3BlcmF0aW9uLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICBzb3VyY2U6ICd2Y3AtcHJvdG9jb2wtc2VydmljZScsXG4gICAgICAgIHByaW9yaXR5OiAnbm9ybWFsJyxcbiAgICAgIH0sXG4gICAgICBzZWN1cml0eToge1xuICAgICAgICBwZXJtaXNzaW9uczogWydtZW1vcnkucmVhZCddLFxuICAgICAgfSxcbiAgICB9XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHZjcFByb3RvY29sLnNlbmRNZXNzYWdlKG1lc3NhZ2UpXG4gICAgcmV0dXJuIHJlc3BvbnNlPy5yZXN1bHRzIHx8IFtdXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PSDmlofku7bmk43kvZzmjqXlj6MgPT09PT09PT09PT09PT09PT09PT1cblxuICAvKipcbiAgICog5LiK5Lyg5paH5Lu2XG4gICAqL1xuICBhc3luYyB1cGxvYWRGaWxlKFxuICAgIGZpbGVEYXRhOiBhbnksXG4gICAgb3B0aW9ucz86IHsgbWltZVR5cGU/OiBzdHJpbmc7IGZpbGVuYW1lPzogc3RyaW5nIH1cbiAgKTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCBvcGVyYXRpb246IFZDUEZpbGVPcGVyYXRpb24gPSB7XG4gICAgICBvcGVyYXRpb246ICd1cGxvYWQnLFxuICAgICAgcGF0aDogb3B0aW9ucz8uZmlsZW5hbWUgfHwgYHVwbG9hZC0ke0RhdGUubm93KCl9YCxcbiAgICAgIGRhdGE6IGZpbGVEYXRhLFxuICAgICAgb3B0aW9uczoge1xuICAgICAgICBtaW1lVHlwZTogb3B0aW9ucz8ubWltZVR5cGUsXG4gICAgICB9LFxuICAgIH1cblxuICAgIGNvbnN0IG1lc3NhZ2U6IFZDUE1lc3NhZ2UgPSB7XG4gICAgICBpZDogYGZpbGUtdXBsb2FkLSR7RGF0ZS5ub3coKX1gLFxuICAgICAgdmVyc2lvbjogJzEuMCcsXG4gICAgICB0eXBlOiAncmVxdWVzdCcsXG4gICAgICBhY3Rpb246ICdmaWxlLnVwbG9hZCcsXG4gICAgICBwYXlsb2FkOiBvcGVyYXRpb24sXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIHNvdXJjZTogJ3ZjcC1wcm90b2NvbC1zZXJ2aWNlJyxcbiAgICAgICAgcHJpb3JpdHk6ICdub3JtYWwnLFxuICAgICAgfSxcbiAgICAgIHNlY3VyaXR5OiB7XG4gICAgICAgIHBlcm1pc3Npb25zOiBbJ2ZpbGUudXBsb2FkJ10sXG4gICAgICB9LFxuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdmNwUHJvdG9jb2wuc2VuZE1lc3NhZ2UobWVzc2FnZSlcbiAgICByZXR1cm4gcmVzcG9uc2VcbiAgfVxuXG4gIC8qKlxuICAgKiDkuIvovb3mlofku7ZcbiAgICovXG4gIGFzeW5jIGRvd25sb2FkRmlsZShmaWxlSWQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3Qgb3BlcmF0aW9uOiBWQ1BGaWxlT3BlcmF0aW9uID0ge1xuICAgICAgb3BlcmF0aW9uOiAnZG93bmxvYWQnLFxuICAgICAgcGF0aDogZmlsZUlkLFxuICAgIH1cblxuICAgIGNvbnN0IG1lc3NhZ2U6IFZDUE1lc3NhZ2UgPSB7XG4gICAgICBpZDogYGZpbGUtZG93bmxvYWQtJHtEYXRlLm5vdygpfWAsXG4gICAgICB2ZXJzaW9uOiAnMS4wJyxcbiAgICAgIHR5cGU6ICdyZXF1ZXN0JyxcbiAgICAgIGFjdGlvbjogJ2ZpbGUuZG93bmxvYWQnLFxuICAgICAgcGF5bG9hZDogb3BlcmF0aW9uLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICBzb3VyY2U6ICd2Y3AtcHJvdG9jb2wtc2VydmljZScsXG4gICAgICAgIHByaW9yaXR5OiAnbm9ybWFsJyxcbiAgICAgIH0sXG4gICAgICBzZWN1cml0eToge1xuICAgICAgICBwZXJtaXNzaW9uczogWydmaWxlLmRvd25sb2FkJ10sXG4gICAgICB9LFxuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdmNwUHJvdG9jb2wuc2VuZE1lc3NhZ2UobWVzc2FnZSlcbiAgICByZXR1cm4gcmVzcG9uc2U/LmRhdGFcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09IOWPmeS6i+S4k+eUqOaOpeWPoyA9PT09PT09PT09PT09PT09PT09PVxuXG4gIC8qKlxuICAgKiDlj5HpgIHlj5nkuovnlJ/miJDor7fmsYJcbiAgICovXG4gIGFzeW5jIHJlcXVlc3ROYXJyYXRpdmVHZW5lcmF0aW9uKHN0b3J5SWQ6IHN0cmluZywgcHJvbXB0OiBzdHJpbmcsIGNvbnRleHQ6IGFueSk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgbWVzc2FnZTogVkNQTWVzc2FnZSA9IHtcbiAgICAgIGlkOiBgbmFycmF0aXZlLWdlbi0ke0RhdGUubm93KCl9YCxcbiAgICAgIHZlcnNpb246ICcxLjAnLFxuICAgICAgdHlwZTogJ3JlcXVlc3QnLFxuICAgICAgYWN0aW9uOiAnbmFycmF0aXZlLmdlbmVyYXRlJyxcbiAgICAgIHBheWxvYWQ6IHtcbiAgICAgICAgc3RvcnlJZCxcbiAgICAgICAgcHJvbXB0LFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgYXN5bmM6IHRydWUsXG4gICAgICAgICAgcHJpb3JpdHk6ICdoaWdoJyxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIHNvdXJjZTogJ25hcnJhdGl2ZS1zZXJ2aWNlJyxcbiAgICAgICAgcHJpb3JpdHk6ICdoaWdoJyxcbiAgICAgIH0sXG4gICAgICBzZWN1cml0eToge1xuICAgICAgICBwZXJtaXNzaW9uczogWyduYXJyYXRpdmUuZ2VuZXJhdGUnXSxcbiAgICAgIH0sXG4gICAgfVxuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB2Y3BQcm90b2NvbC5zZW5kTWVzc2FnZShtZXNzYWdlKVxuICAgIHJldHVybiByZXNwb25zZT8udGFza0lkIHx8IG1lc3NhZ2UuaWRcbiAgfVxuXG4gIC8qKlxuICAgKiDlj5HpgIFBZ2VudOWNj+S9nOivt+axglxuICAgKi9cbiAgYXN5bmMgcmVxdWVzdEFnZW50Q29sbGFib3JhdGlvbihcbiAgICBjb2xsYWJvcmF0aW9uSWQ6IHN0cmluZyxcbiAgICBhZ2VudElkczogc3RyaW5nW10sXG4gICAgdGFzazogYW55XG4gICk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgbWVzc2FnZTogVkNQTWVzc2FnZSA9IHtcbiAgICAgIGlkOiBgY29sbGFib3JhdGlvbi0ke0RhdGUubm93KCl9YCxcbiAgICAgIHZlcnNpb246ICcxLjAnLFxuICAgICAgdHlwZTogJ3JlcXVlc3QnLFxuICAgICAgYWN0aW9uOiAnYWdlbnQuY29sbGFib3JhdGUnLFxuICAgICAgcGF5bG9hZDoge1xuICAgICAgICBjb2xsYWJvcmF0aW9uSWQsXG4gICAgICAgIGFnZW50SWRzLFxuICAgICAgICB0YXNrLFxuICAgICAgICBzdHJhdGVneTogJ3BhcmFsbGVsJywgLy8g5bm26KGM5Y2P5L2cXG4gICAgICB9LFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICBzb3VyY2U6ICdjb2xsYWJvcmF0aW9uLXNlcnZpY2UnLFxuICAgICAgICBwcmlvcml0eTogJ25vcm1hbCcsXG4gICAgICB9LFxuICAgICAgc2VjdXJpdHk6IHtcbiAgICAgICAgcGVybWlzc2lvbnM6IFsnYWdlbnQuY29sbGFib3JhdGUnXSxcbiAgICAgIH0sXG4gICAgfVxuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB2Y3BQcm90b2NvbC5zZW5kTWVzc2FnZShtZXNzYWdlKVxuICAgIHJldHVybiByZXNwb25zZT8uY29sbGFib3JhdGlvbklkIHx8IGNvbGxhYm9yYXRpb25JZFxuICB9XG5cbiAgLyoqXG4gICAqIOW5v+aSreezu+e7n+S6i+S7tlxuICAgKi9cbiAgYXN5bmMgYnJvYWRjYXN0U3lzdGVtRXZlbnQoZXZlbnRUeXBlOiBzdHJpbmcsIGV2ZW50RGF0YTogYW55KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgbWVzc2FnZTogVkNQTWVzc2FnZSA9IHtcbiAgICAgIGlkOiBgc3lzdGVtLWV2ZW50LSR7RGF0ZS5ub3coKX1gLFxuICAgICAgdmVyc2lvbjogJzEuMCcsXG4gICAgICB0eXBlOiAnZXZlbnQnLFxuICAgICAgYWN0aW9uOiBgc3lzdGVtLiR7ZXZlbnRUeXBlfWAsXG4gICAgICBwYXlsb2FkOiBldmVudERhdGEsXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgIHNvdXJjZTogJ3N5c3RlbScsXG4gICAgICAgIHByaW9yaXR5OiAnbm9ybWFsJyxcbiAgICAgIH0sXG4gICAgICBzZWN1cml0eToge1xuICAgICAgICBwZXJtaXNzaW9uczogWydzeXN0ZW0uYnJvYWRjYXN0J10sXG4gICAgICB9LFxuICAgIH1cblxuICAgIGF3YWl0IHZjcFByb3RvY29sLnNlbmRNZXNzYWdlKG1lc3NhZ2UpXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PSDnq6/ngrnnrqHnkIYgPT09PT09PT09PT09PT09PT09PT1cblxuICAvKipcbiAgICog6I635Y+W5Y+v55So56uv54K5XG4gICAqL1xuICBnZXRBdmFpbGFibGVFbmRwb2ludHMoY2FwYWJpbGl0eT86IHN0cmluZyk6IFZDUEVuZHBvaW50W10ge1xuICAgIHJldHVybiB2Y3BQcm90b2NvbC5maW5kRW5kcG9pbnRzKGNhcGFiaWxpdHkpXG4gIH1cblxuICAvKipcbiAgICog5rOo5YaM6Ieq5a6a5LmJ56uv54K5XG4gICAqL1xuICByZWdpc3RlckVuZHBvaW50KGVuZHBvaW50OiBWQ1BFbmRwb2ludCk6IHZvaWQge1xuICAgIHZjcFByb3RvY29sLnJlZ2lzdGVyRW5kcG9pbnQoZW5kcG9pbnQpXG4gICAgdGhpcy5sb2dnZXIubG9nKGDoh6rlrprkuYnnq6/ngrnlt7Lms6jlhow6ICR7ZW5kcG9pbnQuaWR9YClcbiAgfVxuXG4gIC8qKlxuICAgKiDms6jplIDnq6/ngrlcbiAgICovXG4gIHVucmVnaXN0ZXJFbmRwb2ludChlbmRwb2ludElkOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB2Y3BQcm90b2NvbC51bnJlZ2lzdGVyRW5kcG9pbnQoZW5kcG9pbnRJZClcbiAgICB0aGlzLmxvZ2dlci5sb2coYOerr+eCueW3suazqOmUgDogJHtlbmRwb2ludElkfWApXG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PSDnm5Hmjqflkoznu5/orqEgPT09PT09PT09PT09PT09PT09PT1cblxuICAvKipcbiAgICog6I635Y+W5Y2P6K6u57uf6K6h5L+h5oGvXG4gICAqL1xuICBnZXRQcm90b2NvbFN0YXRzKCk6IGFueSB7XG4gICAgcmV0dXJuIHZjcFByb3RvY29sLmdldFN0YXRzKClcbiAgfVxuXG4gIC8qKlxuICAgKiDlgaXlurfmo4Dmn6VcbiAgICovXG4gIGFzeW5jIGhlYWx0aENoZWNrKCk6IFByb21pc2U8eyBzdGF0dXM6IHN0cmluZzsgZGV0YWlscz86IGFueSB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHN0YXRzID0gdGhpcy5nZXRQcm90b2NvbFN0YXRzKClcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0YXR1czogJ2hlYWx0aHknLFxuICAgICAgICBkZXRhaWxzOiBzdGF0cyxcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UsXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIOa4heeQhui/h+acn+S7u+WKoVxuICAgKi9cbiAgYXN5bmMgY2xlYW51cEV4cGlyZWRUYXNrcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAvLyDmuIXnkIZWQ1DljY/orq7kuK3nmoTov4fmnJ/ku7vliqFcbiAgICB0aGlzLmxvZ2dlci5sb2coJ1ZDUOWNj+iuruS7u+WKoea4heeQhuWujOaIkCcpXG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==