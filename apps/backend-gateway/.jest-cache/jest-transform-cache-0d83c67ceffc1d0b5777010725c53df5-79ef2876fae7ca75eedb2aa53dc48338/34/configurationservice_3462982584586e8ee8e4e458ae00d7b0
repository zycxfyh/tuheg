dbf9914d6a2f9f302b35b3c55f7b3163
"use strict";
// 文件路径: packages/common-backend/src/config/configuration.service.ts
// 核心理念: 类型安全的配置服务，提供便捷的配置访问接口
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.ConfigurationService = void 0;
const common_1 = require("@nestjs/common");
/**
 * @class ConfigurationService
 * @description 类型安全的配置服务
 * 提供对所有环境变量的类型安全访问
 */
let ConfigurationService = class ConfigurationService {
    configService;
    constructor(configService) {
        this.configService = configService;
    }
    // --- 数据库配置 ---
    get databaseUrl() {
        return this.configService.get('DATABASE_URL', { infer: true });
    }
    get dbConnectionLimit() {
        return this.configService.get('DB_CONNECTION_LIMIT', { infer: true });
    }
    get dbPoolTimeout() {
        return this.configService.get('DB_POOL_TIMEOUT', { infer: true });
    }
    get dbIdleTimeout() {
        return this.configService.get('DB_IDLE_TIMEOUT', { infer: true });
    }
    // --- Redis 配置 ---
    get redisUrl() {
        return this.configService.get('REDIS_URL', { infer: true });
    }
    get redisHost() {
        return this.configService.get('REDIS_HOST', { infer: true });
    }
    get redisPort() {
        return this.configService.get('REDIS_PORT', { infer: true });
    }
    // --- 加密配置 ---
    get encryptionKey() {
        return this.configService.get('ENCRYPTION_KEY', { infer: true });
    }
    get encryptionSalt() {
        return this.configService.get('ENCRYPTION_SALT', { infer: true });
    }
    get encryptionUseSalt() {
        return this.configService.get('ENCRYPTION_USE_SALT', { infer: true });
    }
    get encryptionAlgorithm() {
        return this.configService.get('ENCRYPTION_ALGORITHM', { infer: true });
    }
    // --- Sentry 配置 ---
    get sentryDsn() {
        return this.configService.get('SENTRY_DSN', { infer: true });
    }
    get sentryEnvironment() {
        return this.configService.get('SENTRY_ENVIRONMENT', { infer: true });
    }
    get sentryTracesSampleRate() {
        return this.configService.get('SENTRY_TRACES_SAMPLE_RATE', { infer: true });
    }
    // --- AI Provider 配置 ---
    get fallbackApiKey() {
        return this.configService.get('FALLBACK_API_KEY', { infer: true });
    }
    get fallbackModelId() {
        return this.configService.get('FALLBACK_MODEL_ID', { infer: true });
    }
    get fallbackBaseUrl() {
        return this.configService.get('FALLBACK_BASE_URL', { infer: true });
    }
    // --- 应用配置 ---
    get nodeEnv() {
        return this.configService.get('NODE_ENV', { infer: true });
    }
    get port() {
        return this.configService.get('PORT', { infer: true });
    }
    get corsOrigin() {
        return this.configService.get('CORS_ORIGIN', { infer: true });
    }
    // --- Qdrant 配置 ---
    get qdrantUrl() {
        return this.configService.get('QDRANT_URL', { infer: true });
    }
    get qdrantApiKey() {
        return this.configService.get('QDRANT_API_KEY', { infer: true });
    }
    // --- Clerk 配置 ---
    get clerkSecretKey() {
        return this.configService.get('CLERK_SECRET_KEY', { infer: true });
    }
    get clerkPublishableKey() {
        return this.configService.get('CLERK_PUBLISHABLE_KEY', { infer: true });
    }
    get clerkWebhookSecretKey() {
        return this.configService.get('CLERK_WEBHOOK_SECRET_KEY', { infer: true });
    }
    // --- RabbitMQ 配置 ---
    get rabbitmqUrl() {
        return this.configService.get('RABBITMQ_URL', { infer: true });
    }
    // --- JWT 配置 ---
    get jwtSecret() {
        return this.configService.get('JWT_SECRET', { infer: true });
    }
    get jwtExpirationSeconds() {
        return this.configService.get('JWT_EXPIRATION_SECONDS', { infer: true });
    }
    // --- 服务端口配置 ---
    get backendGatewayPort() {
        return this.configService.get('BACKEND_GATEWAY_PORT', { infer: true });
    }
    get creationAgentHttpPort() {
        return this.configService.get('CREATION_AGENT_HTTP_PORT', { infer: true });
    }
    get logicAgentHttpPort() {
        return this.configService.get('LOGIC_AGENT_HTTP_PORT', { infer: true });
    }
    get narrativeAgentHttpPort() {
        return this.configService.get('NARRATIVE_AGENT_HTTP_PORT', { infer: true });
    }
    // --- 便捷方法 ---
    get isDevelopment() {
        return this.nodeEnv === 'development';
    }
    get isProduction() {
        return this.nodeEnv === 'production';
    }
    get isTest() {
        return this.nodeEnv === 'test';
    }
    /**
     * 获取配置值，如果未设置则抛出错误
     */
    getOrThrow(key) {
        return this.configService.getOrThrow(key, { infer: true });
    }
    /**
     * 获取配置值，支持默认值
     */
    get(key, defaultValue) {
        return this.configService.get(key, defaultValue, { infer: true });
    }
};
exports.ConfigurationService = ConfigurationService;
exports.ConfigurationService = ConfigurationService = __decorate([
    (0, common_1.Injectable)(),
    __metadata("design:paramtypes", [Object])
], ConfigurationService);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFwxNjY2M1xcRGVza3RvcFxcdHVoZWdcXHBhY2thZ2VzXFxjb21tb24tYmFja2VuZFxcc3JjXFxjb25maWdcXGNvbmZpZ3VyYXRpb24uc2VydmljZS50cyIsIm1hcHBpbmdzIjoiO0FBQUEsb0VBQW9FO0FBQ3BFLDhCQUE4Qjs7Ozs7Ozs7Ozs7O0FBRTlCLDJDQUEyQztBQUkzQzs7OztHQUlHO0FBRUksSUFBTSxvQkFBb0IsR0FBMUIsTUFBTSxvQkFBb0I7SUFDRjtJQUE3QixZQUE2QixhQUF1QztRQUF2QyxrQkFBYSxHQUFiLGFBQWEsQ0FBMEI7SUFBRyxDQUFDO0lBRXhFLGdCQUFnQjtJQUNoQixJQUFJLFdBQVc7UUFDYixPQUFPLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLGNBQWMsRUFBRSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFBO0lBQ2hFLENBQUM7SUFFRCxJQUFJLGlCQUFpQjtRQUNuQixPQUFPLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLHFCQUFxQixFQUFFLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUE7SUFDdkUsQ0FBQztJQUVELElBQUksYUFBYTtRQUNmLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsaUJBQWlCLEVBQUUsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQTtJQUNuRSxDQUFDO0lBRUQsSUFBSSxhQUFhO1FBQ2YsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxpQkFBaUIsRUFBRSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFBO0lBQ25FLENBQUM7SUFFRCxtQkFBbUI7SUFDbkIsSUFBSSxRQUFRO1FBQ1YsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQTtJQUM3RCxDQUFDO0lBRUQsSUFBSSxTQUFTO1FBQ1gsT0FBTyxJQUFJ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QUFLLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQTtJQUNuRSxDQUFDO0NBQ0YsQ0FBQTtBQXhLWSxvREFBb0I7K0JBQXBCLG9CQUFvQjtJQURoQyxJQUFBLG1CQUFVLEdBQUU7O0dBQ0Esb0JBQW9CLENBd0toQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXDE2NjYzXFxEZXNrdG9wXFx0dWhlZ1xccGFja2FnZXNcXGNvbW1vbi1iYWNrZW5kXFxzcmNcXGNvbmZpZ1xcY29uZmlndXJhdGlvbi5zZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIOaWh+S7tui3r+W+hDogcGFja2FnZXMvY29tbW9uLWJhY2tlbmQvc3JjL2NvbmZpZy9jb25maWd1cmF0aW9uLnNlcnZpY2UudHNcbi8vIOaguOW/g+eQhuW/tTog57G75Z6L5a6J5YWo55qE6YWN572u5pyN5Yqh77yM5o+Q5L6b5L6/5o2355qE6YWN572u6K6/6Zeu5o6l5Y+jXG5cbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAbmVzdGpzL2NvbW1vbidcbmltcG9ydCB0eXBlIHsgQ29uZmlnU2VydmljZSB9IGZyb20gJ0BuZXN0anMvY29uZmlnJ1xuaW1wb3J0IHR5cGUgeyBFbnYgfSBmcm9tICcuL2Vudi5zY2hlbWEnXG5cbi8qKlxuICogQGNsYXNzIENvbmZpZ3VyYXRpb25TZXJ2aWNlXG4gKiBAZGVzY3JpcHRpb24g57G75Z6L5a6J5YWo55qE6YWN572u5pyN5YqhXG4gKiDmj5Dkvpvlr7nmiYDmnInnjq/looPlj5jph4/nmoTnsbvlnovlronlhajorr/pl65cbiAqL1xuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIENvbmZpZ3VyYXRpb25TZXJ2aWNlIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBjb25maWdTZXJ2aWNlOiBDb25maWdTZXJ2aWNlPEVudiwgdHJ1ZT4pIHt9XG5cbiAgLy8gLS0tIOaVsOaNruW6k+mFjee9riAtLS1cbiAgZ2V0IGRhdGFiYXNlVXJsKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnU2VydmljZS5nZXQoJ0RBVEFCQVNFX1VSTCcsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIGdldCBkYkNvbm5lY3Rpb25MaW1pdCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmNvbmZpZ1NlcnZpY2UuZ2V0KCdEQl9DT05ORUNUSU9OX0xJTUlUJywgeyBpbmZlcjogdHJ1ZSB9KVxuICB9XG5cbiAgZ2V0IGRiUG9vbFRpbWVvdXQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWdTZXJ2aWNlLmdldCgnREJfUE9PTF9USU1FT1VUJywgeyBpbmZlcjogdHJ1ZSB9KVxuICB9XG5cbiAgZ2V0IGRiSWRsZVRpbWVvdXQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWdTZXJ2aWNlLmdldCgnREJfSURMRV9USU1FT1VUJywgeyBpbmZlcjogdHJ1ZSB9KVxuICB9XG5cbiAgLy8gLS0tIFJlZGlzIOmFjee9riAtLS1cbiAgZ2V0IHJlZGlzVXJsKCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnU2VydmljZS5nZXQoJ1JFRElTX1VSTCcsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIGdldCByZWRpc0hvc3QoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWdTZXJ2aWNlLmdldCgnUkVESVNfSE9TVCcsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIGdldCByZWRpc1BvcnQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWdTZXJ2aWNlLmdldCgnUkVESVNfUE9SVCcsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIC8vIC0tLSDliqDlr4bphY3nva4gLS0tXG4gIGdldCBlbmNyeXB0aW9uS2V5KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnU2VydmljZS5nZXQoJ0VOQ1JZUFRJT05fS0VZJywgeyBpbmZlcjogdHJ1ZSB9KVxuICB9XG5cbiAgZ2V0IGVuY3J5cHRpb25TYWx0KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnU2VydmljZS5nZXQoJ0VOQ1JZUFRJT05fU0FMVCcsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIGdldCBlbmNyeXB0aW9uVXNlU2FsdCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWdTZXJ2aWNlLmdldCgnRU5DUllQVElPTl9VU0VfU0FMVCcsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIGdldCBlbmNyeXB0aW9uQWxnb3JpdGhtKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnU2VydmljZS5nZXQoJ0VOQ1JZUFRJT05fQUxHT1JJVEhNJywgeyBpbmZlcjogdHJ1ZSB9KVxuICB9XG5cbiAgLy8gLS0tIFNlbnRyeSDphY3nva4gLS0tXG4gIGdldCBzZW50cnlEc24oKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWdTZXJ2aWNlLmdldCgnU0VOVFJZX0RTTicsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIGdldCBzZW50cnlFbnZpcm9ubWVudCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmNvbmZpZ1NlcnZpY2UuZ2V0KCdTRU5UUllfRU5WSVJPTk1FTlQnLCB7IGluZmVyOiB0cnVlIH0pXG4gIH1cblxuICBnZXQgc2VudHJ5VHJhY2VzU2FtcGxlUmF0ZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmNvbmZpZ1NlcnZpY2UuZ2V0KCdTRU5UUllfVFJBQ0VTX1NBTVBMRV9SQVRFJywgeyBpbmZlcjogdHJ1ZSB9KVxuICB9XG5cbiAgLy8gLS0tIEFJIFByb3ZpZGVyIOmFjee9riAtLS1cbiAgZ2V0IGZhbGxiYWNrQXBpS2V5KCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnU2VydmljZS5nZXQoJ0ZBTExCQUNLX0FQSV9LRVknLCB7IGluZmVyOiB0cnVlIH0pXG4gIH1cblxuICBnZXQgZmFsbGJhY2tNb2RlbElkKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnU2VydmljZS5nZXQoJ0ZBTExCQUNLX01PREVMX0lEJywgeyBpbmZlcjogdHJ1ZSB9KVxuICB9XG5cbiAgZ2V0IGZhbGxiYWNrQmFzZVVybCgpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmNvbmZpZ1NlcnZpY2UuZ2V0KCdGQUxMQkFDS19CQVNFX1VSTCcsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIC8vIC0tLSDlupTnlKjphY3nva4gLS0tXG4gIGdldCBub2RlRW52KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnU2VydmljZS5nZXQoJ05PREVfRU5WJywgeyBpbmZlcjogdHJ1ZSB9KVxuICB9XG5cbiAgZ2V0IHBvcnQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWdTZXJ2aWNlLmdldCgnUE9SVCcsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIGdldCBjb3JzT3JpZ2luKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnU2VydmljZS5nZXQoJ0NPUlNfT1JJR0lOJywgeyBpbmZlcjogdHJ1ZSB9KVxuICB9XG5cbiAgLy8gLS0tIFFkcmFudCDphY3nva4gLS0tXG4gIGdldCBxZHJhbnRVcmwoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWdTZXJ2aWNlLmdldCgnUURSQU5UX1VSTCcsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIGdldCBxZHJhbnRBcGlLZXkoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWdTZXJ2aWNlLmdldCgnUURSQU5UX0FQSV9LRVknLCB7IGluZmVyOiB0cnVlIH0pXG4gIH1cblxuICAvLyAtLS0gQ2xlcmsg6YWN572uIC0tLVxuICBnZXQgY2xlcmtTZWNyZXRLZXkoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWdTZXJ2aWNlLmdldCgnQ0xFUktfU0VDUkVUX0tFWScsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIGdldCBjbGVya1B1Ymxpc2hhYmxlS2V5KCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnU2VydmljZS5nZXQoJ0NMRVJLX1BVQkxJU0hBQkxFX0tFWScsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIGdldCBjbGVya1dlYmhvb2tTZWNyZXRLZXkoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWdTZXJ2aWNlLmdldCgnQ0xFUktfV0VCSE9PS19TRUNSRVRfS0VZJywgeyBpbmZlcjogdHJ1ZSB9KVxuICB9XG5cbiAgLy8gLS0tIFJhYmJpdE1RIOmFjee9riAtLS1cbiAgZ2V0IHJhYmJpdG1xVXJsKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnU2VydmljZS5nZXQoJ1JBQkJJVE1RX1VSTCcsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIC8vIC0tLSBKV1Qg6YWN572uIC0tLVxuICBnZXQgand0U2VjcmV0KCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnU2VydmljZS5nZXQoJ0pXVF9TRUNSRVQnLCB7IGluZmVyOiB0cnVlIH0pXG4gIH1cblxuICBnZXQgand0RXhwaXJhdGlvblNlY29uZHMoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWdTZXJ2aWNlLmdldCgnSldUX0VYUElSQVRJT05fU0VDT05EUycsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIC8vIC0tLSDmnI3liqHnq6/lj6PphY3nva4gLS0tXG4gIGdldCBiYWNrZW5kR2F0ZXdheVBvcnQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWdTZXJ2aWNlLmdldCgnQkFDS0VORF9HQVRFV0FZX1BPUlQnLCB7IGluZmVyOiB0cnVlIH0pXG4gIH1cblxuICBnZXQgY3JlYXRpb25BZ2VudEh0dHBQb3J0KCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnU2VydmljZS5nZXQoJ0NSRUFUSU9OX0FHRU5UX0hUVFBfUE9SVCcsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIGdldCBsb2dpY0FnZW50SHR0cFBvcnQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWdTZXJ2aWNlLmdldCgnTE9HSUNfQUdFTlRfSFRUUF9QT1JUJywgeyBpbmZlcjogdHJ1ZSB9KVxuICB9XG5cbiAgZ2V0IG5hcnJhdGl2ZUFnZW50SHR0cFBvcnQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWdTZXJ2aWNlLmdldCgnTkFSUkFUSVZFX0FHRU5UX0hUVFBfUE9SVCcsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIC8vIC0tLSDkvr/mjbfmlrnms5UgLS0tXG4gIGdldCBpc0RldmVsb3BtZW50KCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLm5vZGVFbnYgPT09ICdkZXZlbG9wbWVudCdcbiAgfVxuXG4gIGdldCBpc1Byb2R1Y3Rpb24oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMubm9kZUVudiA9PT0gJ3Byb2R1Y3Rpb24nXG4gIH1cblxuICBnZXQgaXNUZXN0KCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLm5vZGVFbnYgPT09ICd0ZXN0J1xuICB9XG5cbiAgLyoqXG4gICAqIOiOt+WPlumFjee9ruWAvO+8jOWmguaenOacquiuvue9ruWImeaKm+WHuumUmeivr1xuICAgKi9cbiAgZ2V0T3JUaHJvdzxUIGV4dGVuZHMga2V5b2YgRW52PihrZXk6IFQpOiBFbnZbVF0ge1xuICAgIHJldHVybiB0aGlzLmNvbmZpZ1NlcnZpY2UuZ2V0T3JUaHJvdyhrZXksIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiDojrflj5bphY3nva7lgLzvvIzmlK/mjIHpu5jorqTlgLxcbiAgICovXG4gIGdldDxUIGV4dGVuZHMga2V5b2YgRW52PihrZXk6IFQsIGRlZmF1bHRWYWx1ZT86IEVudltUXSk6IEVudltUXSB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnU2VydmljZS5nZXQoa2V5LCBkZWZhdWx0VmFsdWUsIHsgaW5mZXI6IHRydWUgfSlcbiAgfVxufVxuIl0sInZlcnNpb24iOjN9