{"file":"C:\\Users\\16663\\Desktop\\tuheg\\packages\\common-backend\\src\\types\\state-change-directive.dto.ts","mappings":";AAAA,4DAA4D;;;AAE5D,6BAAuB;AAEvB,iBAAiB;AACjB,kBAAkB;AAClB,MAAM,sBAAsB,GAAG,OAAC,CAAC,MAAM,CAAC;IACtC,EAAE,EAAE,OAAC,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,WAAW,EAAE,WAAW,CAAC,CAAC;IAC7C,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE;CAClB,CAAC,CAAA;AAGF,iBAAiB;AACjB,MAAM,qBAAqB,GAAG,OAAC,CAAC,MAAM,CAAC;IACrC,EAAE,EAAE,OAAC,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,QAAQ,EAAE,SAAS,CAAC,CAAC;IACxC,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE;CAClB,CAAC,CAAA;AAGF,iBAAiB;AACjB,mBAAmB;AACnB,MAAM,qBAAqB,GAAG,OAAC,CAAC,MAAM,CAAC;IACrC,EAAE,EAAE,sBAAsB,CAAC,QAAQ,EAAE;IACrC,EAAE,EAAE,sBAAsB,CAAC,QAAQ,EAAE;IACrC,MAAM,EAAE,qBAAqB,CAAC,QAAQ,EAAE;CACzC,CAAC,CAAA;AAGF,qBAAqB;AACrB;;;GAGG;AACU,QAAA,0BAA0B,GAAG,OAAC,CAAC,MAAM,CAAC;IACjD,EAAE,EAAE,OAAC,CAAC,IAAI,CAAC,CAAC,kBAAkB,EAAE,mBAAmB,CAAC,CAAC;IACrD,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE;IACpB,OAAO,EAAE,OAAC,CAAC,KAAK,CAAC,CAAC,qBAAqB,EAAE,OAAC,CAAC,MAAM,CAAC,OAAC,CAAC,MAAM,EAAE,EAAE,OAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;CACzE,CAAC,CAAA;AAGF;;;GAGG;AACU,QAAA,kBAAkB,GAAG,OAAC,CAAC,KAAK,CAAC,kCAA0B,CAAC,CAAA","names":[],"sources":["C:\\Users\\16663\\Desktop\\tuheg\\packages\\common-backend\\src\\types\\state-change-directive.dto.ts"],"sourcesContent":["// 文件路径: libs/common/src/types/state-change-directive.dto.ts\n\nimport { z } from 'zod'\n\n// --- 原子操作定义 ---\n// 定义了可以对数值进行的原子操作\nconst numericOperationSchema = z.object({\n  op: z.enum(['set', 'increment', 'decrement']),\n  value: z.number(),\n})\nexport type NumericOperation = z.infer<typeof numericOperationSchema>\n\n// 定义了可以对字符串进行的操作\nconst stringOperationSchema = z.object({\n  op: z.enum(['set', 'append', 'prepend']),\n  value: z.string(),\n})\nexport type StringOperation = z.infer<typeof stringOperationSchema>\n\n// --- 实体更新指令 ---\n// 定义了针对一个角色的具体更新操作\nconst characterUpdateSchema = z.object({\n  hp: numericOperationSchema.optional(),\n  mp: numericOperationSchema.optional(),\n  status: stringOperationSchema.optional(),\n})\nexport type CharacterUpdate = z.infer<typeof characterUpdateSchema>\n\n// --- 状态变更指令核心定义 ---\n/**\n * 定义了一条单独的、完整的状态变更指令。\n * 这是我们系统中“确定性操作”的最小单元。\n */\nexport const stateChangeDirectiveSchema = z.object({\n  op: z.enum(['update_character', 'update_world_book']),\n  targetId: z.string(),\n  payload: z.union([characterUpdateSchema, z.record(z.string(), z.any())]),\n})\nexport type StateChangeDirective = z.infer<typeof stateChangeDirectiveSchema>\n\n/**\n * 定义了一个指令集，它是一个指令数组。\n * “逻辑AI”的最终输出，就是一个符合此 Schema 的JSON对象。\n */\nexport const directiveSetSchema = z.array(stateChangeDirectiveSchema)\nexport type DirectiveSet = z.infer<typeof directiveSetSchema>\n"],"version":3}