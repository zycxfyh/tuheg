{"file":"C:\\Users\\16663\\Desktop\\tuheg\\packages\\common-backend\\src\\pipes\\zod-validation.pipe.ts","mappings":";AAAA,qDAAqD;;;;;;;;;;;;AAErD,2CAAoF;AACpF,6BAA8C;AAGvC,IAAM,iBAAiB,GAAvB,MAAM,iBAAiB;IACR;IAApB,YAAoB,MAAiB;QAAjB,WAAM,GAAN,MAAM,CAAW;IAAG,CAAC;IAEzC,SAAS,CAAC,KAAc;QACtB,IAAI,CAAC;YACH,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAA;QACjC,CAAC;QAAC,OAAO,KAAK,EAAE,CAAC;YACf,IAAI,KAAK,YAAY,cAAQ,EAAE,CAAC;gBAC9B,MAAM,IAAI,4BAAmB,CAAC;oBAC5B,UAAU,EAAE,GAAG;oBACf,OAAO,EAAE,mBAAmB;oBAC5B,MAAM,EAAE,KAAK,CAAC,OAAO,EAAE,CAAC,WAAW;iBACpC,CAAC,CAAA;YACJ,CAAC;YACD,MAAM,IAAI,4BAAmB,CAAC,yBAAyB,CAAC,CAAA;QAC1D,CAAC;IACH,CAAC;CACF,CAAA;AAjBY,8CAAiB;4BAAjB,iBAAiB;IAD7B,IAAA,mBAAU,GAAE;;GACA,iBAAiB,CAiB7B","names":[],"sources":["C:\\Users\\16663\\Desktop\\tuheg\\packages\\common-backend\\src\\pipes\\zod-validation.pipe.ts"],"sourcesContent":["// 文件路径: libs/common/src/pipes/zod-validation.pipe.ts\n\nimport { BadRequestException, Injectable, type PipeTransform } from '@nestjs/common'\nimport { ZodError, type ZodSchema } from 'zod'\n\n@Injectable()\nexport class ZodValidationPipe implements PipeTransform {\n  constructor(private schema: ZodSchema) {}\n\n  transform(value: unknown): unknown {\n    try {\n      return this.schema.parse(value)\n    } catch (error) {\n      if (error instanceof ZodError) {\n        throw new BadRequestException({\n          statusCode: 400,\n          message: 'Validation failed',\n          errors: error.flatten().fieldErrors,\n        })\n      }\n      throw new BadRequestException('Invalid request payload')\n    }\n  }\n}\n"],"version":3}