{
  "version": "1.0.0",
  "description": "å·¥ä¸šåŒ–æµ‹è¯•å¿«é€Ÿå¤±è´¥ç­–ç•¥é…ç½®",
  "global_settings": {
    "enable_fast_failure": true,
    "max_retry_attempts": 2,
    "retry_delay_seconds": 5,
    "stage_timeout_seconds": 1800,
    "notification_channels": ["slack", "email"],
    "emergency_contacts": ["devops@tuheg.com", "+1-XXX-XXX-XXXX"]
  },
  "failure_strategies": {
    "dependencies": {
      "description": "ä¾èµ–ç¯å¢ƒæ£€æŸ¥é˜¶æ®µ",
      "failure_policy": "immediate_stop",
      "allow_retry": false,
      "critical_impact": "high",
      "error_patterns": [
        {
          "pattern": "command not found",
          "severity": "critical",
          "action": "stop_pipeline",
          "message": "ç¼ºå°‘å¿…éœ€çš„ç³»ç»Ÿå‘½ä»¤ï¼Œè¯·æ£€æŸ¥ç¯å¢ƒé…ç½®"
        },
        {
          "pattern": "version.*not supported",
          "severity": "critical",
          "action": "stop_pipeline",
          "message": "å·¥å…·ç‰ˆæœ¬ä¸å…¼å®¹ï¼Œè¯·å‡çº§ç›¸å…³å·¥å…·"
        }
      ]
    },
    "local_validation": {
      "description": "æœ¬åœ°éªŒè¯é˜¶æ®µï¼ˆæ„å»ºå’Œä¾èµ–ï¼‰",
      "failure_policy": "immediate_stop",
      "allow_retry": true,
      "retry_count": 1,
      "critical_impact": "high",
      "error_patterns": [
        {
          "pattern": "Cannot find module",
          "severity": "critical",
          "action": "stop_pipeline",
          "message": "æ¨¡å—å¯¼å…¥é”™è¯¯ï¼Œæ£€æŸ¥ä¾èµ–é…ç½®"
        },
        {
          "pattern": "TypeScript error",
          "severity": "high",
          "action": "retry_then_stop",
          "message": "TypeScriptç¼–è¯‘é”™è¯¯ï¼Œéœ€è¦ä¿®å¤ç±»å‹é—®é¢˜"
        },
        {
          "pattern": "Build failed",
          "severity": "high",
          "action": "stop_pipeline",
          "message": "æ„å»ºå¤±è´¥ï¼Œæ£€æŸ¥ä»£ç å’Œé…ç½®"
        }
      ]
    },
    "static_checks": {
      "description": "é™æ€ä»£ç æ£€æŸ¥é˜¶æ®µ",
      "failure_policy": "continue_with_warnings",
      "allow_retry": true,
      "retry_count": 1,
      "critical_impact": "medium",
      "error_patterns": [
        {
          "pattern": "ESLint.*error",
          "severity": "medium",
          "action": "continue",
          "message": "ESLintä»£ç è´¨é‡é—®é¢˜ï¼Œå»ºè®®ä¿®å¤ä½†ä¸é˜»å¡"
        },
        {
          "pattern": "security.*vulnerability",
          "severity": "high",
          "action": "stop_pipeline",
          "message": "å‘ç°å®‰å…¨æ¼æ´ï¼Œå¿…é¡»ä¿®å¤"
        }
      ]
    },
    "unit_tests": {
      "description": "å•å…ƒæµ‹è¯•é˜¶æ®µ",
      "failure_policy": "immediate_stop",
      "allow_retry": false,
      "critical_impact": "high",
      "error_patterns": [
        {
          "pattern": "test.*failed",
          "severity": "high",
          "action": "stop_pipeline",
          "message": "å•å…ƒæµ‹è¯•å¤±è´¥ï¼Œå¿…é¡»ä¿®å¤"
        },
        {
          "pattern": "coverage.*below.*threshold",
          "severity": "high",
          "action": "stop_pipeline",
          "message": "æµ‹è¯•è¦†ç›–ç‡ä¸è¾¾æ ‡ï¼Œå¿…é¡»å¢åŠ æµ‹è¯•"
        }
      ]
    },
    "integration_tests": {
      "description": "é›†æˆæµ‹è¯•é˜¶æ®µ",
      "failure_policy": "immediate_stop",
      "allow_retry": false,
      "critical_impact": "high",
      "error_patterns": [
        {
          "pattern": "docker.*failed",
          "severity": "critical",
          "action": "stop_pipeline",
          "message": "Dockerç¯å¢ƒé—®é¢˜ï¼Œæ£€æŸ¥å®¹å™¨é…ç½®"
        },
        {
          "pattern": "connection.*failed",
          "severity": "high",
          "action": "retry_then_stop",
          "message": "æœåŠ¡è¿æ¥å¤±è´¥ï¼Œé‡è¯•åä»å¤±è´¥åˆ™åœæ­¢"
        }
      ]
    }
  },
  "stage_dependencies": {
    "description": "é˜¶æ®µä¾èµ–å…³ç³»å›¾",
    "dependencies": {
      "local_validation": [],
      "static_checks": ["local_validation"],
      "unit_tests": ["local_validation"],
      "integration_tests": ["unit_tests", "static_checks"]
    },
    "parallel_groups": [["static_checks", "unit_tests"]]
  },
  "notification_templates": {
    "stage_failure": {
      "slack": "ğŸš¨ *å·¥ä¸šåŒ–æµ‹è¯•å¤±è´¥*\né˜¶æ®µ: {stage}\né”™è¯¯: {error}\næ—¶é—´: {timestamp}\næ—¥å¿—: {log_url}",
      "email": {
        "subject": "å·¥ä¸šåŒ–æµ‹è¯•å¤±è´¥ - {stage}",
        "body": "é˜¶æ®µ {stage} æ‰§è¡Œå¤±è´¥ã€‚\n\né”™è¯¯è¯¦æƒ…: {error}\n\næ‰§è¡Œæ—¶é—´: {timestamp}\n\nè¯·æŸ¥çœ‹å®Œæ•´æ—¥å¿—: {log_url}\n\nè‡ªåŠ¨ç”Ÿæˆçš„ä¿®å¤å»ºè®®:\n{fix_suggestions}"
      }
    },
    "pipeline_success": {
      "slack": "âœ… *å·¥ä¸šåŒ–æµ‹è¯•å…¨éƒ¨é€šè¿‡*\næ€»è€—æ—¶: {total_duration}s\nè¦†ç›–ç‡: {coverage}%\næäº¤äºº: {commit_author}",
      "email": {
        "subject": "å·¥ä¸šåŒ–æµ‹è¯•æˆåŠŸå®Œæˆ",
        "body": "æ‰€æœ‰æµ‹è¯•é˜¶æ®µå‡å·²æˆåŠŸå®Œæˆã€‚\n\næ‰§è¡Œç»Ÿè®¡:\n- æ€»è€—æ—¶: {total_duration}s\n- æµ‹è¯•è¦†ç›–ç‡: {coverage}%\n- é€šè¿‡çš„æµ‹è¯•æ•°: {passed_tests}\n\nè¯¦ç»†æŠ¥å‘Š: {report_url}"
      }
    }
  },
  "emergency_procedures": {
    "critical_failure": {
      "description": "å…³é”®é˜¶æ®µå¤±è´¥æ—¶çš„åº”æ€¥å¤„ç†æµç¨‹",
      "immediate_actions": ["é€šçŸ¥æ‰€æœ‰å¼€å‘å›¢é˜Ÿæˆå‘˜", "æš‚åœæ‰€æœ‰éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ", "å¯åŠ¨é—®é¢˜è¯Šæ–­æµç¨‹"],
      "rollback_strategy": "auto_rollback_to_last_stable",
      "communication_plan": {
        "internal": "ç«‹å³åœ¨Slack #devopsé¢‘é“é€šçŸ¥",
        "external": "å¦‚å½±å“ç”¨æˆ·åˆ™å‘é€æœåŠ¡çŠ¶æ€æ›´æ–°",
        "management": "å‘é€é«˜ä¼˜å…ˆçº§é‚®ä»¶ç»™æŠ€æœ¯è´Ÿè´£äºº"
      }
    },
    "timeout_handling": {
      "description": "æµ‹è¯•é˜¶æ®µè¶…æ—¶çš„å¤„ç†ç­–ç•¥",
      "actions": ["å¼ºåˆ¶ç»ˆæ­¢å½“å‰é˜¶æ®µ", "è®°å½•è¶…æ—¶åŸå› ", "æ ¹æ®é˜¶æ®µé‡è¦æ€§å†³å®šæ˜¯å¦ç»§ç»­"],
      "timeout_thresholds": {
        "dependencies": 300,
        "local_validation": 600,
        "static_checks": 300,
        "unit_tests": 900,
        "integration_tests": 1200
      }
    }
  }
}
