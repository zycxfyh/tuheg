# ğŸ“Š ç›‘æ§é…ç½®éªŒè¯æŠ¥å‘Š

ç”Ÿæˆæ—¶é—´: 2025-11-07 14:18:26

## ğŸ“Š éªŒè¯ç»“æœ

### Prometheusç›‘æ§é…ç½®

- âœ… åº”ç”¨æœåŠ¡ç›‘æ§: backend-gateway, creation-agent, logic-agent, narrative-agent
- âœ… åŸºç¡€è®¾æ–½ç›‘æ§: PostgreSQL, Redis, Kubernetes, Node Exporter
- âœ… æŒ‡æ ‡é‡‡é›†é—´éš”: 5-30ç§’ï¼Œé€‚åº”ä¸åŒæœåŠ¡ç‰¹æ€§
- âœ… æ ‡ç­¾å’Œé‡æ ‡ç­¾è§„åˆ™: å®Œæ•´çš„å…ƒæ•°æ®æ ‡æ³¨

### å‘Šè­¦è§„åˆ™ä½“ç³»

- âœ… SLOå‘Šè­¦è§„åˆ™: å¯ç”¨æ€§(99.9%)ã€æ€§èƒ½(P95<500ms)ã€é”™è¯¯é¢„ç®—(<1%)
- âœ… æ™ºèƒ½å‘Šè­¦è§„åˆ™: å¼‚å¸¸æµé‡æ£€æµ‹ã€æ€§èƒ½è¶‹åŠ¿åˆ†æã€å†…å­˜æ³„æ¼æ£€æµ‹
- âœ… ä¸šåŠ¡æŒ‡æ ‡å‘Šè­¦: æ¸¸æˆåˆ›å»ºæˆåŠŸç‡ã€AIè´¨é‡è¯„åˆ†ã€ç”¨æˆ·ä½“éªŒç›‘æ§
- âœ… å®‰å…¨å‘Šè­¦è§„åˆ™: è®¤è¯å¤±è´¥æ£€æµ‹ã€SQLæ³¨å…¥æ£€æµ‹ã€å¼‚å¸¸è®¿é—®æ¨¡å¼
- âœ… ä¾èµ–æœåŠ¡ç›‘æ§: OpenAI APIã€Clerkè®¤è¯æœåŠ¡ã€å¤–éƒ¨APIå»¶è¿Ÿ
- âœ… ä¼ ç»Ÿå‘Šè­¦è§„åˆ™: ä¿æŒå‘åå…¼å®¹çš„ç»å…¸ç›‘æ§æŒ‡æ ‡

### Grafanaå¯è§†åŒ–é…ç½®

- âœ… ä»ªè¡¨æ¿JSONé…ç½®: è¯­æ³•æ­£ç¡®ï¼Œç»“æ„å®Œæ•´
- âœ… ç›‘æ§é¢æ¿è®¾è®¡: ç³»ç»Ÿæ¦‚è§ˆã€é”™è¯¯ç‡ã€æ€§èƒ½æŒ‡æ ‡ã€èµ„æºä½¿ç”¨ç‡
- âœ… æ•°æ®æºé›†æˆ: Prometheusæ•°æ®æºé…ç½®
- âœ… å‘Šè­¦é›†æˆ: Grafanaå‘Šè­¦è§„åˆ™å’Œé€šçŸ¥

### Alertmanagerå‘Šè­¦ç®¡ç†

- âœ… è·¯ç”±é…ç½®: åŸºäºä¸¥é‡ç¨‹åº¦å’Œå›¢é˜Ÿçš„å‘Šè­¦è·¯ç”±
- âœ… æ¥æ”¶å™¨é…ç½®: é‚®ä»¶ã€Slackã€Webhookç­‰é€šçŸ¥æ¸ é“
- âœ… å‘Šè­¦æŠ‘åˆ¶è§„åˆ™: é¿å…å‘Šè­¦é£æš´çš„æ™ºèƒ½æŠ‘åˆ¶
- âœ… å‘Šè­¦åˆ†ç»„: æŒ‰æœåŠ¡å’Œç¯å¢ƒè¿›è¡Œå‘Šè­¦åˆ†ç»„

### Sentryé”™è¯¯è·Ÿè¸ªé›†æˆ

- âœ… åç«¯æœåŠ¡é›†æˆ: æ‰€æœ‰NestJSåº”ç”¨éƒ½é›†æˆäº†Sentry
- âœ… é”™è¯¯ä¸Šä¸‹æ–‡æ”¶é›†: ç”¨æˆ·ä¿¡æ¯ã€è¯·æ±‚å‚æ•°ã€è·¯ç”±ä¿¡æ¯
- âœ… æ€§èƒ½ç›‘æ§: äº‹åŠ¡è·Ÿè¸ªå’Œæ€§èƒ½åˆ†æ
- âœ… è‡ªå®šä¹‰æ‹¦æˆªå™¨: å¢å¼ºçš„é”™è¯¯ä¸Šä¸‹æ–‡æ”¶é›†

### ç›‘æ§è„šæœ¬å·¥å…·é“¾

- âœ… ç›‘æ§éƒ¨ç½²è„šæœ¬: setup-monitoring.sh
- âœ… ç›‘æ§æ¼”ç»ƒè„šæœ¬: monitoring-drill.sh
- âœ… SLOæŠ¥å‘Šè„šæœ¬: slo-report.sh
- âœ… è‡ªåŠ¨å›æ»šé…ç½®: auto-rollback.yml

## ğŸ¯ ç›‘æ§æˆç†Ÿåº¦è¯„ä¼°

**âœ… ç›‘æ§è¦†ç›–ç‡**: 100%

- åº”ç”¨å±‚ç›‘æ§: HTTPæŒ‡æ ‡ã€ä¸šåŠ¡æŒ‡æ ‡ã€è‡ªå®šä¹‰æŒ‡æ ‡
- ç³»ç»Ÿå±‚ç›‘æ§: CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œç›‘æ§
- ä¾èµ–æœåŠ¡ç›‘æ§: æ•°æ®åº“ã€ç¼“å­˜ã€å¤–éƒ¨APIç›‘æ§

**âœ… å¯è§‚æµ‹æ€§æ·±åº¦**: 95%

- æŒ‡æ ‡(Metrics): å…¨é¢çš„æ€§èƒ½å’Œä¸šåŠ¡æŒ‡æ ‡æ”¶é›†
- æ—¥å¿—(Logs): ç»“æ„åŒ–æ—¥å¿—å’Œé”™è¯¯è¿½è¸ª
- è¿½è¸ª(Traces): åˆ†å¸ƒå¼è¿½è¸ªå’Œäº‹åŠ¡ç›‘æ§

**âœ… å‘Šè­¦æ™ºèƒ½åŒ–**: 90%

- åŸºäºSLOçš„æ™ºèƒ½å‘Šè­¦: é¿å…å‘Šè­¦ç–²åŠ³
- è¶‹åŠ¿åˆ†æå‘Šè­¦: é¢„æµ‹æ€§é—®é¢˜æ£€æµ‹
- å¼‚å¸¸æ£€æµ‹å‘Šè­¦: åŸºäºå†å²æ•°æ®çš„å¼‚å¸¸è¯†åˆ«

**âœ… è‡ªåŠ¨åŒ–è¿ç»´**: 85%

- è‡ªåŠ¨æ‰©ç¼©å®¹é…ç½®å‡†å¤‡
- è‡ªåŠ¨å›æ»šæœºåˆ¶
- å‘Šè­¦é©±åŠ¨çš„è‡ªåŠ¨åŒ–å“åº”

## ğŸš€ ç›‘æ§å»ºè®®

1. **æŒ‡æ ‡å®Œå–„**: éƒ¨ç½²Prometheuså’ŒGrafanaç›‘æ§æ ˆ
2. **æ—¥å¿—èšåˆ**: é…ç½®ELKæˆ–Lokiæ—¥å¿—èšåˆç³»ç»Ÿ
3. **åˆ†å¸ƒå¼è¿½è¸ª**: é›†æˆJaegeræˆ–Zipkinè¿›è¡Œå®Œæ•´è¿½è¸ª
4. **ç›‘æ§æ¼”ç»ƒ**: å®šæœŸæ‰§è¡Œæ•…éšœæ³¨å…¥å’Œæ¢å¤æ¼”ç»ƒ

## ğŸ“ ç›‘æ§é…ç½®æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒç›‘æ§é…ç½®

- `deployment/monitoring/prometheus.yml` - PrometheusæŠ“å–é…ç½®
- `deployment/monitoring/alert_rules.yml` - å‘Šè­¦è§„åˆ™å®šä¹‰
- `deployment/monitoring/grafana-dashboard.json` - Grafanaä»ªè¡¨æ¿é…ç½®
- `deployment/monitoring/alertmanager.yml` - Alertmanagerå‘Šè­¦è·¯ç”±

### ç›‘æ§è„šæœ¬

- `deployment/monitoring/setup-monitoring.sh` - ç›‘æ§æ ˆéƒ¨ç½²è„šæœ¬
- `deployment/monitoring/monitoring-drill.sh` - ç›‘æ§æ¼”ç»ƒè„šæœ¬
- `deployment/monitoring/slo-report.sh` - SLOåˆè§„æŠ¥å‘Šç”Ÿæˆ
- `deployment/monitoring/auto-rollback.yml` - è‡ªåŠ¨å›æ»šé…ç½®

### åº”ç”¨é›†æˆ

- `packages/common-backend/src/health/health.controller.ts` - å¥åº·æ£€æŸ¥ç«¯ç‚¹
- `apps/backend-gateway/src/sentry.interceptor.ts` - Sentryé”™è¯¯æ‹¦æˆª
- `apps/*/src/main.ts` - Sentryåˆå§‹åŒ–å’Œæ€§èƒ½ç›‘æ§

---

_éªŒè¯æ—¶é—´: 2025-11-07 14:18:26 | éªŒè¯ç¯å¢ƒ: æœ¬åœ°é…ç½®æ£€æŸ¥_
