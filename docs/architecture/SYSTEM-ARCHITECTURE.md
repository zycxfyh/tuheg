# ğŸ—ï¸ ç³»ç»Ÿæ•´ä½“æ¶æ„è®¾è®¡

## ğŸ“‹ æ¦‚è¿°

åˆ›ä¸–æ˜Ÿç¯æ˜¯ä¸€ä¸ªåŸºäºAIé©±åŠ¨çš„äº¤äº’å¼å™äº‹æ¸¸æˆç”Ÿæˆç³»ç»Ÿï¼Œé‡‡ç”¨ç°ä»£åŒ–çš„å¾®æœåŠ¡æ¶æ„è®¾è®¡ã€‚æœ¬æ–‡æ¡£æè¿°ç³»ç»Ÿçš„æ•´ä½“æ¶æ„è®¾è®¡ï¼ŒåŒ…æ‹¬ç»„ä»¶å…³ç³»ã€æ•°æ®æµã€éƒ¨ç½²æ¶æ„ç­‰å…³é”®æ–¹é¢ã€‚

## ğŸ›ï¸ æ¶æ„æ€»è§ˆ

### ç³»ç»Ÿè¾¹ç•Œä¸ä¸Šä¸‹æ–‡

```mermaid
graph TB
    subgraph "åˆ›ä¸–æ˜Ÿç¯ç³»ç»Ÿ"
        subgraph "æ ¸å¿ƒä¸šåŠ¡åŸŸ"
            UI[ç”¨æˆ·ç•Œé¢å±‚]
            API[APIç½‘å…³å±‚]
            Agents[AIä»£ç†å±‚]
            Core[ä¸šåŠ¡æ ¸å¿ƒå±‚]
        end

        subgraph "æ”¯æ’‘æœåŠ¡"
            DB[(PostgreSQL)]
            Cache[(Redis)]
            MQ[(RabbitMQ)]
            Vector[(Qdrant)]
        end

        subgraph "åŸºç¡€è®¾æ–½"
            K8s[Kubernetes]
            Monitoring[ç›‘æ§ä½“ç³»]
            CI[CI/CD]
        end
    end

    subgraph "å¤–éƒ¨ç³»ç»Ÿ"
        AI[AIæœåŠ¡æä¾›å•†]
        CDN[CDNç½‘ç»œ]
        External[ç¬¬ä¸‰æ–¹æœåŠ¡]
    end

    UI --> API
    API --> Agents
    Agents --> Core
    Core --> DB
    Core --> Cache
    Agents --> MQ
    Core --> Vector
    AI --> Agents
    External --> API
```

### æ¶æ„åˆ†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ¨ è¡¨ç°å±‚ (Presentation)                 â”‚
â”‚  Frontend (Vue 3 SPA) + Mobile Apps                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 ğŸ¢ åº”ç”¨å±‚ (Application)                     â”‚
â”‚  API Gateway + Business Services + Orchestration           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 ğŸ¤– é¢†åŸŸå±‚ (Domain)                          â”‚
â”‚  Game Core + AI Services + Business Logic                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 ğŸ—„ï¸ åŸºç¡€è®¾æ–½å±‚ (Infrastructure)             â”‚
â”‚  Databases + Message Queues + External Services            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§© æ ¸å¿ƒç»„ä»¶æ¶æ„

### 1. ç”¨æˆ·ç•Œé¢å±‚ (Frontend)

**æŠ€æœ¯æ ˆ**: Vue 3 + TypeScript + Vite
**èŒè´£**: ç”¨æˆ·äº¤äº’ã€çŠ¶æ€ç®¡ç†ã€å®æ—¶é€šä¿¡
**ç»„ä»¶**:

- **ä¸»åº”ç”¨ (Main App)**: å•é¡µåº”ç”¨å…¥å£
- **æ¸¸æˆç•Œé¢ (Game UI)**: æ¸¸æˆäº¤äº’ç»„ä»¶
- **åˆ›ä¸–ä¸­å¿ƒ (Creation Hub)**: æ¸¸æˆåˆ›å»ºæµç¨‹
- **æ’ä»¶å¸‚åœº (Plugin Marketplace)**: æ‰©å±•åŠŸèƒ½ç®¡ç†
- **WebSocketå®¢æˆ·ç«¯**: å®æ—¶é€šä¿¡å¤„ç†

### 2. APIç½‘å…³å±‚ (Backend Gateway)

**æŠ€æœ¯æ ˆ**: NestJS + TypeScript
**èŒè´£**: è¯·æ±‚è·¯ç”±ã€è®¤è¯æˆæƒã€è´Ÿè½½å‡è¡¡ã€APIç®¡ç†
**ç»„ä»¶**:

- **è®¤è¯æœåŠ¡ (Auth Service)**: JWTä»¤ç‰Œç®¡ç†ã€ç”¨æˆ·è®¤è¯
- **æ¸¸æˆç®¡ç† (Games Service)**: æ¸¸æˆCRUDæ“ä½œ
- **WebSocketç½‘å…³ (WS Gateway)**: å®æ—¶æ¶ˆæ¯è·¯ç”±
- **æ’ä»¶æ²™ç®± (Plugin Sandbox)**: æ’ä»¶å®‰å…¨æ‰§è¡Œ
- **è®¾ç½®ç®¡ç† (Settings Service)**: ç”¨æˆ·é…ç½®ç®¡ç†

### 3. AIä»£ç†å±‚ (AI Agents)

**æ¶æ„æ¨¡å¼**: å¾®æœåŠ¡ + äº‹ä»¶é©±åŠ¨
**èŒè´£**: AIæ¨ç†ã€ä¸šåŠ¡é€»è¾‘å¤„ç†ã€å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œ
**ä»£ç†ç±»å‹**:

#### Creation Agent (åˆ›ä¸–ä»£ç†)

- **è¾“å…¥**: ç”¨æˆ·æ¦‚å¿µæè¿°
- **è¾“å‡º**: å®Œæ•´çš„æ¸¸æˆä¸–ç•Œè®¾å®š
- **èŒè´£**: ä»é›¶åˆ›å»ºæ¸¸æˆä¸–ç•Œ

#### Logic Agent (é€»è¾‘ä»£ç†)

- **è¾“å…¥**: ç©å®¶è¡ŒåŠ¨ + æ¸¸æˆçŠ¶æ€
- **è¾“å‡º**: çŠ¶æ€å˜æ›´æŒ‡ä»¤
- **èŒè´£**: å¤„ç†æ¸¸æˆé€»è¾‘æ¨ç†

#### Narrative Agent (å™äº‹ä»£ç†)

- **è¾“å…¥**: é€»è¾‘å¤„ç†ç»“æœ + æ¸¸æˆçŠ¶æ€
- **è¾“å‡º**: ç”ŸåŠ¨å™äº‹å†…å®¹ + è¡ŒåŠ¨é€‰é¡¹
- **èŒè´£**: ç”Ÿæˆæ²‰æµ¸å¼å™äº‹

#### DLQ Consumer (æ­»ä¿¡é˜Ÿåˆ—æ¶ˆè´¹è€…)

- **è¾“å…¥**: å¤±è´¥çš„æ¶ˆæ¯
- **èŒè´£**: é”™è¯¯å¤„ç†ã€å‘Šè­¦é€šçŸ¥ã€å¤±è´¥æ¶ˆæ¯ç®¡ç†

### 4. ä¸šåŠ¡æ ¸å¿ƒå±‚ (Business Core)

**æ¶æ„æ¨¡å¼**: é¢†åŸŸé©±åŠ¨è®¾è®¡ (DDD)
**èŒè´£**: ä¸šåŠ¡è§„åˆ™ã€é¢†åŸŸé€»è¾‘ã€æ•°æ®ä¸€è‡´æ€§
**ç»„ä»¶**:

- **Game Core**: æ¸¸æˆé¢†åŸŸæ¨¡å‹å’Œè§„åˆ™å¼•æ“
- **AI Services**: å¤šAIæä¾›å•†æŠ½è±¡å±‚
- **Common Backend**: å…±äº«ä¸šåŠ¡é€»è¾‘å’ŒåŸºç¡€è®¾æ–½

## ğŸ“Š æ•°æ®æµæ¶æ„

### è¯·æ±‚å¤„ç†æµç¨‹

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant F as Frontend
    participant G as Gateway
    participant MQ as Message Queue
    participant CA as Creation Agent
    participant DB as Database

    U->>F: æäº¤æ¸¸æˆæ¦‚å¿µ
    F->>G: POST /games/narrative-driven
    G->>DB: éªŒè¯ç”¨æˆ·èº«ä»½
    G->>MQ: å‘å¸ƒ GAME_CREATION_REQUESTED
    MQ->>CA: æ¶ˆè´¹æ¶ˆæ¯
    CA->>CA: AIç”Ÿæˆæ¸¸æˆä¸–ç•Œ
    CA->>DB: ä¿å­˜æ¸¸æˆæ•°æ®
    CA->>MQ: å‘å¸ƒ GAME_CREATION_COMPLETED
    MQ->>G: æ¨é€å®Œæˆäº‹ä»¶
    G->>F: WebSocketé€šçŸ¥
    F->>U: æ˜¾ç¤ºæ¸¸æˆåˆ›å»ºæˆåŠŸ
```

### æ¸¸æˆäº¤äº’æµç¨‹

```mermaid
sequenceDiagram
    participant P as ç©å®¶
    participant F as Frontend
    participant G as Gateway
    participant MQ as Message Queue
    participant LA as Logic Agent
    participant NA as Narrative Agent
    participant DB as Database

    P->>F: é€‰æ‹©è¡ŒåŠ¨
    F->>G: POST /games/{id}/actions
    G->>DB: éªŒè¯æ¸¸æˆçŠ¶æ€
    G->>MQ: å‘å¸ƒ PLAYER_ACTION_SUBMITTED
    MQ->>LA: æ¶ˆè´¹é€»è¾‘æ¨ç†ä»»åŠ¡
    LA->>LA: AIé€»è¾‘æ¨ç†
    LA->>DB: æ›´æ–°æ¸¸æˆçŠ¶æ€
    LA->>MQ: å‘å¸ƒ LOGIC_PROCESSING_COMPLETE
    MQ->>NA: æ¶ˆè´¹å™äº‹ç”Ÿæˆä»»åŠ¡
    NA->>NA: AIç”Ÿæˆå™äº‹
    NA->>MQ: å‘å¸ƒ NARRATIVE_GENERATION_COMPLETED
    MQ->>G: æ¨é€ç»“æœäº‹ä»¶
    G->>F: WebSocketå®æ—¶æ¨é€
    F->>P: æ˜¾ç¤ºAIç”Ÿæˆå†…å®¹
```

## ğŸ—„ï¸ æ•°æ®æ¶æ„

### æ•°æ®å­˜å‚¨ç­–ç•¥

#### PostgreSQL (ä¸»æ•°æ®åº“)

- **ç”¨æˆ·æ•°æ®**: ç”¨æˆ·è´¦æˆ·ã€è®¤è¯ä¿¡æ¯
- **æ¸¸æˆæ•°æ®**: æ¸¸æˆå®ä½“ã€ä¸–ç•Œè®¾å®šã€è§’è‰²ä¿¡æ¯
- **ä¸šåŠ¡æ•°æ®**: æ’ä»¶é…ç½®ã€ç”¨æˆ·è®¾ç½®

#### Redis (ç¼“å­˜å±‚)

- **ä¼šè¯å­˜å‚¨**: ç”¨æˆ·ä¼šè¯å’ŒJWTä»¤ç‰Œ
- **çƒ­ç‚¹æ•°æ®**: é¢‘ç¹è®¿é—®çš„æ¸¸æˆçŠ¶æ€
- **å®æ—¶æ•°æ®**: WebSocketè¿æ¥çŠ¶æ€

#### RabbitMQ (æ¶ˆæ¯é˜Ÿåˆ—)

- **å¼‚æ­¥ä»»åŠ¡**: AIæ¨ç†ä»»åŠ¡é˜Ÿåˆ—
- **äº‹ä»¶æ€»çº¿**: æœåŠ¡é—´äº‹ä»¶é€šä¿¡
- **æ­»ä¿¡é˜Ÿåˆ—**: å¤±è´¥ä»»åŠ¡å¤„ç†

#### Qdrant (å‘é‡æ•°æ®åº“)

- **è¯­ä¹‰æœç´¢**: å¯¹è¯å†å²å‘é‡æ£€ç´¢
- **è®°å¿†ç³»ç»Ÿ**: AIä¸Šä¸‹æ–‡è®°å¿†å­˜å‚¨
- **ç›¸ä¼¼æ€§åŒ¹é…**: å†…å®¹æ¨èå’Œå»é‡

### æ•°æ®ä¸€è‡´æ€§ç­–ç•¥

#### äº‹åŠ¡ç®¡ç†

```typescript
// æ¸¸æˆåˆ›å»ºäº‹åŠ¡ç¤ºä¾‹
await this.prisma.$transaction(async (tx) => {
  // 1. åˆ›å»ºæ¸¸æˆè®°å½•
  const game = await tx.game.create({ data: gameData });

  // 2. åˆ›å»ºè§’è‰²
  await tx.character.create({ data: { gameId: game.id, ... } });

  // 3. åˆ›å»ºä¸–ç•Œä¹¦æ¡ç›®
  await tx.worldBookEntry.createMany({ data: worldBookData });

  return game;
});
```

#### æœ€ç»ˆä¸€è‡´æ€§

- **äº‹ä»¶é©±åŠ¨æ›´æ–°**: é€šè¿‡äº‹ä»¶æ€»çº¿å®ç°è·¨æœåŠ¡æ•°æ®åŒæ­¥
- **è¡¥å¿äº‹åŠ¡**: å¤±è´¥åœºæ™¯ä¸‹çš„æ•°æ®ä¿®å¤æœºåˆ¶
- **å®¡è®¡æ—¥å¿—**: å®Œæ•´çš„æ“ä½œè®°å½•ç”¨äºé—®é¢˜æ’æŸ¥

## ğŸ”’ å®‰å…¨æ¶æ„

### è®¤è¯æˆæƒ

#### JWTä»¤ç‰Œæœºåˆ¶

```typescript
// ä»¤ç‰Œç”Ÿæˆ
const token = await this.jwtService.signAsync({
  sub: user.id,
  email: user.email,
  role: user.role,
})

// ä»¤ç‰ŒéªŒè¯ä¸­é—´ä»¶
@Injectable()
export class JwtAuthGuard implements CanActivate {
  async canActivate(context: ExecutionContext): Promise<boolean> {
    const token = this.extractTokenFromHeader(request)
    return await this.jwtService.verifyAsync(token)
  }
}
```

#### å¤šå±‚å®‰å…¨é˜²æŠ¤

- **APIç½‘å…³**: è¯·æ±‚è¿‡æ»¤å’Œé™æµ
- **æœåŠ¡å±‚**: ä¸šåŠ¡è§„åˆ™éªŒè¯
- **æ•°æ®å±‚**: æ•æ„Ÿæ•°æ®åŠ å¯†

### AIå®‰å…¨

#### æŠ¤æ æœºåˆ¶ (Guardrails)

- **è¾“å…¥éªŒè¯**: é˜²æ­¢æ¶æ„è¾“å…¥
- **è¾“å‡ºè¿‡æ»¤**: è¿‡æ»¤ä¸å½“å†…å®¹
- **ä½¿ç”¨ç›‘æ§**: APIè°ƒç”¨é…é¢ç®¡ç†

#### éšç§ä¿æŠ¤

- **æ•°æ®æœ€å°åŒ–**: åªæ”¶é›†å¿…è¦æ•°æ®
- **åŠ å¯†å­˜å‚¨**: æ•æ„Ÿæ•°æ®åŠ å¯†
- **è®¿é—®æ§åˆ¶**: åŸºäºè§’è‰²çš„æ•°æ®è®¿é—®

## âš¡ æ€§èƒ½æ¶æ„

### æ€§èƒ½æŒ‡æ ‡ç›®æ ‡

| æŒ‡æ ‡          | ç›®æ ‡å€¼ | è¯´æ˜       |
| ------------- | ------ | ---------- |
| APIå“åº”æ—¶é—´   | <200ms | 90%è¯·æ±‚    |
| æ¸¸æˆåˆ›å»ºæ—¶é—´  | <30s   | AIç”Ÿæˆè€—æ—¶ |
| å¹¶å‘ç”¨æˆ·æ•°    | 1000+  | åŒæ—¶åœ¨çº¿   |
| WebSocketå»¶è¿Ÿ | <100ms | å®æ—¶é€šä¿¡   |

### æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

#### ç¼“å­˜ç­–ç•¥

```typescript
@Injectable()
export class CacheService {
  @Cache('game:state', 300) // 5åˆ†é’ŸTTL
  async getGameState(gameId: string): Promise<GameState> {
    return await this.prisma.game.findUnique({ where: { id: gameId } })
  }
}
```

#### å¼‚æ­¥å¤„ç†

- **æ¶ˆæ¯é˜Ÿåˆ—**: è§£è€¦åŒæ­¥è¯·æ±‚
- **äº‹ä»¶é©±åŠ¨**: éé˜»å¡ä¸šåŠ¡å¤„ç†
- **åå°ä»»åŠ¡**: AIæ¨ç†å¼‚æ­¥æ‰§è¡Œ

#### æ•°æ®åº“ä¼˜åŒ–

- **ç´¢å¼•ç­–ç•¥**: åŸºäºæŸ¥è¯¢æ¨¡å¼çš„ç´¢å¼•
- **è¿æ¥æ± **: å¤ç”¨æ•°æ®åº“è¿æ¥
- **è¯»å†™åˆ†ç¦»**: è¯»è¯·æ±‚åˆ†æµ

## ğŸš€ éƒ¨ç½²æ¶æ„

### å®¹å™¨åŒ–éƒ¨ç½²

```dockerfile
# å¤šé˜¶æ®µæ„å»ºç¤ºä¾‹
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

FROM node:18-alpine AS runtime
WORKDIR /app
COPY --from=builder /app/node_modules ./node_modules
COPY dist ./dist
EXPOSE 3000
CMD ["node", "dist/main.js"]
```

### Kuberneteséƒ¨ç½²

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: backend-gateway
spec:
  replicas: 3
  selector:
    matchLabels:
      app: backend-gateway
  template:
    metadata:
      labels:
        app: backend-gateway
    spec:
      containers:
        - name: backend-gateway
          image: creation-ring/backend-gateway:latest
          ports:
            - containerPort: 3000
          env:
            - name: NODE_ENV
              value: 'production'
          resources:
            requests:
              memory: '256Mi'
              cpu: '200m'
            limits:
              memory: '512Mi'
              cpu: '500m'
```

### æœåŠ¡ç½‘æ ¼æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Service Mesh (Istio)                     â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Frontend   â”‚ â”‚  Gateway    â”‚ â”‚   AI Agents         â”‚   â”‚
â”‚  â”‚  Service    â”‚ â”‚  Service    â”‚ â”‚   Services          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚               â”‚                       â”‚         â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                           â”‚                                 â”‚
â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                 â”‚  Envoy Proxy     â”‚                       â”‚
â”‚                 â”‚  Sidecar         â”‚                       â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                           â”‚                                 â”‚
â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                 â”‚ Control Plane     â”‚                       â”‚
â”‚                 â”‚ (Pilot + Citadel) â”‚                       â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š ç›‘æ§æ¶æ„

### å¯è§‚æµ‹æ€§ä¸‰æŸ±

#### æŒ‡æ ‡ (Metrics)

- **ä¸šåŠ¡æŒ‡æ ‡**: è¯·æ±‚é‡ã€æˆåŠŸç‡ã€å“åº”æ—¶é—´
- **ç³»ç»ŸæŒ‡æ ‡**: CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡
- **è‡ªå®šä¹‰æŒ‡æ ‡**: AIæ¨ç†è€—æ—¶ã€é˜Ÿåˆ—ç§¯å‹

#### æ—¥å¿— (Logs)

```typescript
@Injectable()
export class LoggerService {
  log(level: LogLevel, message: string, context?: any): void {
    const logEntry = {
      timestamp: new Date().toISOString(),
      level,
      message,
      context,
      service: this.serviceName,
    }

    // ç»“æ„åŒ–æ—¥å¿—è¾“å‡º
    console.log(JSON.stringify(logEntry))
  }
}
```

#### è¿½è¸ª (Traces)

- **è¯·æ±‚è¿½è¸ª**: åˆ†å¸ƒå¼è¯·æ±‚é“¾è·¯è¿½è¸ª
- **æ€§èƒ½å‰–æ**: AIæ¨ç†æ€§èƒ½åˆ†æ
- **é”™è¯¯è¿½è¸ª**: å¼‚å¸¸å †æ ˆå’Œä¸Šä¸‹æ–‡

### ç›‘æ§å·¥å…·æ ˆ

```
åº”ç”¨å±‚ç›‘æ§: Sentry (é”™è¯¯è¿½è¸ª)
åŸºç¡€è®¾æ–½ç›‘æ§: Prometheus + Grafana
æ—¥å¿—èšåˆ: ELK Stack (Elasticsearch + Logstash + Kibana)
åˆ†å¸ƒå¼è¿½è¸ª: Jaeger
æ€§èƒ½ç›‘æ§: New Relic / DataDog
```

## ğŸ”„ æ‰©å±•æ¶æ„

### æ°´å¹³æ‰©å±•ç­–ç•¥

#### æ— çŠ¶æ€æœåŠ¡æ‰©å±•

```yaml
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: ai-agent-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: ai-agent
  minReplicas: 2
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
```

#### é˜Ÿåˆ—é©±åŠ¨æ‰©å±•

- **åŸºäºé˜Ÿåˆ—é•¿åº¦**: æ¶ˆæ¯ç§¯å‹æ—¶è‡ªåŠ¨æ‰©å±•
- **é¢„æµ‹æ€§æ‰©å±•**: åŸºäºå†å²æ¨¡å¼é¢„æµ‹è´Ÿè½½
- **æ—¶é—´çª—å£æ‰©å±•**: ä¸šåŠ¡é«˜å³°æœŸä¸»åŠ¨æ‰©å±•

### å‚ç›´æ‰©å±•ç­–ç•¥

#### èµ„æºä¼˜åŒ–

- **å®¹å™¨èµ„æºé™åˆ¶**: åˆç†è®¾ç½®CPUå’Œå†…å­˜é™åˆ¶
- **JVMè°ƒä¼˜**: Node.jså†…å­˜å’Œåƒåœ¾å›æ”¶ä¼˜åŒ–
- **æ•°æ®åº“è¿æ¥æ± **: ä¼˜åŒ–æ•°æ®åº“è¿æ¥ç®¡ç†

## ğŸ§ª æµ‹è¯•æ¶æ„

### æµ‹è¯•é‡‘å­—å¡”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    E2E Tests (ç«¯åˆ°ç«¯æµ‹è¯•)                    â”‚
â”‚              å®Œæ•´ç”¨æˆ·æµç¨‹ï¼Œä¸šåŠ¡éªŒæ”¶æµ‹è¯•                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 Integration Tests (é›†æˆæµ‹è¯•)               â”‚
â”‚              æœåŠ¡é—´äº¤äº’ï¼Œæ•°æ®ä¸€è‡´æ€§æµ‹è¯•                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  Unit Tests (å•å…ƒæµ‹è¯•)                      â”‚
â”‚              å‡½æ•°/æ–¹æ³•çº§ï¼Œé€»è¾‘æ­£ç¡®æ€§æµ‹è¯•                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 Component Tests (ç»„ä»¶æµ‹è¯•)                 â”‚
â”‚              UIç»„ä»¶ï¼Œäº¤äº’é€»è¾‘æµ‹è¯•                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æµ‹è¯•ç¯å¢ƒæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æµ‹è¯•ç¯å¢ƒçŸ©é˜µ                             â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Unit      â”‚ â”‚ Integration â”‚ â”‚   E2E Testing       â”‚   â”‚
â”‚  â”‚   Tests     â”‚ â”‚   Tests     â”‚ â”‚   Environment       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚          â”‚                   â”‚                   â”‚          â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                              â”‚                              â”‚
â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚                 â”‚   Test     â”‚   Data     â”‚                 â”‚
â”‚                 â”‚   Services â”‚   Mocks    â”‚                 â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                              â”‚                              â”‚
â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚                 â”‚   Test     â”‚   CI/CD    â”‚                 â”‚
â”‚                 â”‚   Runners  â”‚   Pipeline â”‚                 â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ˆ æ¼”è¿›è§„åˆ’

### Phase 1: æ ¸å¿ƒæ¶æ„ (å½“å‰) âœ…

- å¾®æœåŠ¡æ¶æ„æ­å»º
- åŸºç¡€AIä»£ç†å®ç°
- äº‹ä»¶é©±åŠ¨é€šä¿¡
- å®¹å™¨åŒ–éƒ¨ç½²

### Phase 2: é«˜çº§æ¶æ„ ğŸš§

- æœåŠ¡ç½‘æ ¼é›†æˆ (Istio)
- CQRS + äº‹ä»¶æº¯æº
- å¤šåŒºåŸŸéƒ¨ç½²
- æ™ºèƒ½åŒ–ç›‘æ§

### Phase 3: äº‘åŸç”Ÿæ¶æ„ ğŸ“‹

- Serverlesså‡½æ•°
- Edge Computing
- AIæ¨¡å‹åˆ†å¸ƒå¼æ¨ç†
- è”é‚¦å­¦ä¹ æ”¯æŒ

### Phase 4: è‡ªé€‚åº”æ¶æ„ ğŸ¯

- è‡ªåŠ¨æ‰©å±•å’Œä¼˜åŒ–
- AIé©±åŠ¨çš„æ¶æ„å†³ç­–
- è‡ªæ„ˆå’Œè‡ªé…ç½®
- é¢„æµ‹æ€§ç»´æŠ¤

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¾®æœåŠ¡æ¶æ„è¯¦è§£](./MICROSERVICES-ARCHITECTURE.md)
- [æ•°æ®æ¶æ„è®¾è®¡](./DATA-ARCHITECTURE.md)
- [éƒ¨ç½²æ¶æ„](./DEPLOYMENT-ARCHITECTURE.md)
- [æ¶æ„å†³ç­–è®°å½•](./ADRs/)

---

**ğŸ“ ç»´æŠ¤è¯´æ˜**: ç³»ç»Ÿæ¶æ„æ¼”è¿›æ—¶è¯·åŒæ­¥æ›´æ–°æ­¤æ–‡æ¡£
